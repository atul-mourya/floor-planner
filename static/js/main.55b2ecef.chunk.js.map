{"version":3,"sources":["components/LayoutButtons.js","components/FloorPlanner.js","components/PointButton.js","components/PointsButtons.js","components/ClearFloor.js","components/CreateFloor.js","actions/index.js","App.js","serviceWorker.js","js/spacekraft/LoadingManager.js","js/vendors/threejs/r95/MapControls.js","js/vendors/threejs/r95/TransformControls.js","js/vendors/threejs/r95/OrbitControls.js","js/spacekraft/ScriptLoader.js","js/vendors/threex/threex.rendererstats.js","js/spacekraft/utils.js","js/spacekraft/editor.js","reducers/index.js","reducers/EditorUI.js","index.js"],"names":["LayoutButtons","_this","this","react_default","a","createElement","id","props","shape","onClick","children","Component","FloorPlanner","showLayoutButtons","components_LayoutButtons","PointButton","message","PointsButtons","showPointButtons","className","components_PointButton","ClearFloor","showClearButton","CreateFloor","showCreateFloorButton","updateEditorUI","editorUI","console","log","type","payload","App","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","handleClick","bind","assertThisInitialized","e","context","editor","createFloor","clearFloor","extrude","addPoint","removePoint","react","key","components_FloorPlanner","components_PointsButtons","components_CreateFloor","components_ClearFloor","createEditorUI","connect","state","dispatch","bindActionCreators","Boolean","window","location","hostname","match","LoadingManager","onLoad","onProgress","onError","urlModifier","scope","isLoading","itemsLoaded","itemsTotal","onStart","undefined","itemsStart","numberOfItems","itemStart","url","itemEnd","itemError","resolveURL","setURLModifier","transform","MapControls","object","domElement","document","enabled","target","THREE","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MIDDLE","target0","clone","position0","position","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","STATE","NONE","offset","quat","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","max","min","makeSafe","radius","scale","add","panOffset","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","startEvent","endEvent","ROTATE_UP","ROTATE_LEFT","ROTATE","DOLLY","DOLLY_ROTATE","PAN","DOLLY_PAN","rotateStart","rotateStart2","rotateEnd","rotateEnd2","rotateDelta","rotateDelta2","rotateDeltaStartFingers","rotateDeltaEndFingers","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","body","isPerspectiveCamera","targetDistance","length","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","warn","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","event","clientX","clientY","handleTouchMoveRotate","touches","pageX","pageY","subVectors","isHorizontal","isVertical","isRotateUp","y","precision","sin","vector","abs","cos","preventDefault","button","ctrlKey","metaKey","handleMouseDownPan","handleMouseDownDolly","addEventListener","x","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","stopPropagation","handleMouseWheel","keyCode","handleKeyDown","handleTouchStartPan","handleTouchStartRotate","dx","dy","sqrt","handleTouchStartDolly","handleTouchMovePan","handleTouchMoveDolly","prototype","create","constructor","defineProperties","center","get","noZoom","value","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","TransformControls","camera","visible","_gizmo","TransformControlsGizmo","_plane","TransformControlsPlane","defineProperty","mouseDownEvent","mouseUpEvent","mode","objectChangeEvent","ray","_tempVector","_tempVector2","_tempQuaternion","_unit","X","Y","Z","_identityQuaternion","_alignVector","pointStart","pointEnd","rotationAxis","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldScale","eye","_positionStart","_quaternionStart","_scaleStart","propName","defaultValue","propValue","getPointer","pointer","changedTouches","rect","getBoundingClientRect","width","height","onContext","onPointerHover","pointerHover","onPointerDown","pointerDown","onPointerMove","pointerMove","onPointerUp","pointerUp","attach","detach","axis","updateMatrixWorld","parent","matrixWorld","decompose","normalize","dragging","setFromCamera","intersect","intersectObjects","picker","name","planeIntersect","space","snap","rotationSnap","rotation","round","z","point","search","translationSnap","setFromMatrixPosition","d","divide","multiply","ROTATION_SPEED","distanceTo","unit","cross","angleTo","setFromAxisAngle","getMode","setMode","setTranslationSnap","setRotationSnap","setSize","size","setSpace","assign","isTransformControls","gizmoMaterial","depthTest","depthWrite","transparent","side","fog","gizmoLineMaterial","linewidth","matInvisible","opacity","matHelper","matRed","color","matGreen","matBlue","matWhiteTransperent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","scaleHandleGeometry","lineGeometry","addAttribute","CircleGeometry","arc","geometry","vertices","i","push","gizmoTranslate","XYZ","XY","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","TranslateHelperGeometry","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix","tempVector","tempEuler","alignVector","zeroVector","lookAtMatrix","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","concat","handle","eyeDistance","setFromRotationMatrix","atan2","multiplyQuaternions","indexOf","showX","showY","showZ","material","_opacity","_color","lerp","split","some","setFromEuler","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","OrbitControls","TOUCH_ROTATE","TOUCH_DOLLY_PAN","handleTouchStartDollyPan","handleTouchMoveDollyPan","ScriptLoader","_add","basepath","urls","loadingManager","promises","promise","Promise","resolve","reject","script","src","appendChild","load","item","then","all","THREEx","container","style","cssText","msDiv","msText","innerHTML","msTexts","lastTime","Date","now","webGLRenderer","assert","textContent","info","programs","memory","geometries","textures","render","calls","triangles","points","lines","frame","Utils","isElement","obj","HTMLElement","nodeType","ownerDocument","disposeObjMemory","map","parametricGeometries","plane","u","AbstractSKEditor","data","scripts","onReady","_global","ARC_SEGMENTS","selectedObject","hiding","splineHelperObjects","objects","splines","positions","getElementById","setting","nearCamLimit","farCamLimit","extendedFarCamLimit","userControlledAimation","antialias","physicallyCorrectLights","toneMappingExposure","toneMappingWhitePoint","rendererGammaInput","rendererGammaOutput","enableShadow","floorTextureImage","wallTextureImage","tracker","analysis","exportScene","_init","geometry1","scene","background","setHex","_initScene","_initRenderer","canvas","controls","renderer","_refreshRenderFrame","_initMapControls","dragcontrols","DragControls","transformControl","cancelHideTransorm","delayHideTransform","_initDragControl","updateSplineOutline","helpers","ambLight","dirLight","grid","rotateX","texture","wrapS","wrapT","repeat","floorTexture","wallTexture","sceneReady","_importAssets","_onWindowResize","_animateFrame","alpha","setPixelRatio","devicePixelRatio","zIndex","stats","Stats","dom","rendererStats","RendererStats","_createCurveGeometry","splinePointsLength","addSplineObject","Float32Array","curve","k","curveType","tension","closed","mesh","uniform","spline","floor2d","random","castShadow","receiveShadow","new_positions","attributes","t","getPoint","setXYZ","needsUpdate","len","j","current","previous","setTimeout","clearTimeout","requestAnimationFrame","doAnimate","renderFrameTimeoutObj","aspect","initSceneSetup","scriptLoader","cdn","catch","_setup","param","floor3d","_createBox","flangeSection1","flangeSection2","thickness1","thickness2","_createTShape","innerWall","_createUShape","_createLShape","_createCustomShape","getObjectByName","_disposeObjMemory","isMesh","isLine","aoMap","emissiveMap","lightMap","bumpMap","normalMap","specularMap","envMap","isGroup","remove","splice","params","pts","depth","bevelEnabled","computeBoundingSphere","material1","material2","frustumCulled","boundingSphere","negate","orbitControls","degToRad","_initOrbitControls","pop","SKEditor","allReducers","combineReducers","initialState","action","objectSpread","store","createStore","ReactDOM","es","src_App","navigator","serviceWorker","ready","registration","unregister"],"mappings":"6QAWeA,mLARF,IAAAC,EAAAC,KACL,OACIC,EAAAC,EAAAC,cAAA,UAAQC,GAAIJ,KAAKK,MAAMD,GAAIE,MAAQN,KAAKK,MAAMC,MAAQC,QAAU,kBAAMR,EAAKM,MAAME,QAAQ,aAAc,CAACD,MAAOP,EAAKM,MAAMC,UAAWN,KAAKK,MAAMG,iBAHhIC,aCsBbC,mLAJP,OAfkBV,KAAKK,MAAMM,kBAIrBV,EAAAC,EAAAC,cAAA,OAAKC,GAAG,iBACJH,EAAAC,EAAAC,cAACS,EAAD,CAAeR,GAAG,aAAaE,MAAM,MAAMC,QAAUP,KAAKK,MAAME,SAAhE,KACAN,EAAAC,EAAAC,cAACS,EAAD,CAAeR,GAAG,WAAWE,MAAM,IAAIC,QAAUP,KAAKK,MAAME,SAA5D,KACAN,EAAAC,EAAAC,cAACS,EAAD,CAAeR,GAAG,WAAWE,MAAM,IAAIC,QAAUP,KAAKK,MAAME,SAA5D,KACAN,EAAAC,EAAAC,cAACS,EAAD,CAAeR,GAAG,WAAWE,MAAM,IAAIC,QAAUP,KAAKK,MAAME,SAA5D,KACAN,EAAAC,EAAAC,cAACS,EAAD,CAAeR,GAAG,WAAWE,MAAM,IAAIC,QAAUP,KAAKK,MAAME,SAA5D,MAIEN,EAAAC,EAAAC,cAAA,mBAfKM,aCQZI,mLARF,IAAAd,EAAAC,KACDc,EAA4B,QAAlBd,KAAKK,MAAMD,GAAe,YAAc,eACtD,OACIH,EAAAC,EAAAC,cAAA,UAAQC,GAAIJ,KAAKK,MAAMD,GAAKG,QAAU,kBAAMR,EAAKM,MAAME,QAAQO,KAAad,KAAKK,MAAMG,iBAJzEC,aCqBXM,mLALP,OAZkBf,KAAKK,MAAMW,iBAIrBf,EAAAC,EAAAC,cAAA,OAAKc,UAAU,UACXhB,EAAAC,EAAAC,cAACe,EAAD,CAAad,GAAG,MAAMG,QAASP,KAAKK,MAAME,SAA1C,KACAN,EAAAC,EAAAC,cAACe,EAAD,CAAad,GAAG,SAASG,QAASP,KAAKK,MAAME,SAA7C,MAIEN,EAAAC,EAAAC,cAAA,mBAbMM,aCabU,mLAZF,IAAApB,EAAAC,KAQL,OAPkBA,KAAKK,MAAMe,gBAGfnB,EAAAC,EAAAC,cAAA,UAAQC,GAAIJ,KAAKK,MAAMD,GAAIG,QAAS,kBAAMR,EAAKM,MAAME,QAAQ,kBAAkBP,KAAKK,MAAMG,UAE1FP,EAAAC,EAAAC,cAAA,mBARGM,aCcVY,mLAZF,IAAAtB,EAAAC,KAQL,OAPkBA,KAAKK,MAAMiB,sBAGfrB,EAAAC,EAAAC,cAAA,UAAQC,GAAIJ,KAAKK,MAAMD,GAAIG,QAAU,kBAAMR,EAAKM,MAAME,QAAQ,kBAAmBP,KAAKK,MAAMG,UAE5FP,EAAAC,EAAAC,cAAA,mBARIM,4BCFbc,EAAiB,SAACC,GAE3B,OADAC,QAAQC,IAAI,0BACL,CACHC,KAAM,mBACNC,QAASJ,ICOXK,cAEL,SAAAA,IAAc,IAAA9B,EAAA,OAAA+B,OAAAC,EAAA,EAAAD,CAAA9B,KAAA6B,IACb9B,EAAA+B,OAAAE,EAAA,EAAAF,CAAA9B,KAAA8B,OAAAG,EAAA,EAAAH,CAAAD,GAAAK,KAAAlC,QACKmC,YAAcpC,EAAKoC,YAAYC,KAAjBN,OAAAO,EAAA,EAAAP,QAAAO,EAAA,EAAAP,CAAA/B,KAFNA,2EAKFuC,EAAGC,GACd,OAAQD,GACP,IAAK,aACJtC,KAAKK,MAAMkB,eAAe,CACzBH,iBAAiB,EACjBE,uBAAuB,EACvBN,iBAAoC,MAAlBuB,EAAQjC,MAC1BK,mBAAmB,IAEpB6B,EAAOC,YAAY,CAAEnC,MAAOiC,EAAQjC,QACpC,MACD,IAAK,eACJkC,EAAOE,aACP1C,KAAKK,MAAMkB,eAAe,CACzBH,iBAAiB,EACjBE,uBAAuB,EACvBN,kBAAkB,EAClBL,mBAAmB,IAEpB,MACD,IAAK,eACJ6B,EAAOG,UACPH,EAAOE,aACP1C,KAAKK,MAAMkB,eAAe,CACzBH,iBAAiB,EACjBE,uBAAuB,EACvBN,kBAAkB,EAClBL,mBAAmB,IAEpB,MACD,IAAK,YACJ6B,EAAOI,WACP,MACD,IAAK,eACJJ,EAAOK,cACP,MACD,QACCpB,QAAQC,IAAI,qEAMd,OAAQzB,EAAAC,EAAAC,cAAC2C,EAAA,SAAD,CAAUC,IAAK/C,KAAKK,MAAMmB,SAASpB,IAC1CH,EAAAC,EAAAC,cAAC6C,EAAD,CAAcrC,kBAAmBX,KAAKK,MAAMmB,SAASb,kBAAmBJ,QAASP,KAAKmC,cACtFlC,EAAAC,EAAAC,cAAC8C,EAAD,CAAejC,iBAAkBhB,KAAKK,MAAMmB,SAASR,iBAAkBT,QAASP,KAAKmC,cACrFlC,EAAAC,EAAAC,cAAC+C,EAAD,CAAa5B,sBAAuBtB,KAAKK,MAAMmB,SAASF,sBAAuBlB,GAAG,eAAeG,QAASP,KAAKmC,aAA/G,gBACAlC,EAAAC,EAAAC,cAACgD,EAAD,CAAY/B,gBAAiBpB,KAAKK,MAAMmB,SAASJ,gBAAiBhB,GAAG,QAAQG,QAASP,KAAKmC,aAA3F,uCAKD,OACClC,EAAAC,EAAAC,cAAC2C,EAAA,SAAD,KACC7C,EAAAC,EAAAC,cAAA,OAAKC,GAAG,WACPJ,KAAKoD,yBA9DQ3C,aAgFH4C,kBAXf,SAAyBC,GACxB,MAAO,CACN9B,SAAU8B,EAAM9B,WAIlB,SAA8B+B,GAC7B,OAAOC,YAAmB,CAAEjC,eAAgBA,GAAkBgC,IAIhDF,CAA+CxB,GCjF1C4B,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DChBN,IA4FeC,EA5FQ,SAAWC,EAAQC,EAAYC,GAElD,IAKIC,EALAC,EAAQnE,KAERoE,GAAY,EACZC,EAAc,EACdC,EAAa,EAGjBtE,KAAKuE,aAAUC,EACfxE,KAAK+D,OAASA,EACd/D,KAAKgE,WAAaA,EAClBhE,KAAKiE,QAAUA,EACfjE,KAAKyE,WAAa,SAAWC,GAEjBJ,GAAcI,EACdN,GAAY,GAIxBpE,KAAK2E,UAAY,SAAWC,GAExBN,KAEmB,IAAdF,QAEsBI,IAAlBL,EAAMI,SAEPJ,EAAMI,QAASK,EAAKP,EAAaC,GAMzCF,GAAY,GAIhBpE,KAAK6E,QAAU,SAAWD,GAEtBP,SAE0BG,IAArBL,EAAMH,YAEPG,EAAMH,WAAYY,EAAKP,EAAaC,GAInCD,IAAgBC,IAEjBF,GAAY,OAEUI,IAAjBL,EAAMJ,QAEPI,EAAMJ,WAQlB/D,KAAK8E,UAAY,SAAWF,QAEDJ,IAAlBL,EAAMF,SAEPE,EAAMF,QAASW,IAMvB5E,KAAK+E,WAAa,SAAWH,GAEzB,OAAKV,EAEMA,EAAaU,GAIjBA,GAIX5E,KAAKgF,eAAiB,SAAWC,GAG7B,OADAf,EAAce,EACPjF,sBCpETkF,EAAc,SAAWC,EAAQC,GAEtCpF,KAAKmF,OAASA,EAEdnF,KAAKoF,gBAA8BZ,IAAfY,EAA6BA,EAAaC,SAG9DrF,KAAKsF,SAAU,EAGftF,KAAKuF,OAAS,IAAIC,IAGlBxF,KAAKyF,YAAc,EACnBzF,KAAK0F,YAAcC,IAGnB3F,KAAK4F,QAAU,EACf5F,KAAK6F,QAAUF,IAIf3F,KAAK8F,cAAgB,EACrB9F,KAAK+F,cAAgBC,KAAKC,GAI1BjG,KAAKkG,iBAAoBP,IACzB3F,KAAKmG,gBAAkBR,IAIvB3F,KAAKoG,eAAgB,EACrBpG,KAAKqG,cAAgB,IAIrBrG,KAAKsG,YAAa,EAClBtG,KAAKuG,UAAY,EAGjBvG,KAAKwG,cAAe,EACpBxG,KAAKyG,YAAc,EAGnBzG,KAAK0G,WAAY,EACjB1G,KAAK2G,SAAW,EAChB3G,KAAK4G,oBAAqB,EAC1B5G,KAAK6G,YAAc,EAInB7G,KAAK8G,YAAa,EAClB9G,KAAK+G,gBAAkB,EAGvB/G,KAAKgH,YAAa,EAGlBhH,KAAKiH,KAAO,CAAEC,KAAM,GAAIC,GAAI,GAAIC,MAAO,GAAIC,OAAQ,IAGnDrH,KAAKsH,aAAe,CAAEJ,KAAM1B,IAAY0B,KAAMK,OAAQ/B,IAAY+B,OAAQH,MAAO5B,IAAY4B,OAG7FpH,KAAKwH,QAAUxH,KAAKuF,OAAOkC,QAC3BzH,KAAK0H,UAAY1H,KAAKmF,OAAOwC,SAASF,QACtCzH,KAAK4H,MAAQ5H,KAAKmF,OAAO0C,KAMzB7H,KAAK8H,cAAgB,WAEpB,OAAOC,EAAUC,KAIlBhI,KAAKiI,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBlI,KAAKmI,UAAY,WAEhBhE,EAAMqD,QAAQY,KAAMjE,EAAMoB,QAC1BpB,EAAMuD,UAAUU,KAAMjE,EAAMgB,OAAOwC,UACnCxD,EAAMyD,MAAQzD,EAAMgB,OAAO0C,MAI5B7H,KAAKqI,MAAQ,WAEZlE,EAAMoB,OAAO6C,KAAMjE,EAAMqD,SACzBrD,EAAMgB,OAAOwC,SAASS,KAAMjE,EAAMuD,WAClCvD,EAAMgB,OAAO0C,KAAO1D,EAAMyD,MAE1BzD,EAAMgB,OAAOmD,yBACbnE,EAAMoE,cAAeC,GAErBrE,EAAMsE,SAENnF,EAAQoF,EAAMC,MAKf3I,KAAKyI,OAAS,WAEb,IAAIG,EAAS,IAAIpD,IAGbqD,GAAO,IAAIrD,KAAmBsD,mBAAoB3D,EAAO4D,GAAI,IAAIvD,IAAe,EAAG,EAAG,IACtFwD,EAAcH,EAAKpB,QAAQwB,UAE3BC,EAAe,IAAI1D,IACnB2D,EAAiB,IAAI3D,IAEzB,OAAO,WAEN,IAAImC,EAAWxD,EAAMgB,OAAOwC,SAkE5B,OAhEAiB,EAAOR,KAAMT,GAAWyB,IAAKjF,EAAMoB,QAGnCqD,EAAOS,gBAAiBR,GAGxBd,EAAUuB,eAAgBV,GAErBzE,EAAM2C,YAAcxD,IAAUoF,EAAMC,MAExCY,EAiJK,EAAIvD,KAAKC,GAAK,GAAK,GAAK9B,EAAM4C,iBA7IpCgB,EAAUG,OAASsB,EAAetB,MAClCH,EAAUC,KAAOwB,EAAexB,IAGhCD,EAAUG,MAAQlC,KAAKyD,IAAKtF,EAAM+B,gBAAiBF,KAAK0D,IAAKvF,EAAMgC,gBAAiB4B,EAAUG,QAG9FH,EAAUC,IAAMhC,KAAKyD,IAAKtF,EAAM2B,cAAeE,KAAK0D,IAAKvF,EAAM4B,cAAegC,EAAUC,MAExFD,EAAU4B,WAGV5B,EAAU6B,QAAUC,EAGpB9B,EAAU6B,OAAS5D,KAAKyD,IAAKtF,EAAMsB,YAAaO,KAAK0D,IAAKvF,EAAMuB,YAAaqC,EAAU6B,SAGvFzF,EAAMoB,OAAOuE,IAAKC,GAElBnB,EAAOoB,iBAAkBjC,GAGzBa,EAAOS,gBAAiBL,GAExBrB,EAASS,KAAMjE,EAAMoB,QAASuE,IAAKlB,GAEnCzE,EAAMgB,OAAO8E,OAAQ9F,EAAMoB,SAEE,IAAxBpB,EAAMiC,eAEVoD,EAAetB,OAAW,EAAI/D,EAAMkC,cACpCmD,EAAexB,KAAS,EAAI7D,EAAMkC,cAElC0D,EAAUG,eAAgB,EAAI/F,EAAMkC,iBAIpCmD,EAAeW,IAAK,EAAG,EAAG,GAE1BJ,EAAUI,IAAK,EAAG,EAAG,IAItBN,EAAQ,KAMHO,GACJlB,EAAamB,kBAAmBlG,EAAMgB,OAAOwC,UAAa2C,GAC1D,GAAM,EAAInB,EAAeoB,IAAKpG,EAAMgB,OAAOqF,aAAiBF,KAE5DnG,EAAMoE,cAAeC,GAErBU,EAAad,KAAMjE,EAAMgB,OAAOwC,UAChCwB,EAAef,KAAMjE,EAAMgB,OAAOqF,YAClCJ,GAAc,GAEP,IAzFI,GAmGdpK,KAAKyK,QAAU,WAEdtG,EAAMiB,WAAWsF,oBAAqB,cAAeC,GAAe,GACpExG,EAAMiB,WAAWsF,oBAAqB,YAAaE,GAAa,GAChEzG,EAAMiB,WAAWsF,oBAAqB,QAASG,GAAc,GAE7D1G,EAAMiB,WAAWsF,oBAAqB,aAAcI,GAAc,GAClE3G,EAAMiB,WAAWsF,oBAAqB,WAAYK,GAAY,GAC9D5G,EAAMiB,WAAWsF,oBAAqB,YAAaM,GAAa,GAEhE3F,SAASqF,oBAAqB,YAAaO,GAAa,GACxD5F,SAASqF,oBAAqB,UAAWQ,GAAW,GAEpDxH,OAAOgH,oBAAqB,UAAWS,GAAW,IAUnD,IAAIhH,EAAQnE,KAERwI,EAAc,CAAE7G,KAAM,UACtByJ,EAAa,CAAEzJ,KAAM,SACrB0J,EAAW,CAAE1J,KAAM,OAEnB+G,EAAQ,CACXC,KAAM,EACN2C,UAAW,EACXC,YAAa,EACbC,OAAQ,EACRC,MAAO,EACPC,aAAc,EACdC,IAAK,EACLC,UAAW,IAGRtI,EAAQoF,EAAMC,KAEd2B,EAAM,KAGNvC,EAAY,IAAIvC,IAChBgE,EAAiB,IAAIhE,IAErBqE,EAAQ,EACRE,EAAY,IAAIvE,IAChB4E,GAAc,EAEdyB,EAAc,IAAIrG,IAClBsG,EAAe,IAAItG,IACnBuG,EAAY,IAAIvG,IAChBwG,EAAa,IAAIxG,IACjByG,EAAc,IAAIzG,IAClB0G,EAAe,IAAI1G,IACnB2G,EAA0B,IAAI3G,IAC9B4G,EAAwB,IAAI5G,IAE5B6G,EAAW,IAAI7G,IACf8G,EAAS,IAAI9G,IACb+G,EAAW,IAAI/G,IAEfgH,EAAa,IAAIhH,IACjBiH,EAAW,IAAIjH,IACfkH,EAAa,IAAIlH,IAQrB,SAASmH,IAER,OAAO3G,KAAK4G,IAAK,IAAMzI,EAAMoC,WAI9B,SAASgD,EAAYsD,GAEpBrD,EAAetB,OAAS2E,EAIzB,SAASC,EAAUD,GAElBrD,EAAexB,KAAO6E,EAIvB,IAAIE,EAAU,WAEb,IAAIC,EAAI,IAAIxH,IAEZ,OAAO,SAAkByH,EAAUC,GAElCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAE9C,gBAAkB+C,GAEpBlD,EAAUD,IAAKkD,IATH,GAeVI,EAAQ,WAEX,IAAIJ,EAAI,IAAIxH,IAEZ,OAAO,SAAgByH,EAAUC,IAEE,IAA7B/I,EAAMyC,mBAEVoG,EAAEG,oBAAqBD,EAAc,IAIrCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAEK,aAAclJ,EAAMgB,OAAO4D,GAAIiE,IAIlCA,EAAE9C,eAAgB+C,GAElBlD,EAAUD,IAAKkD,IAnBL,GA0BRM,EAAM,WAET,IAAI1E,EAAS,IAAIpD,IAEjB,OAAO,SAAc+H,EAAQC,GAE5B,IAAIC,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAE5E,GAAKjB,EAAMgB,OAAOwI,oBAAsB,CAGvC,IAAIhG,EAAWxD,EAAMgB,OAAOwC,SAC5BiB,EAAOR,KAAMT,GAAWyB,IAAKjF,EAAMoB,QACnC,IAAIqI,EAAiBhF,EAAOiF,SAG5BD,GAAkB5H,KAAK8H,IAAO3J,EAAMgB,OAAO4I,IAAM,EAAM/H,KAAKC,GAAK,KAGjE8G,EAAS,EAAIQ,EAASK,EAAiBH,EAAQO,aAAc7J,EAAMgB,OAAO8I,QAC1Eb,EAAO,EAAII,EAASI,EAAiBH,EAAQO,aAAc7J,EAAMgB,OAAO8I,aAE7D9J,EAAMgB,OAAO+I,sBAGxBnB,EAASQ,GAAWpJ,EAAMgB,OAAOgJ,MAAQhK,EAAMgB,OAAOiJ,MAASjK,EAAMgB,OAAO0C,KAAO4F,EAAQY,YAAalK,EAAMgB,OAAO8I,QACrHb,EAAOI,GAAWrJ,EAAMgB,OAAOmJ,IAAMnK,EAAMgB,OAAOoJ,QAAWpK,EAAMgB,OAAO0C,KAAO4F,EAAQO,aAAc7J,EAAMgB,OAAO8I,UAKpHxM,QAAQ+M,KAAM,8EACdrK,EAAMuC,WAAY,IAhCX,GAwCV,SAAS+H,EAASC,GAEZvK,EAAMgB,OAAOwI,oBAEjB9D,GAAS6E,EAEEvK,EAAMgB,OAAO+I,sBAExB/J,EAAMgB,OAAO0C,KAAO7B,KAAKyD,IAAKtF,EAAMyB,QAASI,KAAK0D,IAAKvF,EAAM0B,QAAS1B,EAAMgB,OAAO0C,KAAO6G,IAC1FvK,EAAMgB,OAAOmD,yBACb8B,GAAc,IAId3I,QAAQ+M,KAAM,qFACdrK,EAAMmC,YAAa,GAMrB,SAASqI,EAAUD,GAEbvK,EAAMgB,OAAOwI,oBAEjB9D,GAAS6E,EAEEvK,EAAMgB,OAAO+I,sBAExB/J,EAAMgB,OAAO0C,KAAO7B,KAAKyD,IAAKtF,EAAMyB,QAASI,KAAK0D,IAAKvF,EAAM0B,QAAS1B,EAAMgB,OAAO0C,KAAO6G,IAC1FvK,EAAMgB,OAAOmD,yBACb8B,GAAc,IAId3I,QAAQ+M,KAAM,qFACdrK,EAAMmC,YAAa,GAUrB,SAASsI,EAAuBC,GAI/BhD,EAAY1B,IAAK0E,EAAMC,QAASD,EAAME,SAiLvC,SAASC,EAAuBH,GAE/B,IAA4B,IAAvB1K,EAAMqC,cACuB,KAA3BlD,EAAQoF,EAAM8C,QAArB,CAaA,GAVAO,EAAU5B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAG5DnD,EAAW7B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAE7DlD,EAAYmD,WAAYrD,EAAWF,GACnCK,EAAakD,WAAYpD,EAAYF,GACrCK,EAAwBiD,WAAYtD,EAAcD,GAClDO,EAAsBgD,WAAYpD,EAAYD,GAuB/C,WAGC,IAAOsD,EAAclD,GAEpB,OAAO,EAKR,IAAOkD,EAAcjD,GAEpB,OAAO,EAKR,IAAOkD,EAAYrD,GAElB,OAAO,EAKR,IAAOqD,EAAYpD,GAElB,OAAO,EAKR,OAAOD,EAAY1B,IAAK2B,GAAiB,EApDpCqD,GAAe,CAEnB,IAAI9B,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAG5E0H,EAAU,EAAI9G,KAAKC,GAAKgG,EAAYuD,EAAI/B,EAAQO,cAGhD1K,EAAQoF,EAAM4C,eAE+B,KAAhChI,EAAQoF,EAAM6C,cAE3BhC,GAAc4C,EAAwBU,QAAUT,EAAsBS,SAAY1I,EAAMsC,aAIzFoF,EAAYzD,KAAM2D,GAClBD,EAAa1D,KAAM4D,IAuCpB,IAAIqD,EAAe,WAElB,IAAII,EAAYzJ,KAAK0J,IAAK1J,KAAKC,GAAK,GAEpC,OAAO,SAAuB0J,GAE7B,OAAO3J,KAAK4J,IAAK5J,KAAK0J,IAAKC,EAAO9C,UAAc4C,GAN/B,GAYfH,EAAa,WAEhB,IAAIG,EAAYzJ,KAAK6J,IAAK7J,KAAKC,GAAK,EAAID,KAAKC,GAAK,GAElD,OAAO,SAAqB0J,GAE3B,OAAO3J,KAAK4J,IAAK5J,KAAK6J,IAAKF,EAAO9C,UAAc4C,GANjC,GA6DjB,SAAS7E,EAAaiE,GAErB,IAAuB,IAAlB1K,EAAMmB,QAAX,CAIA,OAFAuJ,EAAMiB,iBAEGjB,EAAMkB,QAEd,KAAK5L,EAAMmD,aAAaJ,KAEvB,GAAK2H,EAAMmB,SAAWnB,EAAMoB,QAAU,CAErC,IAA4B,IAAvB9L,EAAMqC,aAAyB,OAEpCoI,EAAuBC,GAEvBvL,EAAQoF,EAAM8C,WAER,CAEN,IAAyB,IAApBrH,EAAMuC,UAAsB,QA1UrC,SAA6BmI,GAI5BxC,EAASlC,IAAK0E,EAAMC,QAASD,EAAME,SAwUhCmB,CAAoBrB,GAEpBvL,EAAQoF,EAAMiD,IAIf,MAED,KAAKxH,EAAMmD,aAAaC,OAEvB,IAA0B,IAArBpD,EAAMmC,WAAuB,QA9VrC,SAA+BuI,GAI9BrC,EAAWrC,IAAK0E,EAAMC,QAASD,EAAME,SA4VnCoB,CAAsBtB,GAEtBvL,EAAQoF,EAAM+C,MAEd,MAED,KAAKtH,EAAMmD,aAAaF,MAEvB,IAA4B,IAAvBjD,EAAMqC,aAAyB,OAEpCoI,EAAuBC,GAEvBvL,EAAQoF,EAAM8C,OASXlI,IAAUoF,EAAMC,OAEpBtD,SAAS+K,iBAAkB,YAAanF,GAAa,GACrD5F,SAAS+K,iBAAkB,UAAWlF,GAAW,GAEjD/G,EAAMoE,cAAe6C,KAMvB,SAASH,EAAa4D,GAErB,IAAuB,IAAlB1K,EAAMmB,QAIX,OAFAuJ,EAAMiB,iBAEGxM,GAER,KAAKoF,EAAM8C,OAEV,IAA4B,IAAvBrH,EAAMqC,aAAyB,QA1XvC,SAAgCqI,GAI/B9C,EAAU5B,IAAK0E,EAAMC,QAASD,EAAME,SAEpC9C,EAAYmD,WAAYrD,EAAWF,GAAc3B,eAAgB/F,EAAMsC,aAEvE,IAAIgH,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAE5EmE,EAAY,EAAIvD,KAAKC,GAAKgG,EAAYoE,EAAI5C,EAAQO,cAElDlB,EAAU,EAAI9G,KAAKC,GAAKgG,EAAYuD,EAAI/B,EAAQO,cAEhDnC,EAAYzD,KAAM2D,GAElB5H,EAAMsE,SA4WJ6H,CAAuBzB,GAEvB,MAED,KAAKnG,EAAM+C,MAEV,IAA0B,IAArBtH,EAAMmC,WAAuB,QA9WrC,SAA+BuI,GAI9BpC,EAAStC,IAAK0E,EAAMC,QAASD,EAAME,SAEnCrC,EAAW0C,WAAY3C,EAAUD,GAE5BE,EAAW8C,EAAI,EAEnBf,EAAS9B,KAEED,EAAW8C,EAAI,GAE1Bb,EAAUhC,KAIXH,EAAWpE,KAAMqE,GAEjBtI,EAAMsE,SA4VJ8H,CAAsB1B,GAEtB,MAED,KAAKnG,EAAMiD,IAEV,IAAyB,IAApBxH,EAAMuC,UAAsB,QA9VpC,SAA6BmI,GAI5BvC,EAAOnC,IAAK0E,EAAMC,QAASD,EAAME,SAEjCxC,EAAS6C,WAAY9C,EAAQD,GAAWnC,eAAgB/F,EAAMwC,UAE9D2G,EAAKf,EAAS8D,EAAG9D,EAASiD,GAE1BnD,EAASjE,KAAMkE,GAEfnI,EAAMsE,SAoVJ+H,CAAoB3B,IAWvB,SAAS3D,EAAW2D,IAEI,IAAlB1K,EAAMmB,UAIXD,SAASqF,oBAAqB,YAAaO,GAAa,GACxD5F,SAASqF,oBAAqB,UAAWQ,GAAW,GAEpD/G,EAAMoE,cAAe8C,GAErB/H,EAAQoF,EAAMC,MAIf,SAASkC,EAAcgE,IAEC,IAAlB1K,EAAMmB,UAA0C,IAArBnB,EAAMmC,YAA0BhD,IAAUoF,EAAMC,MAAQrF,IAAUoF,EAAM8C,SAExGqD,EAAMiB,iBACNjB,EAAM4B,kBAENtM,EAAMoE,cAAe6C,GA3WtB,SAA2ByD,GAIrBA,EAAMrB,OAAS,EAEnBmB,EAAUhC,KAECkC,EAAMrB,OAAS,GAE1BiB,EAAS9B,KAIVxI,EAAMsE,SA+VNiI,CAAkB7B,GAElB1K,EAAMoE,cAAe8C,IAItB,SAASF,EAAW0D,IAEI,IAAlB1K,EAAMmB,UAA0C,IAArBnB,EAAM6C,aAA4C,IAApB7C,EAAMuC,WAnWrE,SAAwBmI,GAIvB,OAASA,EAAM8B,SAEd,KAAKxM,EAAM8C,KAAKE,GACfmG,EAAK,EAAGnJ,EAAM0C,aACd1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKI,OACfiG,EAAK,GAAKnJ,EAAM0C,aAChB1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKC,KACfoG,EAAKnJ,EAAM0C,YAAa,GACxB1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKG,MACfkG,GAAOnJ,EAAM0C,YAAa,GAC1B1C,EAAMsE,UA8URmI,CAAe/B,GAIhB,SAAS/D,EAAc+D,GAEtB,IAAuB,IAAlB1K,EAAMmB,QAAX,CAIA,OAFAuJ,EAAMiB,iBAEGjB,EAAMI,QAAQpB,QAEtB,KAAK,EAEJ,IAAyB,IAApB1J,EAAMuC,UAAsB,QAtTpC,SAA8BmI,GAExB1K,EAAMuC,WAIV2F,EAASlC,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAkT1D0B,CAAqBhC,GAErBvL,EAAQoF,EAAMiD,IAEd,MAED,KAAK,EAEJ,IAA0B,IAArBxH,EAAMmC,aAA+C,IAAvBnC,EAAMqC,aAAyB,QA7VrE,SAAiCqI,GAKhChD,EAAY1B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAG9DrD,EAAa3B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAuV7D2B,CAAwBjC,GAnV3B,SAAgCA,GAE/B,GAAK1K,EAAMmC,WAAa,CAIvB,IAAIyK,EAAKlC,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,MACnD8B,EAAKnC,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,MAEnDlC,EAAWjH,KAAKiL,KAAMF,EAAKA,EAAKC,EAAKA,GAEzCxE,EAAWrC,IAAK,EAAG8C,IAyUlBiE,CAAuBrC,GAEvBvL,EAAQoF,EAAMgD,aAEd,MAED,QAECpI,EAAQoF,EAAMC,KAIXrF,IAAUoF,EAAMC,MAEpBxE,EAAMoE,cAAe6C,IAMvB,SAASJ,EAAa6D,GAErB,IAAuB,IAAlB1K,EAAMmB,QAKX,OAHAuJ,EAAMiB,iBACNjB,EAAM4B,kBAEG5B,EAAMI,QAAQpB,QAEtB,KAAK,EAEJ,IAAyB,IAApB1J,EAAMuC,UAAsB,OACjC,GAAKpD,IAAUoF,EAAMiD,IAAM,QAjO9B,SAA6BkD,IAEH,IAApB1K,EAAMuC,WACoB,KAAxBpD,EAAQoF,EAAMiD,OAIrBW,EAAOnC,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAEzD5C,EAAS6C,WAAY9C,EAAQD,GAAWnC,eAAgB/F,EAAMwC,UAE9D2G,EAAKf,EAAS8D,EAAG9D,EAASiD,GAE1BnD,EAASjE,KAAMkE,IAsNb6E,CAAoBtC,GAEpB1K,EAAMsE,SAEN,MAED,KAAK,EAEJ,IAA0B,IAArBtE,EAAMmC,aAA+C,IAAvBnC,EAAMqC,aAAyB,OAClE,GAAwC,KAAjClD,EAAQoF,EAAMgD,cAAuB,OAE5CsD,EAAuBH,GApQ1B,SAA+BA,GAE9B,IAA0B,IAArB1K,EAAMmC,YACsB,KAA1BhD,EAAQoF,EAAM+C,OAArB,CAIA,IAAIsF,EAAKlC,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,MACnD8B,EAAKnC,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,MAEnDlC,EAAWjH,KAAKiL,KAAMF,EAAKA,EAAKC,EAAKA,GAEzCvE,EAAStC,IAAK,EAAG8C,GAEjBP,EAAWvC,IAAK,EAAGnE,KAAK4G,IAAKH,EAAS+C,EAAIhD,EAAWgD,EAAGrL,EAAMoC,YAE9DkI,EAAS/B,EAAW8C,GAEpBhD,EAAWpE,KAAMqE,IAmPf2E,CAAsBvC,GAEtB1K,EAAMsE,SAEN,MAED,QAECnF,EAAQoF,EAAMC,MAMjB,SAASoC,EAAY8D,IAEG,IAAlB1K,EAAMmB,UAIXnB,EAAMoE,cAAe8C,GAErB/H,EAAQoF,EAAMC,MAIf,SAASgC,EAAekE,IAEA,IAAlB1K,EAAMmB,SAEXuJ,EAAMiB,iBAMP3L,EAAMiB,WAAWgL,iBAAkB,cAAezF,GAAe,GAEjExG,EAAMiB,WAAWgL,iBAAkB,YAAaxF,GAAa,GAC7DzG,EAAMiB,WAAWgL,iBAAkB,QAASvF,GAAc,GAE1D1G,EAAMiB,WAAWgL,iBAAkB,aAActF,GAAc,GAC/D3G,EAAMiB,WAAWgL,iBAAkB,WAAYrF,GAAY,GAC3D5G,EAAMiB,WAAWgL,iBAAkB,YAAapF,GAAa,GAE7DtH,OAAO0M,iBAAkB,UAAWjF,GAAW,GAI/CnL,KAAKyI,WAINvD,EAAYmM,UAAYvP,OAAOwP,OAAQ9L,IAAsB6L,YACvCE,YAAcrM,EAEpCpD,OAAO0P,iBAAkBtM,EAAYmM,UAAW,CAE/CI,OAAQ,CAEPC,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,0DACPxO,KAAKuF,SAQdoM,OAAQ,CAEPD,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,6EACLxO,KAAKsG,YAIf6D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,4EACdxO,KAAKsG,YAAesL,IAMtBC,SAAU,CAETH,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,iFACLxO,KAAKwG,cAIf2D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,gFACdxO,KAAKwG,cAAiBoL,IAMxBE,MAAO,CAENJ,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,2EACLxO,KAAK0G,WAIfyD,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,0EACdxO,KAAK0G,WAAckL,IAMrBG,OAAQ,CAEPL,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,6EACLxO,KAAKgH,YAIfmD,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,4EACdxO,KAAKgH,YAAe4K,IAMtBI,aAAc,CAEbN,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,sFACLxO,KAAKoG,eAIf+D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,qFACdxO,KAAKoG,eAAkBwL,IAMzBK,qBAAsB,CAErBP,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,0FACPxO,KAAKqG,eAIb8D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,0FACdxO,KAAKqG,cAAgBuL,MAOT1M,QCvoCTgN,EAAoB,SAAWC,EAAQ/M,GAE5CI,IAAetD,KAAMlC,MAErBoF,OAA8BZ,IAAfY,EAA6BA,EAAaC,SAEzDrF,KAAKoS,SAAU,EAEf,IAAIC,EAAS,IAAIC,EACjBtS,KAAK8J,IAAKuI,GAEV,IAAIE,EAAS,IAAIC,EACjBxS,KAAK8J,IAAKyI,GAEV,IAAIpO,EAAQnE,KAMZyS,EAAgB,SAAUN,GAC1BM,EAAgB,cAAUjO,GAC1BiO,EAAgB,WAAW,GAC3BA,EAAgB,OAAQ,MACxBA,EAAgB,OAAQ,aACxBA,EAAgB,kBAAmB,MACnCA,EAAgB,eAAgB,MAChCA,EAAgB,QAAS,SACzBA,EAAgB,OAAQ,GACxBA,EAAgB,YAAY,GAC5BA,EAAgB,SAAS,GACzBA,EAAgB,SAAS,GACzBA,EAAgB,SAAS,GAEzB,IAAIjK,EAAc,CAAE7G,KAAM,UACtB+Q,EAAiB,CAAE/Q,KAAM,aACzBgR,EAAe,CAAEhR,KAAM,UAAWiR,KAAMzO,EAAMyO,MAC9CC,EAAoB,CAAElR,KAAM,gBAI5BmR,EAAM,IAAItN,IAEVuN,EAAc,IAAIvN,IAClBwN,EAAe,IAAIxN,IACnByN,EAAkB,IAAIzN,IACtB0N,EAAQ,CACXC,EAAG,IAAI3N,IAAe,EAAG,EAAG,GAC5B4N,EAAG,IAAI5N,IAAe,EAAG,EAAG,GAC5B6N,EAAG,IAAI7N,IAAe,EAAG,EAAG,IAEzB8N,EAAsB,IAAI9N,IAC1B+N,EAAe,IAAI/N,IAEnBgO,EAAa,IAAIhO,IACjBiO,EAAW,IAAIjO,IACfkO,EAAe,IAAIlO,IACnBmO,EAAgB,EAEhBC,EAAiB,IAAIpO,IACrBqO,EAAmB,IAAIrO,IACvBsO,EAAc,IAAItO,IAElBuO,EAAiB,IAAIvO,IACrBwO,EAAmB,IAAIxO,IACvByO,EAAc,IAAIzO,IAElB0O,EAAqB,IAAI1O,IACzB2O,EAAuB,IAAI3O,IAC3B4O,EAAkB,IAAI5O,IAEtB6O,EAAgB,IAAI7O,IACpB8O,EAAkB,IAAI9O,IACtB+O,EAAa,IAAI/O,IAEjBgP,EAAM,IAAIhP,IAEViP,EAAiB,IAAIjP,IACrBkP,EAAmB,IAAIlP,IACvBmP,EAAc,IAAInP,IAmEtB,SAASiN,EAAgBmC,EAAUC,GAElC,IAAIC,EAAYD,EAEhB/S,OAAO2Q,eAAgBtO,EAAOyQ,EAAU,CAEvClD,IAAK,WAEJ,YAAqBlN,IAAdsQ,EAA0BA,EAAYD,GAI9C1K,IAAK,SAAUyH,GAETkD,IAAclD,IAElBkD,EAAYlD,EACZW,EAAQqC,GAAahD,EACrBS,EAAQuC,GAAahD,EAErBzN,EAAMoE,cAAe,CAAE5G,KAAMiT,EAAW,WAAYhD,MAAOA,IAC3DzN,EAAMoE,cAAeC,OAQxBrE,EAAOyQ,GAAaC,EACpBtC,EAAQqC,GAAaC,EACrBxC,EAAQuC,GAAaC,EAkUtB,SAASE,EAAYlG,GAEpB,IAAImG,EAAUnG,EAAMoG,eAAiBpG,EAAMoG,eAAgB,GAAMpG,EAE7DqG,EAAO9P,EAAW+P,wBAEtB,MAAO,CACN9E,GAAK2E,EAAQlG,QAAUoG,EAAK9G,MAAS8G,EAAKE,MAAQ,EAAI,EACtD5F,IAAOwF,EAAQjG,QAAUmG,EAAK5G,KAAQ4G,EAAKG,OAAS,EAAI,EACxDtF,OAAQlB,EAAMkB,QAOhB,SAASuF,EAAWzG,GAEnBA,EAAMiB,iBAIP,SAASyF,EAAgB1G,GAElB1K,EAAMmB,SAEZnB,EAAMqR,aAAcT,EAAYlG,IAIjC,SAAS4G,EAAe5G,GAEjB1K,EAAMmB,UAEZuJ,EAAMiB,iBAEN3L,EAAMqR,aAAcT,EAAYlG,IAChC1K,EAAMuR,YAAaX,EAAYlG,KAIhC,SAAS8G,EAAe9G,GAEjB1K,EAAMmB,UAEZuJ,EAAMiB,iBAEN3L,EAAMyR,YAAab,EAAYlG,KAIhC,SAASgH,EAAahH,GAEf1K,EAAMmB,UAEZuJ,EAAMiB,iBAEN3L,EAAM2R,UAAWf,EAAYlG,KAzd9B4D,EAAgB,mBAAoBuB,GACpCvB,EAAgB,gBAAiB4B,GACjC5B,EAAgB,qBAAsByB,GACtCzB,EAAgB,kBAAmB6B,GACnC7B,EAAgB,uBAAwB0B,GACxC1B,EAAgB,iBAAkBmB,GAClCnB,EAAgB,mBAAoBoB,GACpCpB,EAAgB,aAAce,GAC9Bf,EAAgB,WAAYgB,GAC5BhB,EAAgB,eAAgBiB,GAChCjB,EAAgB,gBAAiBkB,GACjClB,EAAgB,MAAO+B,GAItBpP,EAAWgL,iBAAkB,YAAaqF,GAAe,GACzDrQ,EAAWgL,iBAAkB,aAAcqF,GAAe,GAC1DrQ,EAAWgL,iBAAkB,YAAamF,GAAgB,GAC1DnQ,EAAWgL,iBAAkB,YAAamF,GAAgB,GAC1DlQ,SAAS+K,iBAAkB,YAAauF,GAAe,GACvDvQ,EAAWgL,iBAAkB,YAAauF,GAAe,GACzDtQ,SAAS+K,iBAAkB,UAAWyF,GAAa,GACnDzQ,EAAWgL,iBAAkB,WAAYyF,GAAa,GACtDzQ,EAAWgL,iBAAkB,cAAeyF,GAAa,GACzDzQ,EAAWgL,iBAAkB,aAAcyF,GAAa,GACxDzQ,EAAWgL,iBAAkB,cAAekF,GAAW,GAIxDtV,KAAKyK,QAAU,WAEdrF,EAAWsF,oBAAqB,YAAa+K,GAC7CrQ,EAAWsF,oBAAqB,aAAc+K,GAC9CrQ,EAAWsF,oBAAqB,YAAa6K,GAC7CnQ,EAAWsF,oBAAqB,YAAa6K,GAC7ClQ,SAASqF,oBAAqB,YAAaiL,GAC3CvQ,EAAWsF,oBAAqB,YAAaiL,GAC7CtQ,SAASqF,oBAAqB,UAAWmL,GACzCzQ,EAAWsF,oBAAqB,WAAYmL,GAC5CzQ,EAAWsF,oBAAqB,cAAemL,GAC/CzQ,EAAWsF,oBAAqB,aAAcmL,GAC9CzQ,EAAWsF,oBAAqB,cAAe4K,IAKhDtV,KAAK+V,OAAS,SAAW5Q,GAExBnF,KAAKmF,OAASA,EACdnF,KAAKoS,SAAU,GAKhBpS,KAAKgW,OAAS,WAEbhW,KAAKmF,YAASX,EACdxE,KAAKoS,SAAU,EACfpS,KAAKiW,KAAO,MAyCbjW,KAAKkW,kBAAoB,gBAEH1R,IAAhBxE,KAAKmF,SAETnF,KAAKmF,OAAO+Q,oBACZlW,KAAKmF,OAAOgR,OAAOC,YAAYC,UAAWtC,EAAgBC,EAAkBC,GAC5EjU,KAAKmF,OAAOiR,YAAYC,UAAWhC,EAAeC,EAAiBC,IAIpEvU,KAAKmS,OAAO+D,oBACZlW,KAAKmS,OAAOiE,YAAYC,UAAWzC,EAAgBC,EAAkBC,GAEhE9T,KAAKmS,kBAAkB3M,IAE3BgP,EAAIpM,KAAMwL,GAAiBxK,IAAKiL,GAAgBiC,YAErCtW,KAAKmS,kBAAkB3M,KAElCgP,EAAIpM,KAAMwL,GAAiB0C,YAI5B9Q,IAAe6L,UAAU6E,kBAAkBhU,KAAMlC,OAIlDA,KAAKwV,aAAe,SAAUR,GAE7B,QAAqBxQ,IAAhBxE,KAAKmF,SAA0C,IAAlBnF,KAAKuW,gBAA0C/R,IAAnBwQ,EAAQjF,QAA2C,IAAnBiF,EAAQjF,QAAtG,CAEA+C,EAAI0D,cAAexB,EAAShV,KAAKmS,QAEjC,IAAIsE,EAAY3D,EAAI4D,iBAAkBrE,EAAOsE,OAAQ3W,KAAK4S,MAAOpS,UAAU,GAAQ,KAAO,EAIzFR,KAAKiW,KAFDQ,EAEQA,EAAUtR,OAAOyR,KAIjB,OAMd5W,KAAK0V,YAAc,SAAUV,GAE5B,QAAqBxQ,IAAhBxE,KAAKmF,SAA0C,IAAlBnF,KAAKuW,gBAA0C/R,IAAnBwQ,EAAQjF,QAA2C,IAAnBiF,EAAQjF,UAE5E,IAAnBiF,EAAQjF,aAAmCvL,IAAnBwQ,EAAQjF,SAAwC,OAAd/P,KAAKiW,KAAgB,CAErFnD,EAAI0D,cAAexB,EAAShV,KAAKmS,QAEjC,IAAI0E,EAAiB/D,EAAI4D,iBAAkB,CAAEnE,IAAU,GAAQ,KAAO,EAEtE,GAAKsE,EAAiB,CAErB,IAAIC,EAAQ9W,KAAK8W,MAYjB,GAVmB,UAAd9W,KAAK4S,KAETkE,EAAQ,QAEiB,MAAd9W,KAAKiW,MAA+B,SAAdjW,KAAKiW,MAAkC,QAAdjW,KAAKiW,OAE/Da,EAAQ,SAIM,UAAVA,GAAmC,WAAd9W,KAAK4S,KAAoB,CAElD,IAAImE,EAAO/W,KAAKgX,aAEG,MAAdhX,KAAKiW,MAAgBc,IAAO/W,KAAKmF,OAAO8R,SAAS5G,EAAIrK,KAAKkR,MAAOlX,KAAKmF,OAAO8R,SAAS5G,EAAI0G,GAASA,GACrF,MAAd/W,KAAKiW,MAAgBc,IAAO/W,KAAKmF,OAAO8R,SAASzH,EAAIxJ,KAAKkR,MAAOlX,KAAKmF,OAAO8R,SAASzH,EAAIuH,GAASA,GACrF,MAAd/W,KAAKiW,MAAgBc,IAAO/W,KAAKmF,OAAO8R,SAASE,EAAInR,KAAKkR,MAAOlX,KAAKmF,OAAO8R,SAASE,EAAIJ,GAASA,GAIzG/W,KAAKmF,OAAO+Q,oBACZlW,KAAKmF,OAAOgR,OAAOD,oBAEnBzB,EAAerM,KAAMpI,KAAKmF,OAAOwC,UACjC+M,EAAiBtM,KAAMpI,KAAKmF,OAAOqF,YACnCmK,EAAYvM,KAAMpI,KAAKmF,OAAO0E,OAE9B7J,KAAKmF,OAAOiR,YAAYC,UAAWnC,EAAoBC,EAAsBC,GAE7EZ,EAAWpL,KAAMyO,EAAeO,OAAQhO,IAAK8K,GAE9B,UAAV4C,GAAoBtD,EAAWnK,gBAAiB8K,EAAqB1M,QAAQwB,WAInFjJ,KAAKuW,UAAW,EAChB7D,EAAeE,KAAO5S,KAAK4S,KAC3B5S,KAAKuI,cAAemK,KAMtB1S,KAAK4V,YAAc,SAAUZ,GAE5B,IAAIiB,EAAOjW,KAAKiW,KACZrD,EAAO5S,KAAK4S,KACZzN,EAASnF,KAAKmF,OACd2R,EAAQ9W,KAAK8W,MAYjB,GAVc,UAATlE,EAEJkE,EAAQ,QAEY,MAATb,GAA0B,SAATA,GAA6B,QAATA,IAEhDa,EAAQ,cAIOtS,IAAXW,GAAiC,OAAT8Q,IAAmC,IAAlBjW,KAAKuW,gBAA2C/R,IAAnBwQ,EAAQjF,QAA2C,IAAnBiF,EAAQjF,QAAnH,CAEA+C,EAAI0D,cAAexB,EAAShV,KAAKmS,QAEjC,IAAI0E,EAAiB/D,EAAI4D,iBAAkB,CAAEnE,IAAU,GAAQ,KAAO,EAEtE,IAAwB,IAAnBsE,EAAL,CAMA,GAJApD,EAASrL,KAAMyO,EAAeO,OAAQhO,IAAK8K,GAE5B,UAAV4C,GAAoBrD,EAASpK,gBAAiB8K,EAAqB1M,QAAQwB,WAElE,cAAT2J,GAEyB,IAAxBqD,EAAKoB,OAAQ,OACjB5D,EAASpD,EAAImD,EAAWnD,IAEI,IAAxB4F,EAAKoB,OAAQ,OACjB5D,EAASjE,EAAIgE,EAAWhE,IAEI,IAAxByG,EAAKoB,OAAQ,OACjB5D,EAAS0D,EAAI3D,EAAW2D,GAKV,UAAVL,EACJ3R,EAAOwC,SAASS,KAAMqL,GAAWrK,IAAKoK,GAAanK,gBAAiBqL,GAEpEvP,EAAOwC,SAASS,KAAMqL,GAAWrK,IAAKoK,GAGvCrO,EAAOwC,SAASmC,IAAK2K,GAIhBzU,KAAKsX,kBAEM,UAAVR,IAEJ3R,EAAOwC,SAAS0B,gBAAgB4J,EAAgB7K,KAAMsM,GAAmBzL,YAE5C,IAAxBgN,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAAS0I,EAAIrK,KAAKkR,MAAO/R,EAAOwC,SAAS0I,EAAIrQ,KAAKsX,iBAAoBtX,KAAKsX,kBAGtD,IAAxBrB,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAAS6H,EAAIxJ,KAAKkR,MAAO/R,EAAOwC,SAAS6H,EAAIxP,KAAKsX,iBAAoBtX,KAAKsX,kBAGtD,IAAxBrB,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAASwP,EAAInR,KAAKkR,MAAO/R,EAAOwC,SAASwP,EAAInX,KAAKsX,iBAAoBtX,KAAKsX,iBAGnFnS,EAAOwC,SAAS0B,gBAAiBqL,IAInB,UAAVoC,IAEC3R,EAAOgR,QACXhR,EAAOwC,SAASmC,IAAKiJ,EAAYwE,sBAAuBpS,EAAOgR,OAAOC,eAG1C,IAAxBH,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAAS0I,EAAIrK,KAAKkR,MAAO/R,EAAOwC,SAAS0I,EAAIrQ,KAAKsX,iBAAoBtX,KAAKsX,kBAGtD,IAAxBrB,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAAS6H,EAAIxJ,KAAKkR,MAAO/R,EAAOwC,SAAS6H,EAAIxP,KAAKsX,iBAAoBtX,KAAKsX,kBAGtD,IAAxBrB,EAAKoB,OAAQ,OACjBlS,EAAOwC,SAASwP,EAAInR,KAAKkR,MAAO/R,EAAOwC,SAASwP,EAAInX,KAAKsX,iBAAoBtX,KAAKsX,iBAG9EnS,EAAOgR,QACXhR,EAAOwC,SAASyB,IAAK2J,EAAYwE,sBAAuBpS,EAAOgR,OAAOC,qBAOnE,GAAc,UAATxD,EAAmB,CAE9B,IAA+B,IAA1BqD,EAAKoB,OAAQ,OAAiB,CAElC,IAAIG,EAAI/D,EAAS5F,SAAW2F,EAAW3F,SAElC4F,EAASlJ,IAAKiJ,GAAe,IAAIgE,IAAM,GAE5CzE,EAAY5I,IAAKqN,EAAGA,EAAGA,QAIvBzE,EAAY3K,KAAMqL,GAAWgE,OAAQjE,IAER,IAAxByC,EAAKoB,OAAQ,OACjBtE,EAAY1C,EAAI,IAEY,IAAxB4F,EAAKoB,OAAQ,OACjBtE,EAAYvD,EAAI,IAEY,IAAxByG,EAAKoB,OAAQ,OACjBtE,EAAYoE,EAAI,GAOlBhS,EAAO0E,MAAMzB,KAAMuM,GAAc+C,SAAU3E,QAErC,GAAc,WAATH,EAAoB,CAE/B,IAAI+E,EAAiB,GAAKtD,EAAcuD,WAAY7E,EAAYwE,sBAAuBvX,KAAKmS,OAAOiE,cAE/F5L,EAA4B,UAAfxK,KAAK8W,MAAoBxC,EAAkBhB,EAExDuE,EAAO3E,EAAO+C,GAEJ,MAATA,GAEJlD,EAAY3K,KAAMqL,GAAWqE,MAAOtE,GACpCE,EAAatL,KAAMoM,GACnBb,EAAgBF,EAASsE,QAASvE,IAAiBT,EAAYxI,IAAKiK,GAAQ,EAAI,GAAK,IAEjE,SAATyB,GAEXlD,EAAY3K,KAAMqL,GAAWrK,IAAKoK,GAAasE,MAAOtD,GAAM8B,YAC5D5C,EAAatL,KAAM2K,GACnBY,EAAgBF,EAASrK,IAAKoK,GAAajJ,IAAKwI,EAAY+E,MAAOtD,IAAUmD,GAEzD,MAAT1B,GAAyB,MAATA,GAAyB,MAATA,IAE3C1C,EAAanL,KAAMyP,GAAOxO,gBAAiBmB,GAE3CkJ,EAAatL,KAAMyP,GAEnB9E,EAAc8E,EAAKpQ,QACnBuL,EAAeS,EAAShM,QAAQ2B,IAAKoK,GACtB,UAAVsD,IACJ/D,EAAY1J,gBAAiBmB,GAC7BwI,EAAa3J,gBAAiB8K,IAE/BR,EAAgBX,EAAazI,IAAKwI,EAAY+E,MAAOtD,GAAM8B,aAAgBqB,GAMvE3X,KAAKgX,eAAerD,EAAgB3N,KAAKkR,MAAOvD,EAAgB3T,KAAKgX,cAAiBhX,KAAKgX,cAEhGhX,KAAK2T,cAAgBA,EAIN,UAAVmD,GAEJ3R,EAAOqF,WAAWpC,KAAMsM,GACxBvP,EAAOqF,WAAWkN,SAAUzE,EAAgB+E,iBAAkBtE,EAAcC,MAI5ExO,EAAOqF,WAAWpC,KAAM6K,EAAgB+E,iBAAkBtE,EAAcC,IACxExO,EAAOqF,WAAWkN,SAAUhD,IAM9B1U,KAAKuI,cAAeC,GACpBxI,KAAKuI,cAAesK,MAIrB7S,KAAK8V,UAAY,SAAUd,QAEFxQ,IAAnBwQ,EAAQjF,QAA2C,IAAnBiF,EAAQjF,SAExC/P,KAAKuW,UAA4B,OAAdvW,KAAKiW,OAE5BtD,EAAaC,KAAO5S,KAAK4S,KACzB5S,KAAKuI,cAAeoK,IAIrB3S,KAAKuW,UAAW,OAEQ/R,IAAnBwQ,EAAQjF,SAAuB/P,KAAKiW,KAAO,QAqEjDjW,KAAKiY,QAAU,WAEd,OAAO9T,EAAMyO,MAId5S,KAAKkY,QAAU,SAAWtF,GAEzBzO,EAAMyO,KAAOA,GAId5S,KAAKmY,mBAAqB,SAAWb,GAEpCnT,EAAMmT,gBAAkBA,GAIzBtX,KAAKoY,gBAAkB,SAAWpB,GAEjC7S,EAAM6S,aAAeA,GAItBhX,KAAKqY,QAAU,SAAWC,GAEzBnU,EAAMmU,KAAOA,GAIdtY,KAAKuY,SAAW,SAAWzB,GAE1B3S,EAAM2S,MAAQA,GAIf9W,KAAKyI,OAAS,WAEbhH,QAAQ+M,KAAM,6DAMhB0D,EAAkBb,UAAYvP,OAAO0W,OAAQ1W,OAAOwP,OAAQ9L,IAAe6L,WAAa,CAEtFE,YAAaW,EAEbuG,qBAAqB,IAKvB,IAAMnG,EAAyB,WAE9B9M,IAAetD,KAAMlC,MAErBA,KAAK2B,KAAO,yBAIZ,IAAI+W,EAAgB,IAAIlT,IAAwB,CAC/CmT,WAAW,EACXC,YAAY,EACZC,aAAa,EACbC,KAAMtT,IACNuT,KAAK,IAGFC,EAAoB,IAAIxT,IAAwB,CACnDmT,WAAW,EACXC,YAAY,EACZC,aAAa,EACbI,UAAW,EACXF,KAAK,IAKFG,EAAeR,EAAcjR,QACjCyR,EAAaC,QAAU,IAEvB,IAAIC,EAAYV,EAAcjR,QAC9B2R,EAAUD,QAAU,IAEpB,IAAIE,EAASX,EAAcjR,QAC3B4R,EAAOC,MAAMnP,IAAK,UAElB,IAAIoP,EAAWb,EAAcjR,QAC7B8R,EAASD,MAAMnP,IAAK,OAEpB,IAAIqP,EAAUd,EAAcjR,QAC5B+R,EAAQF,MAAMnP,IAAK,KAEnB,IAAIsP,EAAsBf,EAAcjR,QACxCgS,EAAoBN,QAAU,IAE9B,IAAIO,EAAuBD,EAAoBhS,QAC/CiS,EAAqBJ,MAAMnP,IAAK,UAEhC,IAAIwP,EAAqBF,EAAoBhS,QAC7CkS,EAAmBL,MAAMnP,IAAK,OAE9B,IAAIyP,EAAwBH,EAAoBhS,QAChDmS,EAAsBN,MAAMnP,IAAK,UAEjBuO,EAAcjR,QACpB6R,MAAMnP,IAAK,UAErB,IAAI0P,EAAab,EAAkBvR,QACnCoS,EAAWP,MAAMnP,IAAK,UAEtB,IAAI2P,EAAed,EAAkBvR,QACrCqS,EAAaR,MAAMnP,IAAK,OAExB,IAAI4P,EAAcf,EAAkBvR,QACpCsS,EAAYT,MAAMnP,IAAK,KAEvB,IAAI6P,EAAchB,EAAkBvR,QACpCuS,EAAYV,MAAMnP,IAAK,OAEvB,IAAI8P,EAAiBjB,EAAkBvR,QACvCwS,EAAeX,MAAMnP,IAAK,UAE1B,IAAI+P,EAAgBlB,EAAkBvR,QACtCyS,EAAcZ,MAAMnP,IAAK,UAEzB,IAAIgQ,EAAcnB,EAAkBvR,QACpC0S,EAAYb,MAAMnP,IAAK,SAEvB,IAAIiQ,EAA2BF,EAAczS,QAC7C2S,EAAyBjB,QAAU,IAInC,IAAIkB,EAAgB,IAAI7U,IAA8B,EAAG,IAAM,GAAK,GAAI,GAAG,GAEvE8U,EAAsB,IAAI9U,IAAyB,KAAO,KAAO,MAEjE+U,EAAe,IAAI/U,IACvB+U,EAAaC,aAAa,WAAY,IAAIhV,IAA8B,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAE9F,IAAIiV,EAAiB,SAAU7Q,EAAQ8Q,GAKtC,IAHA,IAAIC,EAAW,IAAInV,IACfoV,EAAW,GAELC,EAAI,EAAGA,GAAK,GAAKH,IAAOG,EAEjCD,EAASE,KAAM,EAAG9U,KAAK6J,IAAKgL,EAAI,GAAK7U,KAAKC,IAAO2D,EAAQ5D,KAAK0J,IAAKmL,EAAI,GAAK7U,KAAKC,IAAO2D,GAMzF,OAFA+Q,EAASH,aAAa,WAAY,IAAIhV,IAA8BoV,EAAU,IAEvED,GAkBJI,EAAiB,CACpB5H,EAAG,CACF,CAAE,IAAI3N,IAAY6U,EAAehB,GAAU,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,GAAIrT,KAAKC,GAAK,GAAK,KAAM,OACtF,CAAE,IAAIT,IAAY6U,EAAehB,GAAU,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAGrT,KAAKC,GAAK,GAAK,KAAM,OACrF,CAAE,IAAIT,IAAY+U,EAAcV,KAEjCzG,EAAG,CACF,CAAE,IAAI5N,IAAY6U,EAAed,GAAY,CAAE,EAAG,EAAG,GAAK,KAAM,KAAM,OACtE,CAAE,IAAI/T,IAAY6U,EAAed,GAAY,CAAE,EAAG,EAAG,GAAK,CAAEvT,KAAKC,GAAI,EAAG,GAAK,KAAM,OACnF,CAAE,IAAIT,IAAY+U,EAAcT,GAAgB,KAAM,CAAE,EAAG,EAAG9T,KAAKC,GAAK,KAEzEoN,EAAG,CACF,CAAE,IAAI7N,IAAY6U,EAAeb,GAAW,CAAE,EAAG,EAAG,GAAK,CAAExT,KAAKC,GAAK,EAAG,EAAG,GAAK,KAAM,OACtF,CAAE,IAAIT,IAAY6U,EAAeb,GAAW,CAAE,EAAG,EAAG,GAAK,EAAGxT,KAAKC,GAAK,EAAG,EAAG,GAAK,KAAM,OACvF,CAAE,IAAIT,IAAY+U,EAAcR,GAAe,KAAM,CAAE,GAAI/T,KAAKC,GAAK,EAAG,KAEzE+U,IAAK,CACJ,CAAE,IAAIxV,IAAY,IAAIA,IAAgC,GAAK,GAAKiU,GAAuB,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAG,KAE7GwB,GAAI,CACH,CAAE,IAAIzV,IAAY,IAAIA,IAA4B,GAAK,IAAMkU,GAAwB,CAAE,EAAG,EAAG,KAI9FwB,GAAI,CACH,CAAE,IAAI1V,IAAY,IAAIA,IAA2B,KAAO,MAASmU,GAAsB,CAAE,EAAG,IAAM,KAAQ,CAAE,EAAG3T,KAAKC,GAAK,EAAG,IAC5H,CAAE,IAAIT,IAAY+U,EAAcP,GAAe,CAAE,EAAG,IAAM,IAAO,CAAE,EAAG,EAAGhU,KAAKC,GAAK,GAAK,CAAE,KAAO,EAAG,IACpG,CAAE,IAAIT,IAAY+U,EAAcP,GAAe,CAAE,EAAG,GAAK,KAAQ,CAAE,GAAIhU,KAAKC,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAEtGkV,GAAI,CACH,CAAE,IAAI3V,IAAY,IAAIA,IAA2B,KAAO,MAASoU,GAAyB,CAAE,IAAM,EAAG,KAAQ,EAAG5T,KAAKC,GAAK,EAAG,EAAG,IAChI,CAAE,IAAIT,IAAY+U,EAAcN,GAAkB,CAAE,IAAM,EAAG,IAAO,KAAM,CAAE,KAAO,EAAG,IACtF,CAAE,IAAIzU,IAAY+U,EAAcN,GAAkB,CAAE,GAAK,EAAG,KAAQ,CAAE,GAAIjU,KAAKC,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,MAItGmV,EAAkB,CACrBjI,EAAG,CACF,CAAE,IAAI3N,IAAY,IAAIA,IAA8B,GAAK,EAAG,EAAG,EAAG,GAAG,GAAS0T,GAAgB,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAIlT,KAAKC,GAAK,KAEjImN,EAAG,CACF,CAAE,IAAI5N,IAAY,IAAIA,IAA8B,GAAK,EAAG,EAAG,EAAG,GAAG,GAAS0T,GAAgB,CAAE,EAAG,GAAK,KAEzG7F,EAAG,CACF,CAAE,IAAI7N,IAAY,IAAIA,IAA8B,GAAK,EAAG,EAAG,EAAG,GAAG,GAAS0T,GAAgB,CAAE,EAAG,EAAG,IAAO,CAAElT,KAAKC,GAAK,EAAG,EAAG,KAEhI+U,IAAK,CACJ,CAAE,IAAIxV,IAAY,IAAIA,IAAgC,GAAK,GAAK0T,KAEjE+B,GAAI,CACH,CAAE,IAAIzV,IAAY,IAAIA,IAA4B,GAAK,IAAM0T,GAAgB,CAAE,EAAG,EAAG,KAEtFgC,GAAI,CACH,CAAE,IAAI1V,IAAY,IAAIA,IAA2B,GAAK,IAAO0T,GAAgB,CAAE,EAAG,GAAK,IAAO,CAAE,EAAGlT,KAAKC,GAAK,EAAG,KAEjHkV,GAAI,CACH,CAAE,IAAI3V,IAAY,IAAIA,IAA2B,GAAK,IAAO0T,GAAgB,CAAE,GAAK,EAAG,IAAO,EAAGlT,KAAKC,GAAK,EAAG,EAAG,MAI/GoV,EAAkB,CACrBC,MAAO,CACN,CAAE,IAAI9V,IAAY,IAAIA,IAAgC,IAAM,GAAK4T,GAAa,KAAM,KAAM,KAAM,WAEjGmC,IAAK,CACJ,CAAE,IAAI/V,IAAY,IAAIA,IAAgC,IAAM,GAAK4T,GAAa,KAAM,KAAM,KAAM,WAEjGoC,MAAO,CACN,CAAE,IAAIhW,IAhFsB,SAAUoE,EAAQ8Q,GAE/C,IAAIC,EAAW,IAAInV,IAInB,OAFAmV,EAASH,aAAa,WAAY,IAAIhV,IAA8B,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAEnFmV,EA0EYc,GAA2BrC,GAAa,KAAM,KAAM,KAAM,WAE7EjG,EAAG,CACF,CAAE,IAAI3N,IAAY+U,EAAcnB,EAAU3R,SAAW,EAAG,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,WAE3F2L,EAAG,CACF,CAAE,IAAI5N,IAAY+U,EAAcnB,EAAU3R,SAAW,CAAE,GAAI,IAAK,GAAK,CAAE,EAAG,EAAGzB,KAAKC,GAAK,GAAK,CAAE,IAAK,EAAG,GAAK,WAE5GoN,EAAG,CACF,CAAE,IAAI7N,IAAY+U,EAAcnB,EAAU3R,SAAW,CAAE,EAAG,GAAI,KAAO,CAAE,GAAIzB,KAAKC,GAAK,EAAG,GAAK,CAAE,IAAK,EAAG,GAAK,YAI1GyV,EAAc,CACjBvI,EAAG,CACF,CAAE,IAAI3N,IAAYiV,EAAgB,EAAG,IAAOZ,IAC5C,CAAE,IAAIrU,IAAY,IAAIA,IAAgC,IAAM,GAAK6T,GAAU,CAAE,EAAG,EAAG,KAAQ,KAAM,CAAE,EAAG,EAAG,KAE1GjG,EAAG,CACF,CAAE,IAAI5N,IAAYiV,EAAgB,EAAG,IAAOX,GAAgB,KAAM,CAAE,EAAG,GAAI9T,KAAKC,GAAK,IACrF,CAAE,IAAIT,IAAY,IAAIA,IAAgC,IAAM,GAAK+T,GAAY,CAAE,EAAG,EAAG,KAAQ,KAAM,CAAE,EAAG,EAAG,KAE5GlG,EAAG,CACF,CAAE,IAAI7N,IAAYiV,EAAgB,EAAG,IAAOV,GAAe,KAAM,CAAE,EAAG/T,KAAKC,GAAK,EAAG,IACnF,CAAE,IAAIT,IAAY,IAAIA,IAAgC,IAAM,GAAKgU,GAAW,CAAE,IAAM,EAAG,GAAK,KAAM,CAAE,EAAG,EAAG,KAE3GmC,EAAG,CACF,CAAE,IAAInW,IAAYiV,EAAgB,KAAM,GAAKL,GAA4B,KAAM,CAAE,EAAGpU,KAAKC,GAAK,EAAG,IACjG,CAAE,IAAIT,IAAY,IAAIA,IAA8B,IAAM,EAAG,IAAM,EAAG,GAAG,GAAS4U,GAA4B,CAAE,KAAM,EAAG,GAAK,CAAE,EAAG,GAAIpU,KAAKC,GAAK,GAAK,CAAE,EAAG,EAAG,OAC9J,CAAE,IAAIT,IAAY,IAAIA,IAA8B,IAAM,EAAG,IAAM,EAAG,GAAG,GAAS4U,GAA4B,EAAG,KAAM,EAAG,GAAK,CAAE,EAAG,EAAGpU,KAAKC,GAAK,GAAK,CAAE,EAAG,EAAG,OAC9J,CAAE,IAAIT,IAAY,IAAIA,IAA8B,IAAM,EAAG,IAAM,EAAG,GAAG,GAAS4U,GAA4B,CAAE,GAAI,KAAM,GAAK,CAAEpU,KAAKC,GAAI,EAAG,GAAK,CAAE,EAAG,EAAG,OAC1J,CAAE,IAAIT,IAAY,IAAIA,IAA8B,IAAM,EAAG,IAAM,EAAG,GAAG,GAAS4U,GAA4B,CAAE,EAAG,KAAM,GAAK,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAG,QAEpJwB,KAAM,CACL,CAAE,IAAIpW,IAAYiV,EAAgB,EAAG,GAAKN,GAAe,KAAM,CAAE,EAAGnU,KAAKC,GAAK,EAAG,MAI/E4V,EAAe,CAClBC,KAAM,CACL,CAAE,IAAItW,IAAY+U,EAAcnB,EAAU3R,SAAW,EAAG,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,YAIxFsU,EAAe,CAClB5I,EAAG,CACF,CAAE,IAAI3N,IAAY,IAAIA,IAA2B,EAAG,GAAK,EAAG,IAAM0T,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAE,GAAIlT,KAAKC,GAAK,GAAID,KAAKC,GAAK,KAE9HmN,EAAG,CACF,CAAE,IAAI5N,IAAY,IAAIA,IAA2B,EAAG,GAAK,EAAG,IAAM0T,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAElT,KAAKC,GAAK,EAAG,EAAG,KAElHoN,EAAG,CACF,CAAE,IAAI7N,IAAY,IAAIA,IAA2B,EAAG,GAAK,EAAG,IAAM0T,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,GAAIlT,KAAKC,GAAK,KAEnH0V,EAAG,CACF,CAAE,IAAInW,IAAY,IAAIA,IAA2B,KAAM,GAAK,EAAG,IAAM0T,KAEtE0C,KAAM,CACL,CAAE,IAAIpW,IAAY,IAAIA,IAA4B,GAAK,GAAI,GAAK0T,MAI9D8C,EAAa,CAChB7I,EAAG,CACF,CAAE,IAAI3N,IAAY8U,EAAqBjB,GAAU,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAIrT,KAAKC,GAAK,IACnF,CAAE,IAAIT,IAAY+U,EAAcV,GAAc,KAAM,KAAM,CAAE,GAAK,EAAG,KAErEzG,EAAG,CACF,CAAE,IAAI5N,IAAY8U,EAAqBf,GAAY,CAAE,EAAG,GAAK,IAC7D,CAAE,IAAI/T,IAAY+U,EAAcT,GAAgB,KAAM,CAAE,EAAG,EAAG9T,KAAKC,GAAK,GAAK,CAAE,GAAK,EAAG,KAExFoN,EAAG,CACF,CAAE,IAAI7N,IAAY8U,EAAqBd,GAAW,CAAE,EAAG,EAAG,IAAO,CAAExT,KAAKC,GAAK,EAAG,EAAG,IACnF,CAAE,IAAIT,IAAY+U,EAAcR,GAAe,KAAM,CAAE,GAAI/T,KAAKC,GAAK,EAAG,GAAK,CAAE,GAAK,EAAG,KAExFgV,GAAI,CACH,CAAE,IAAIzV,IAAY8U,EAAqBZ,GAAwB,CAAE,IAAM,IAAM,GAAK,KAAM,CAAE,EAAG,EAAG,KAChG,CAAE,IAAIlU,IAAY+U,EAAcL,GAAiB,CAAE,KAAO,IAAM,GAAK,KAAM,CAAE,KAAO,EAAG,IACvF,CAAE,IAAI1U,IAAY+U,EAAcL,GAAiB,CAAE,IAAM,KAAO,GAAK,CAAE,EAAG,EAAGlU,KAAKC,GAAK,GAAK,CAAE,KAAO,EAAG,KAEzGiV,GAAI,CACH,CAAE,IAAI1V,IAAY8U,EAAqBX,GAAsB,CAAE,EAAG,IAAM,KAAQ,KAAM,CAAE,GAAK,EAAG,IAChG,CAAE,IAAInU,IAAY+U,EAAcP,GAAe,CAAE,EAAG,KAAO,KAAQ,CAAE,EAAG,EAAGhU,KAAKC,GAAK,GAAK,CAAE,KAAO,EAAG,IACtG,CAAE,IAAIT,IAAY+U,EAAcP,GAAe,CAAE,EAAG,IAAM,MAAS,CAAE,GAAIhU,KAAKC,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAExGkV,GAAI,CACH,CAAE,IAAI3V,IAAY8U,EAAqBV,GAAyB,CAAE,IAAM,EAAG,KAAQ,KAAM,CAAE,EAAG,GAAK,IACnG,CAAE,IAAIpU,IAAY+U,EAAcN,GAAkB,CAAE,KAAO,EAAG,KAAQ,KAAM,CAAE,KAAO,EAAG,IACxF,CAAE,IAAIzU,IAAY+U,EAAcN,GAAkB,CAAE,IAAM,EAAG,MAAS,CAAE,GAAIjU,KAAKC,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAE3GgW,KAAM,CACL,CAAE,IAAIzW,IAAY,IAAIA,IAAyB,KAAO,KAAO,MAASiU,GAAuB,CAAE,IAAK,EAAG,KAExGyC,KAAM,CACL,CAAE,IAAI1W,IAAY,IAAIA,IAAyB,KAAO,KAAO,MAASiU,GAAuB,CAAE,EAAG,IAAK,KAExG0C,KAAM,CACL,CAAE,IAAI3W,IAAY,IAAIA,IAAyB,KAAO,KAAO,MAASiU,GAAuB,CAAE,EAAG,EAAG,QAInG2C,EAAc,CACjBjJ,EAAG,CACF,CAAE,IAAI3N,IAAY,IAAIA,IAA8B,GAAK,EAAG,GAAK,EAAG,GAAG,GAAS0T,GAAgB,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAIlT,KAAKC,GAAK,KAEnImN,EAAG,CACF,CAAE,IAAI5N,IAAY,IAAIA,IAA8B,GAAK,EAAG,GAAK,EAAG,GAAG,GAAS0T,GAAgB,CAAE,EAAG,GAAK,KAE3G7F,EAAG,CACF,CAAE,IAAI7N,IAAY,IAAIA,IAA8B,GAAK,EAAG,GAAK,EAAG,GAAG,GAAS0T,GAAgB,CAAE,EAAG,EAAG,IAAO,CAAElT,KAAKC,GAAK,EAAG,EAAG,KAElIgV,GAAI,CACH,CAAE,IAAIzV,IAAY8U,EAAqBpB,GAAgB,CAAE,IAAM,IAAM,GAAK,KAAM,CAAE,EAAG,EAAG,MAEzFgC,GAAI,CACH,CAAE,IAAI1V,IAAY8U,EAAqBpB,GAAgB,CAAE,EAAG,IAAM,KAAQ,KAAM,CAAE,GAAK,EAAG,KAE3FiC,GAAI,CACH,CAAE,IAAI3V,IAAY8U,EAAqBpB,GAAgB,CAAE,IAAM,EAAG,KAAQ,KAAM,CAAE,EAAG,GAAK,KAE3F+C,KAAM,CACL,CAAE,IAAIzW,IAAY,IAAIA,IAAyB,GAAK,GAAK,IAAO0T,GAAgB,CAAE,IAAK,EAAG,KAE3FgD,KAAM,CACL,CAAE,IAAI1W,IAAY,IAAIA,IAAyB,GAAK,GAAK,IAAO0T,GAAgB,CAAE,EAAG,IAAK,KAE3FiD,KAAM,CACL,CAAE,IAAI3W,IAAY,IAAIA,IAAyB,GAAK,GAAK,IAAO0T,GAAgB,CAAE,EAAG,EAAG,QAItFmD,EAAc,CACjBlJ,EAAG,CACF,CAAE,IAAI3N,IAAY+U,EAAcnB,EAAU3R,SAAW,EAAG,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,WAE3F2L,EAAG,CACF,CAAE,IAAI5N,IAAY+U,EAAcnB,EAAU3R,SAAW,CAAE,GAAI,IAAK,GAAK,CAAE,EAAG,EAAGzB,KAAKC,GAAK,GAAK,CAAE,IAAK,EAAG,GAAK,WAE5GoN,EAAG,CACF,CAAE,IAAI7N,IAAY+U,EAAcnB,EAAU3R,SAAW,CAAE,EAAG,GAAI,KAAO,CAAE,GAAIzB,KAAKC,GAAK,EAAG,GAAK,CAAE,IAAK,EAAG,GAAK,YAM1GqW,EAAa,SAAUC,GAE1B,IAAIC,EAAQ,IAAIhX,IAEhB,IAAM,IAAIoR,KAAQ2F,EAEjB,IAAM,IAAI1B,EAAI0B,EAAU3F,GAAO/I,OAAQgN,KAAQ,CAE9C,IAAI1V,EAASoX,EAAU3F,GAAQiE,GAAK,GAAIpT,QACpCE,EAAW4U,EAAU3F,GAAQiE,GAAK,GAClC5D,EAAWsF,EAAU3F,GAAQiE,GAAK,GAClChR,EAAQ0S,EAAU3F,GAAQiE,GAAK,GAC/B4B,EAAMF,EAAU3F,GAAQiE,GAAK,GAGjC1V,EAAOyR,KAAOA,EACdzR,EAAOsX,IAAMA,EAET9U,GACHxC,EAAOwC,SAASwC,IAAIxC,EAAU,GAAKA,EAAU,GAAKA,EAAU,IAEzDsP,GACH9R,EAAO8R,SAAS9M,IAAI8M,EAAU,GAAKA,EAAU,GAAKA,EAAU,IAEzDpN,GACH1E,EAAO0E,MAAMM,IAAIN,EAAO,GAAKA,EAAO,GAAKA,EAAO,IAGjD1E,EAAOuX,eAEP,IAAIC,EAAexX,EAAOwV,SAASlT,QACnCkV,EAAaC,YAAYzX,EAAO8I,QAChC9I,EAAOwV,SAAWgC,EAElBxX,EAAOwC,SAASwC,IAAK,EAAG,EAAG,GAC3BhF,EAAO8R,SAAS9M,IAAK,EAAG,EAAG,GAC3BhF,EAAO0E,MAAMM,IAAI,EAAG,EAAG,GAEvBqS,EAAM1S,IAAI3E,GAMZ,OAAOqX,GAMJK,EAAa,IAAIrX,IAAe,EAAG,EAAG,GACtCsX,EAAY,IAAItX,IAChBuX,EAAc,IAAIvX,IAAe,EAAG,EAAG,GACvCwX,EAAa,IAAIxX,IAAe,EAAG,EAAG,GACtCyX,EAAe,IAAIzX,IACnB0X,EAAiB,IAAI1X,IACrB2X,EAAkB,IAAI3X,IACtB4X,EAAqB,IAAI5X,IAEzB6X,EAAQ,IAAI7X,IAAe,EAAG,EAAG,GACjC8X,EAAQ,IAAI9X,IAAe,EAAG,EAAG,GACjC+X,EAAQ,IAAI/X,IAAe,EAAG,EAAG,GAIrCxF,KAAKwc,MAAQ,GACbxc,KAAK2W,OAAS,GACd3W,KAAKwd,OAAS,GAEdxd,KAAK8J,IAAK9J,KAAKwc,MAAL,UAA4BF,EAAYvB,IAClD/a,KAAK8J,IAAK9J,KAAKwc,MAAL,OAAyBF,EAAYZ,IAC/C1b,KAAK8J,IAAK9J,KAAKwc,MAAL,MAAwBF,EAAYN,IAC9Chc,KAAK8J,IAAK9J,KAAK2W,OAAL,UAA6B2F,EAAYlB,IACnDpb,KAAK8J,IAAK9J,KAAK2W,OAAL,OAA0B2F,EAAYP,IAChD/b,KAAK8J,IAAK9J,KAAK2W,OAAL,MAAyB2F,EAAYF,IAC/Cpc,KAAK8J,IAAK9J,KAAKwd,OAAL,UAA6BlB,EAAYjB,IACnDrb,KAAK8J,IAAK9J,KAAKwd,OAAL,OAA0BlB,EAAYT,IAChD7b,KAAK8J,IAAK9J,KAAKwd,OAAL,MAAyBlB,EAAYD,IAI/Crc,KAAK2W,OAAL,UAA2BvE,SAAU,EACrCpS,KAAK2W,OAAL,OAAwBvE,SAAU,EAClCpS,KAAK2W,OAAL,MAAuBvE,SAAU,EAIjCpS,KAAKkW,kBAAoB,WAExB,IAAIY,EAAQ9W,KAAK8W,MAEE,UAAd9W,KAAK4S,OAAmBkE,EAAQ,SAErC,IAAItM,EAAuB,UAAVsM,EAAoB9W,KAAKsU,gBAAkB8I,EAI5Dpd,KAAKwc,MAAL,UAA0BpK,QAAwB,cAAdpS,KAAK4S,KACzC5S,KAAKwc,MAAL,OAAuBpK,QAAwB,WAAdpS,KAAK4S,KACtC5S,KAAKwc,MAAL,MAAsBpK,QAAwB,UAAdpS,KAAK4S,KAErC5S,KAAKwd,OAAL,UAA2BpL,QAAwB,cAAdpS,KAAK4S,KAC1C5S,KAAKwd,OAAL,OAAwBpL,QAAwB,WAAdpS,KAAK4S,KACvC5S,KAAKwd,OAAL,MAAuBpL,QAAwB,UAAdpS,KAAK4S,KAGtC,IAAI6K,EAAU,GAGdA,GADAA,GADAA,EAAUA,EAAQC,OAAQ1d,KAAK2W,OAAQ3W,KAAK4S,MAAOpS,WACjCkd,OAAQ1d,KAAKwc,MAAOxc,KAAK4S,MAAOpS,WAChCkd,OAAQ1d,KAAKwd,OAAQxd,KAAK4S,MAAOpS,UAEnD,IAAM,IAAIqa,EAAI,EAAGA,EAAI4C,EAAQ5P,OAAQgN,IAAM,CAE1C,IAAI8C,EAASF,EAAQ5C,GAIrB8C,EAAOvL,SAAU,EACjBuL,EAAO1G,SAAS9M,IAAK,EAAG,EAAG,GAC3BwT,EAAOhW,SAASS,KAAMpI,KAAKqU,eAE3B,IAAIuJ,EAAc5d,KAAKqU,cAAcuD,WAAY5X,KAAK4T,gBAKtD,GAJA+J,EAAO9T,MAAMM,IAAK,EAAG,EAAG,GAAID,eAAgB0T,EAAc5d,KAAKsY,KAAO,GAIlD,WAAfqF,EAAOlB,IAAZ,CA6GA,GAFAkB,EAAOnT,WAAWpC,KAAMoC,GAEL,cAAdxK,KAAK4S,MAAsC,UAAd5S,KAAK4S,KAAmB,CASpC,MAAhB+K,EAAO/G,MAAgC,SAAhB+G,EAAO/G,MAC7B5Q,KAAK4J,IAAKmN,EAAY3U,KAAMiV,GAAQhU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MANzD,MAOvBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,GAGE,MAAhBuL,EAAO/G,MAAgC,SAAhB+G,EAAO/G,MAC7B5Q,KAAK4J,IAAKmN,EAAY3U,KAAMkV,GAAQjU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAZzD,MAavBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,GAGE,MAAhBuL,EAAO/G,MAAgC,SAAhB+G,EAAO/G,MAC7B5Q,KAAK4J,IAAKmN,EAAY3U,KAAMmV,GAAQlU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAlBzD,MAmBvBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,GAGE,OAAhBuL,EAAO/G,MACN5Q,KAAK4J,IAAKmN,EAAY3U,KAAMmV,GAAQlU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAvBxD,KAwBxBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,GAGE,OAAhBuL,EAAO/G,MACN5Q,KAAK4J,IAAKmN,EAAY3U,KAAMiV,GAAQhU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MA7BxD,KA8BxBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,GAGE,OAAhBuL,EAAO/G,MACN5Q,KAAK4J,IAAKmN,EAAY3U,KAAMkV,GAAQjU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAnCxD,KAoCxBmJ,EAAO9T,MAAMM,IAAK,MAAO,MAAO,OAChCwT,EAAOvL,SAAU,IAMiB,IAA/BuL,EAAO/G,KAAKS,OAAQ,OACnB0F,EAAY3U,KAAMiV,GAAQhU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MA3C/C,GA4CH,QAAfmJ,EAAOlB,IACXkB,EAAOvL,SAAU,EAEjBuL,EAAO9T,MAAMwG,IAAM,EAEM,QAAfsN,EAAOlB,MAClBkB,EAAOvL,SAAU,KAIiB,IAA/BuL,EAAO/G,KAAKS,OAAQ,OACnB0F,EAAY3U,KAAMkV,GAAQjU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAvD/C,GAwDH,QAAfmJ,EAAOlB,IACXkB,EAAOvL,SAAU,EAEjBuL,EAAO9T,MAAM2F,IAAM,EAEM,QAAfmO,EAAOlB,MAClBkB,EAAOvL,SAAU,KAIiB,IAA/BuL,EAAO/G,KAAKS,OAAQ,OACnB0F,EAAY3U,KAAMmV,GAAQlU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAnE/C,GAoEH,QAAfmJ,EAAOlB,IACXkB,EAAOvL,SAAU,EAEjBuL,EAAO9T,MAAMsN,IAAM,EAEM,QAAfwG,EAAOlB,MAClBkB,EAAOvL,SAAU,QAIM,WAAdpS,KAAK4S,OAIhBuK,EAAgB/U,KAAMoC,GACtBuS,EAAY3U,KAAMpI,KAAKwU,KAAMnL,gBAAiB6T,EAAe9U,KAAMoC,GAAavB,YAE3C,IAAhC0U,EAAO/G,KAAKS,OAAQ,MAExBsG,EAAOnT,WAAWqT,sBAAuBZ,EAAahT,OAAQjK,KAAKwU,IAAKwI,EAAYM,IAIhE,MAAhBK,EAAO/G,OAEXsG,EAAelF,iBAAkBqF,EAAOrX,KAAK8X,OAAQf,EAAYvN,EAAGuN,EAAY5F,IAChF+F,EAAea,oBAAqBZ,EAAiBD,GACrDS,EAAOnT,WAAWpC,KAAM8U,IAIJ,MAAhBS,EAAO/G,OAEXsG,EAAelF,iBAAkBsF,EAAOtX,KAAK8X,MAAOf,EAAY1M,EAAG0M,EAAY5F,IAC/E+F,EAAea,oBAAqBZ,EAAiBD,GACrDS,EAAOnT,WAAWpC,KAAM8U,IAIJ,MAAhBS,EAAO/G,OAEXsG,EAAelF,iBAAkBuF,EAAOvX,KAAK8X,MAAOf,EAAYvN,EAAGuN,EAAY1M,IAC/E6M,EAAea,oBAAqBZ,EAAiBD,GACrDS,EAAOnT,WAAWpC,KAAM8U,KAO1BS,EAAOvL,QAAUuL,EAAOvL,WAA6C,IAAhCuL,EAAO/G,KAAKoH,QAAS,MAAgBhe,KAAKie,OAC/EN,EAAOvL,QAAUuL,EAAOvL,WAA6C,IAAhCuL,EAAO/G,KAAKoH,QAAS,MAAgBhe,KAAKke,OAC/EP,EAAOvL,QAAUuL,EAAOvL,WAA6C,IAAhCuL,EAAO/G,KAAKoH,QAAS,MAAgBhe,KAAKme,OAC/ER,EAAOvL,QAAUuL,EAAOvL,WAA6C,IAAhCuL,EAAO/G,KAAKoH,QAAS,MAAkBhe,KAAKie,OAASje,KAAKke,OAASle,KAAKme,OAI7GR,EAAOS,SAASC,SAAWV,EAAOS,SAASC,UAAYV,EAAOS,SAASjF,QACvEwE,EAAOS,SAASE,OAASX,EAAOS,SAASE,QAAUX,EAAOS,SAAS9E,MAAM7R,QAEzEkW,EAAOS,SAAS9E,MAAMlR,KAAMuV,EAAOS,SAASE,QAC5CX,EAAOS,SAASjF,QAAUwE,EAAOS,SAASC,SAEpCre,KAAKsF,QAKCtF,KAAKiW,OAEX0H,EAAO/G,OAAS5W,KAAKiW,MAEzB0H,EAAOS,SAASjF,QAAU,EAC1BwE,EAAOS,SAAS9E,MAAMiF,KAAM,IAAI/Y,IAAa,EAAG,EAAG,GAAK,KAE7CxF,KAAKiW,KAAKuI,MAAM,IAAIC,KAAM,SAAUve,GAAM,OAAOyd,EAAO/G,OAAS1W,KAE5Eyd,EAAOS,SAASjF,QAAU,EAC1BwE,EAAOS,SAAS9E,MAAMiF,KAAM,IAAI/Y,IAAa,EAAG,EAAG,GAAK,MAIxDmY,EAAOS,SAASjF,SAAW,IAC3BwE,EAAOS,SAAS9E,MAAMiF,KAAM,IAAI/Y,IAAa,EAAG,EAAG,GAAK,OAlBzDmY,EAAOS,SAASjF,SAAW,GAC3BwE,EAAOS,SAAS9E,MAAMiF,KAAM,IAAI/Y,IAAa,EAAG,EAAG,GAAK,UAvPxDmY,EAAOvL,SAAU,EAEI,SAAhBuL,EAAO/G,MAEX+G,EAAOhW,SAASS,KAAMpI,KAAKkU,oBAC3ByJ,EAAOvL,UAAYpS,KAAKiW,KAEL,MAAdjW,KAAKiW,OAETiH,EAAewB,aAAc5B,EAAU3S,IAAK,EAAG,EAAG,IAClDwT,EAAOnT,WAAWpC,KAAMoC,GAAakN,SAAUwF,GAE1ClX,KAAK4J,IAAKmN,EAAY3U,KAAMiV,GAAQhU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAAU,KAC1FmJ,EAAOvL,SAAU,IAKA,MAAdpS,KAAKiW,OAETiH,EAAewB,aAAc5B,EAAU3S,IAAK,EAAG,EAAGnE,KAAKC,GAAK,IAC5D0X,EAAOnT,WAAWpC,KAAMoC,GAAakN,SAAUwF,GAE1ClX,KAAK4J,IAAKmN,EAAY3U,KAAMkV,GAAQjU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAAU,KAC1FmJ,EAAOvL,SAAU,IAKA,MAAdpS,KAAKiW,OAETiH,EAAewB,aAAc5B,EAAU3S,IAAK,EAAGnE,KAAKC,GAAK,EAAG,IAC5D0X,EAAOnT,WAAWpC,KAAMoC,GAAakN,SAAUwF,GAE1ClX,KAAK4J,IAAKmN,EAAY3U,KAAMmV,GAAQlU,gBAAiBmB,GAAaD,IAAKvK,KAAKwU,MAAU,KAC1FmJ,EAAOvL,SAAU,IAKA,SAAdpS,KAAKiW,OAETiH,EAAewB,aAAc5B,EAAU3S,IAAK,EAAGnE,KAAKC,GAAK,EAAG,IAC5D8W,EAAY3U,KAAMpI,KAAK0T,cACvBiK,EAAOnT,WAAWqT,sBAAuBZ,EAAahT,OAAQ+S,EAAYD,EAAaO,IACvFK,EAAOnT,WAAWkN,SAAUwF,GAC5BS,EAAOvL,QAAUpS,KAAKuW,UAIJ,MAAdvW,KAAKiW,OAET0H,EAAOvL,SAAU,IAKS,UAAhBuL,EAAO/G,MAElB+G,EAAOhW,SAASS,KAAMpI,KAAKkU,oBAC3ByJ,EAAOvL,QAAUpS,KAAKuW,UAEK,QAAhBoH,EAAO/G,MAElB+G,EAAOhW,SAASS,KAAMpI,KAAKqU,eAC3BsJ,EAAOvL,QAAUpS,KAAKuW,UAEK,UAAhBoH,EAAO/G,MAElB+G,EAAOhW,SAASS,KAAMpI,KAAKkU,oBAC3ByJ,EAAOnT,WAAWpC,KAAMpI,KAAKmU,sBAC7B0I,EAAW1S,IAAK,MAAO,MAAO,OAAQL,IAAK9J,KAAKkU,oBAAqB9K,IAAKpJ,KAAKqU,eAAgBnK,gBAAiB,GAChH2S,EAAWxT,gBAAiBrJ,KAAKmU,qBAAqB1M,QAAQwB,WAC9D0U,EAAO9T,MAAMzB,KAAMyU,GACnBc,EAAOvL,QAAUpS,KAAKuW,WAItBoH,EAAOnT,WAAWpC,KAAMoC,GAEnBxK,KAAKuW,SAEToH,EAAOhW,SAASS,KAAMpI,KAAKkU,oBAI3ByJ,EAAOhW,SAASS,KAAMpI,KAAKqU,eAIvBrU,KAAKiW,OAET0H,EAAOvL,SAA+C,IAArCpS,KAAKiW,KAAKoB,OAAQsG,EAAO/G,QAoL9CpR,IAAe6L,UAAU6E,kBAAkBhU,KAAMlC,QAMnDsS,EAAuBjB,UAAYvP,OAAO0W,OAAQ1W,OAAOwP,OAAQ9L,IAAe6L,WAAa,CAE5FE,YAAae,EAEbqM,0BAA0B,IAK3B,IAAMnM,EAAyB,WAE9BhN,IAAWtD,KAAMlC,KAChB,IAAIwF,IAA2B,IAAQ,IAAQ,EAAG,GAClD,IAAIA,IAAyB,CAAE4M,SAAS,EAAOwM,WAAW,EAAM9F,KAAMtT,IAAkBqT,aAAa,EAAMM,QAAS,MAGrHnZ,KAAK2B,KAAO,yBAEZ,IAAI0b,EAAQ,IAAI7X,IAAe,EAAG,EAAG,GACjC8X,EAAQ,IAAI9X,IAAe,EAAG,EAAG,GACjC+X,EAAQ,IAAI/X,IAAe,EAAG,EAAG,GAEjCqX,EAAa,IAAIrX,IACjBqZ,EAAY,IAAIrZ,IAChBuX,EAAc,IAAIvX,IAClBsZ,EAAa,IAAItZ,IACjB4X,EAAqB,IAAI5X,IAE7BxF,KAAKkW,kBAAoB,WAExB,IAAIY,EAAQ9W,KAAK8W,MAcjB,OAZA9W,KAAK2H,SAASS,KAAMpI,KAAKqU,eAEN,UAAdrU,KAAK4S,OAAmBkE,EAAQ,SAErCuG,EAAMlT,IAAK,EAAG,EAAG,GAAId,gBAA2B,UAAVyN,EAAoB9W,KAAKsU,gBAAkB8I,GACjFE,EAAMnT,IAAK,EAAG,EAAG,GAAId,gBAA2B,UAAVyN,EAAoB9W,KAAKsU,gBAAkB8I,GACjFG,EAAMpT,IAAK,EAAG,EAAG,GAAId,gBAA2B,UAAVyN,EAAoB9W,KAAKsU,gBAAkB8I,GAIjFL,EAAY3U,KAAMkV,GAETtd,KAAK4S,MACb,IAAK,YACL,IAAK,QACJ,OAAS5S,KAAKiW,MACb,IAAK,IACJ8G,EAAY3U,KAAMpI,KAAKwU,KAAMsD,MAAOuF,GACpCwB,EAAUzW,KAAMiV,GAAQvF,MAAOiF,GAC/B,MACD,IAAK,IACJA,EAAY3U,KAAMpI,KAAKwU,KAAMsD,MAAOwF,GACpCuB,EAAUzW,KAAMkV,GAAQxF,MAAOiF,GAC/B,MACD,IAAK,IACJA,EAAY3U,KAAMpI,KAAKwU,KAAMsD,MAAOyF,GACpCsB,EAAUzW,KAAMmV,GAAQzF,MAAOiF,GAC/B,MACD,IAAK,KACJ8B,EAAUzW,KAAMmV,GAChB,MACD,IAAK,KACJsB,EAAUzW,KAAMiV,GAChB,MACD,IAAK,KACJN,EAAY3U,KAAMmV,GAClBsB,EAAUzW,KAAMkV,GAChB,MACD,IAAK,MACL,IAAK,IACJuB,EAAU1U,IAAK,EAAG,EAAG,GAGvB,MACD,IAAK,SACL,QAEC0U,EAAU1U,IAAK,EAAG,EAAG,GAGK,IAAvB0U,EAAUhR,SAGd7N,KAAKwK,WAAWpC,KAAMpI,KAAK6T,mBAI3BiL,EAAW7U,OAAQ4S,EAAW1S,IAAK,EAAG,EAAG,GAAK0U,EAAW9B,GAEzD/c,KAAKwK,WAAWqT,sBAAuBiB,IAIxCtZ,IAAe6L,UAAU6E,kBAAkBhU,KAAMlC,QAMnDwS,EAAuBnB,UAAYvP,OAAO0W,OAAQ1W,OAAOwP,OAAQ9L,IAAW6L,WAAa,CAExFE,YAAaiB,EAEbuM,0BAA0B,IAIZ7M,QC56CX8M,EAAgB,SAAW7Z,EAAQC,GAEtCpF,KAAKmF,OAASA,EAEdnF,KAAKoF,gBAA8BZ,IAAfY,EAA6BA,EAAaC,SAG9DrF,KAAKsF,SAAU,EAGftF,KAAKuF,OAAS,IAAIC,IAGlBxF,KAAKyF,YAAc,EACnBzF,KAAK0F,YAAcC,IAGnB3F,KAAK4F,QAAU,EACf5F,KAAK6F,QAAUF,IAIf3F,KAAK8F,cAAgB,EACrB9F,KAAK+F,cAAgBC,KAAKC,GAI1BjG,KAAKkG,iBAAoBP,IACzB3F,KAAKmG,gBAAkBR,IAIvB3F,KAAKoG,eAAgB,EACrBpG,KAAKqG,cAAgB,IAIrBrG,KAAKsG,YAAa,EAClBtG,KAAKuG,UAAY,EAGjBvG,KAAKwG,cAAe,EACpBxG,KAAKyG,YAAc,EAGnBzG,KAAK0G,WAAY,EACjB1G,KAAK2G,SAAW,EAChB3G,KAAK4G,oBAAqB,EAC1B5G,KAAK6G,YAAc,EAInB7G,KAAK8G,YAAa,EAClB9G,KAAK+G,gBAAkB,EAGvB/G,KAAKgH,YAAa,EAGlBhH,KAAKiH,KAAO,CAAEC,KAAM,GAAIC,GAAI,GAAIC,MAAO,GAAIC,OAAQ,IAGnDrH,KAAKsH,aAAe,CAAEJ,KAAM1B,IAAY0B,KAAMK,OAAQ/B,IAAY+B,OAAQH,MAAO5B,IAAY4B,OAG7FpH,KAAKwH,QAAUxH,KAAKuF,OAAOkC,QAC3BzH,KAAK0H,UAAY1H,KAAKmF,OAAOwC,SAASF,QACtCzH,KAAK4H,MAAQ5H,KAAKmF,OAAO0C,KAMzB7H,KAAK8H,cAAgB,WAEpB,OAAOC,EAAUC,KAIlBhI,KAAKiI,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBlI,KAAKmI,UAAY,WAEhBhE,EAAMqD,QAAQY,KAAMjE,EAAMoB,QAC1BpB,EAAMuD,UAAUU,KAAMjE,EAAMgB,OAAOwC,UACnCxD,EAAMyD,MAAQzD,EAAMgB,OAAO0C,MAI5B7H,KAAKqI,MAAQ,WAEZlE,EAAMoB,OAAO6C,KAAMjE,EAAMqD,SACzBrD,EAAMgB,OAAOwC,SAASS,KAAMjE,EAAMuD,WAClCvD,EAAMgB,OAAO0C,KAAO1D,EAAMyD,MAE1BzD,EAAMgB,OAAOmD,yBACbnE,EAAMoE,cAAeC,GAErBrE,EAAMsE,SAENnF,EAAQoF,EAAMC,MAKf3I,KAAKyI,OAAS,WAEb,IAAIG,EAAS,IAAIpD,IAGbqD,GAAO,IAAIrD,KAAmBsD,mBAAoB3D,EAAO4D,GAAI,IAAIvD,IAAe,EAAG,EAAG,IACtFwD,EAAcH,EAAKpB,QAAQwB,UAE3BC,EAAe,IAAI1D,IACnB2D,EAAiB,IAAI3D,IAEzB,OAAO,WAEN,IAAImC,EAAWxD,EAAMgB,OAAOwC,SAkE5B,OAhEAiB,EAAOR,KAAMT,GAAWyB,IAAKjF,EAAMoB,QAGnCqD,EAAOS,gBAAiBR,GAGxBd,EAAUuB,eAAgBV,GAErBzE,EAAM2C,YAAcxD,IAAUoF,EAAMC,MAExCY,EAmIK,EAAIvD,KAAKC,GAAK,GAAK,GAAK9B,EAAM4C,iBA/HpCgB,EAAUG,OAASsB,EAAetB,MAClCH,EAAUC,KAAOwB,EAAexB,IAGhCD,EAAUG,MAAQlC,KAAKyD,IAAKtF,EAAM+B,gBAAiBF,KAAK0D,IAAKvF,EAAMgC,gBAAiB4B,EAAUG,QAG9FH,EAAUC,IAAMhC,KAAKyD,IAAKtF,EAAM2B,cAAeE,KAAK0D,IAAKvF,EAAM4B,cAAegC,EAAUC,MAExFD,EAAU4B,WAGV5B,EAAU6B,QAAUC,EAGpB9B,EAAU6B,OAAS5D,KAAKyD,IAAKtF,EAAMsB,YAAaO,KAAK0D,IAAKvF,EAAMuB,YAAaqC,EAAU6B,SAGvFzF,EAAMoB,OAAOuE,IAAKC,GAElBnB,EAAOoB,iBAAkBjC,GAGzBa,EAAOS,gBAAiBL,GAExBrB,EAASS,KAAMjE,EAAMoB,QAASuE,IAAKlB,GAEnCzE,EAAMgB,OAAO8E,OAAQ9F,EAAMoB,SAEE,IAAxBpB,EAAMiC,eAEVoD,EAAetB,OAAW,EAAI/D,EAAMkC,cACpCmD,EAAexB,KAAS,EAAI7D,EAAMkC,cAElC0D,EAAUG,eAAgB,EAAI/F,EAAMkC,iBAIpCmD,EAAeW,IAAK,EAAG,EAAG,GAE1BJ,EAAUI,IAAK,EAAG,EAAG,IAItBN,EAAQ,KAMHO,GACJlB,EAAamB,kBAAmBlG,EAAMgB,OAAOwC,UAAa2C,GAC1D,GAAM,EAAInB,EAAeoB,IAAKpG,EAAMgB,OAAOqF,aAAiBF,KAE5DnG,EAAMoE,cAAeC,GAErBU,EAAad,KAAMjE,EAAMgB,OAAOwC,UAChCwB,EAAef,KAAMjE,EAAMgB,OAAOqF,YAClCJ,GAAc,GAEP,IAzFI,GAmGdpK,KAAKyK,QAAU,WAEdtG,EAAMiB,WAAWsF,oBAAqB,cAAeC,GAAe,GACpExG,EAAMiB,WAAWsF,oBAAqB,YAAaE,GAAa,GAChEzG,EAAMiB,WAAWsF,oBAAqB,QAASG,GAAc,GAE7D1G,EAAMiB,WAAWsF,oBAAqB,aAAcI,GAAc,GAClE3G,EAAMiB,WAAWsF,oBAAqB,WAAYK,GAAY,GAC9D5G,EAAMiB,WAAWsF,oBAAqB,YAAaM,GAAa,GAEhE3F,SAASqF,oBAAqB,YAAaO,GAAa,GACxD5F,SAASqF,oBAAqB,UAAWQ,GAAW,GAEpDxH,OAAOgH,oBAAqB,UAAWS,GAAW,IAUnD,IAAIhH,EAAQnE,KAERwI,EAAc,CAAE7G,KAAM,UACtByJ,EAAa,CAAEzJ,KAAM,SACrB0J,EAAW,CAAE1J,KAAM,OAEnB+G,EAAQ,CAAEC,MAAQ,EAAG6C,OAAQ,EAAGC,MAAO,EAAGE,IAAK,EAAGsT,aAAc,EAAGC,gBAAiB,GAEpF5b,EAAQoF,EAAMC,KAEd2B,EAAM,KAGNvC,EAAY,IAAIvC,IAChBgE,EAAiB,IAAIhE,IAErBqE,EAAQ,EACRE,EAAY,IAAIvE,IAChB4E,GAAc,EAEdyB,EAAc,IAAIrG,IAClBuG,EAAY,IAAIvG,IAChByG,EAAc,IAAIzG,IAElB6G,EAAW,IAAI7G,IACf8G,EAAS,IAAI9G,IACb+G,EAAW,IAAI/G,IAEfgH,EAAa,IAAIhH,IACjBiH,EAAW,IAAIjH,IACfkH,EAAa,IAAIlH,IAQrB,SAASmH,IAER,OAAO3G,KAAK4G,IAAK,IAAMzI,EAAMoC,WAI9B,SAASgD,EAAYsD,GAEpBrD,EAAetB,OAAS2E,EAIzB,SAASC,EAAUD,GAElBrD,EAAexB,KAAO6E,EAIvB,IAAIE,EAAU,WAEb,IAAIC,EAAI,IAAIxH,IAEZ,OAAO,SAAkByH,EAAUC,GAElCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAE9C,gBAAkB+C,GAEpBlD,EAAUD,IAAKkD,IATH,GAeVI,EAAQ,WAEX,IAAIJ,EAAI,IAAIxH,IAEZ,OAAO,SAAgByH,EAAUC,IAEE,IAA7B/I,EAAMyC,mBAEVoG,EAAEG,oBAAqBD,EAAc,IAIrCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAEK,aAAclJ,EAAMgB,OAAO4D,GAAIiE,IAIlCA,EAAE9C,eAAgB+C,GAElBlD,EAAUD,IAAKkD,IAnBL,GA0BRM,EAAM,WAET,IAAI1E,EAAS,IAAIpD,IAEjB,OAAO,SAAc+H,EAAQC,GAE5B,IAAIC,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAE5E,GAAKjB,EAAMgB,OAAOwI,oBAAsB,CAGvC,IAAIhG,EAAWxD,EAAMgB,OAAOwC,SAC5BiB,EAAOR,KAAMT,GAAWyB,IAAKjF,EAAMoB,QACnC,IAAIqI,EAAiBhF,EAAOiF,SAG5BD,GAAkB5H,KAAK8H,IAAO3J,EAAMgB,OAAO4I,IAAM,EAAM/H,KAAKC,GAAK,KAGjE8G,EAAS,EAAIQ,EAASK,EAAiBH,EAAQO,aAAc7J,EAAMgB,OAAO8I,QAC1Eb,EAAO,EAAII,EAASI,EAAiBH,EAAQO,aAAc7J,EAAMgB,OAAO8I,aAE7D9J,EAAMgB,OAAO+I,sBAGxBnB,EAASQ,GAAWpJ,EAAMgB,OAAOgJ,MAAQhK,EAAMgB,OAAOiJ,MAASjK,EAAMgB,OAAO0C,KAAO4F,EAAQY,YAAalK,EAAMgB,OAAO8I,QACrHb,EAAOI,GAAWrJ,EAAMgB,OAAOmJ,IAAMnK,EAAMgB,OAAOoJ,QAAWpK,EAAMgB,OAAO0C,KAAO4F,EAAQO,aAAc7J,EAAMgB,OAAO8I,UAKpHxM,QAAQ+M,KAAM,gFACdrK,EAAMuC,WAAY,IAhCX,GAwCV,SAAS+H,EAASC,GAEZvK,EAAMgB,OAAOwI,oBAEjB9D,GAAS6E,EAEEvK,EAAMgB,OAAO+I,sBAExB/J,EAAMgB,OAAO0C,KAAO7B,KAAKyD,IAAKtF,EAAMyB,QAASI,KAAK0D,IAAKvF,EAAM0B,QAAS1B,EAAMgB,OAAO0C,KAAO6G,IAC1FvK,EAAMgB,OAAOmD,yBACb8B,GAAc,IAId3I,QAAQ+M,KAAM,uFACdrK,EAAMmC,YAAa,GAMrB,SAASqI,EAAUD,GAEbvK,EAAMgB,OAAOwI,oBAEjB9D,GAAS6E,EAEEvK,EAAMgB,OAAO+I,sBAExB/J,EAAMgB,OAAO0C,KAAO7B,KAAKyD,IAAKtF,EAAMyB,QAASI,KAAK0D,IAAKvF,EAAM0B,QAAS1B,EAAMgB,OAAO0C,KAAO6G,IAC1FvK,EAAMgB,OAAOmD,yBACb8B,GAAc,IAId3I,QAAQ+M,KAAM,uFACdrK,EAAMmC,YAAa,GA0BrB,SAAS4J,EAAoBrB,GAI5BxC,EAASlC,IAAK0E,EAAMC,QAASD,EAAME,SA8NpC,SAASnE,EAAaiE,GAErB,IAAuB,IAAlB1K,EAAMmB,QAAX,CAIA,OAFAuJ,EAAMiB,iBAEGjB,EAAMkB,QAEd,KAAK5L,EAAMmD,aAAaJ,KAEvB,GAAK2H,EAAMmB,SAAWnB,EAAMoB,QAAU,CAErC,IAAyB,IAApB9L,EAAMuC,UAAsB,OAEjCwJ,EAAoBrB,GAEpBvL,EAAQoF,EAAMiD,QAER,CAEN,IAA4B,IAAvBxH,EAAMqC,aAAyB,QAtQxC,SAAgCqI,GAI/BhD,EAAY1B,IAAK0E,EAAMC,QAASD,EAAME,SAoQnCH,CAAuBC,GAEvBvL,EAAQoF,EAAM8C,OAIf,MAED,KAAKrH,EAAMmD,aAAaC,OAEvB,IAA0B,IAArBpD,EAAMmC,WAAuB,QA1QrC,SAA+BuI,GAI9BrC,EAAWrC,IAAK0E,EAAMC,QAASD,EAAME,SAwQnCoB,CAAsBtB,GAEtBvL,EAAQoF,EAAM+C,MAEd,MAED,KAAKtH,EAAMmD,aAAaF,MAEvB,IAAyB,IAApBjD,EAAMuC,UAAsB,OAEjCwJ,EAAoBrB,GAEpBvL,EAAQoF,EAAMiD,IAMXrI,IAAUoF,EAAMC,OAEpBtD,SAAS+K,iBAAkB,YAAanF,GAAa,GACrD5F,SAAS+K,iBAAkB,UAAWlF,GAAW,GAEjD/G,EAAMoE,cAAe6C,KAMvB,SAASH,EAAa4D,GAErB,IAAuB,IAAlB1K,EAAMmB,QAIX,OAFAuJ,EAAMiB,iBAEGxM,GAER,KAAKoF,EAAM8C,OAEV,IAA4B,IAAvBrH,EAAMqC,aAAyB,QAnSvC,SAAgCqI,GAI/B9C,EAAU5B,IAAK0E,EAAMC,QAASD,EAAME,SAEpC9C,EAAYmD,WAAYrD,EAAWF,GAAc3B,eAAgB/F,EAAMsC,aAEvE,IAAIgH,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAE5EmE,EAAY,EAAIvD,KAAKC,GAAKgG,EAAYoE,EAAI5C,EAAQO,cAElDlB,EAAU,EAAI9G,KAAKC,GAAKgG,EAAYuD,EAAI/B,EAAQO,cAEhDnC,EAAYzD,KAAM2D,GAElB5H,EAAMsE,SAqRJ6H,CAAuBzB,GAEvB,MAED,KAAKnG,EAAM+C,MAEV,IAA0B,IAArBtH,EAAMmC,WAAuB,QAvRrC,SAA+BuI,GAI9BpC,EAAStC,IAAK0E,EAAMC,QAASD,EAAME,SAEnCrC,EAAW0C,WAAY3C,EAAUD,GAE5BE,EAAW8C,EAAI,EAEnBf,EAAS9B,KAEED,EAAW8C,EAAI,GAE1Bb,EAAUhC,KAIXH,EAAWpE,KAAMqE,GAEjBtI,EAAMsE,SAqQJ8H,CAAsB1B,GAEtB,MAED,KAAKnG,EAAMiD,IAEV,IAAyB,IAApBxH,EAAMuC,UAAsB,QAvQpC,SAA6BmI,GAI5BvC,EAAOnC,IAAK0E,EAAMC,QAASD,EAAME,SAEjCxC,EAAS6C,WAAY9C,EAAQD,GAAWnC,eAAgB/F,EAAMwC,UAE9D2G,EAAKf,EAAS8D,EAAG9D,EAASiD,GAE1BnD,EAASjE,KAAMkE,GAEfnI,EAAMsE,SA6PJ+H,CAAoB3B,IAQvB,SAAS3D,EAAW2D,IAEI,IAAlB1K,EAAMmB,UAIXD,SAASqF,oBAAqB,YAAaO,GAAa,GACxD5F,SAASqF,oBAAqB,UAAWQ,GAAW,GAEpD/G,EAAMoE,cAAe8C,GAErB/H,EAAQoF,EAAMC,MAIf,SAASkC,EAAcgE,IAEC,IAAlB1K,EAAMmB,UAA0C,IAArBnB,EAAMmC,YAA0BhD,IAAUoF,EAAMC,MAAQrF,IAAUoF,EAAM8C,SAExGqD,EAAMiB,iBACNjB,EAAM4B,kBAENtM,EAAMoE,cAAe6C,GAjRtB,SAA2ByD,GAIrBA,EAAMrB,OAAS,EAEnBmB,EAAUhC,KAECkC,EAAMrB,OAAS,GAE1BiB,EAAS9B,KAIVxI,EAAMsE,SAqQNiI,CAAkB7B,GAElB1K,EAAMoE,cAAe8C,IAItB,SAASF,EAAW0D,IAEI,IAAlB1K,EAAMmB,UAA0C,IAArBnB,EAAM6C,aAA4C,IAApB7C,EAAMuC,WAzQrE,SAAwBmI,GAIvB,OAASA,EAAM8B,SAEd,KAAKxM,EAAM8C,KAAKE,GACfmG,EAAK,EAAGnJ,EAAM0C,aACd1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKI,OACfiG,EAAK,GAAKnJ,EAAM0C,aAChB1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKC,KACfoG,EAAKnJ,EAAM0C,YAAa,GACxB1C,EAAMsE,SACN,MAED,KAAKtE,EAAM8C,KAAKG,MACfkG,GAAOnJ,EAAM0C,YAAa,GAC1B1C,EAAMsE,UAoPRmI,CAAe/B,GAIhB,SAAS/D,EAAc+D,GAEtB,IAAuB,IAAlB1K,EAAMmB,QAAX,CAIA,OAFAuJ,EAAMiB,iBAEGjB,EAAMI,QAAQpB,QAEtB,KAAK,EAEJ,IAA4B,IAAvB1J,EAAMqC,aAAyB,QA3PvC,SAAiCqI,GAIhChD,EAAY1B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAyP5D2B,CAAwBjC,GAExBvL,EAAQoF,EAAMuW,aAEd,MAED,KAAK,EAEJ,IAA0B,IAArB9a,EAAMmC,aAA4C,IAApBnC,EAAMuC,UAAsB,QA7PlE,SAAmCmI,GAIlC,GAAK1K,EAAMmC,WAAa,CAEvB,IAAIyK,EAAKlC,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,MACnD8B,EAAKnC,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,MAEnDlC,EAAWjH,KAAKiL,KAAMF,EAAKA,EAAKC,EAAKA,GAEzCxE,EAAWrC,IAAK,EAAG8C,GAIpB,GAAK9I,EAAMuC,UAAY,CAEtB,IAAI2J,EAAI,IAAQxB,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,OAC1DM,EAAI,IAAQX,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,OAE9D9C,EAASlC,IAAKkG,EAAGb,IA2OhB2P,CAA0BtQ,GAE1BvL,EAAQoF,EAAMwW,gBAEd,MAED,QAEC5b,EAAQoF,EAAMC,KAIXrF,IAAUoF,EAAMC,MAEpBxE,EAAMoE,cAAe6C,IAMvB,SAASJ,EAAa6D,GAErB,IAAuB,IAAlB1K,EAAMmB,QAKX,OAHAuJ,EAAMiB,iBACNjB,EAAM4B,kBAEG5B,EAAMI,QAAQpB,QAEtB,KAAK,EAEJ,IAA4B,IAAvB1J,EAAMqC,aAAyB,OACpC,GAAKlD,IAAUoF,EAAMuW,aAAe,QArQvC,SAAgCpQ,GAI/B9C,EAAU5B,IAAK0E,EAAMI,QAAS,GAAIC,MAAOL,EAAMI,QAAS,GAAIE,OAE5DlD,EAAYmD,WAAYrD,EAAWF,GAAc3B,eAAgB/F,EAAMsC,aAEvE,IAAIgH,EAAUtJ,EAAMiB,aAAeC,SAAWlB,EAAMiB,WAAWsI,KAAOvJ,EAAMiB,WAE5EmE,EAAY,EAAIvD,KAAKC,GAAKgG,EAAYoE,EAAI5C,EAAQO,cAElDlB,EAAU,EAAI9G,KAAKC,GAAKgG,EAAYuD,EAAI/B,EAAQO,cAEhDnC,EAAYzD,KAAM2D,GAElB5H,EAAMsE,SAuPJuG,CAAuBH,GAEvB,MAED,KAAK,EAEJ,IAA0B,IAArB1K,EAAMmC,aAA4C,IAApBnC,EAAMuC,UAAsB,OAC/D,GAAKpD,IAAUoF,EAAMwW,gBAAkB,QA1P1C,SAAkCrQ,GAIjC,GAAK1K,EAAMmC,WAAa,CAEvB,IAAIyK,EAAKlC,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,MACnD8B,EAAKnC,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,MAEnDlC,EAAWjH,KAAKiL,KAAMF,EAAKA,EAAKC,EAAKA,GAEzCvE,EAAStC,IAAK,EAAG8C,GAEjBP,EAAWvC,IAAK,EAAGnE,KAAK4G,IAAKH,EAAS+C,EAAIhD,EAAWgD,EAAGrL,EAAMoC,YAE9DkI,EAAS/B,EAAW8C,GAEpBhD,EAAWpE,KAAMqE,GAIlB,GAAKtI,EAAMuC,UAAY,CAEtB,IAAI2J,EAAI,IAAQxB,EAAMI,QAAS,GAAIC,MAAQL,EAAMI,QAAS,GAAIC,OAC1DM,EAAI,IAAQX,EAAMI,QAAS,GAAIE,MAAQN,EAAMI,QAAS,GAAIE,OAE9D7C,EAAOnC,IAAKkG,EAAGb,GAEfjD,EAAS6C,WAAY9C,EAAQD,GAAWnC,eAAgB/F,EAAMwC,UAE9D2G,EAAKf,EAAS8D,EAAG9D,EAASiD,GAE1BnD,EAASjE,KAAMkE,GAIhBnI,EAAMsE,SAwNJ2W,CAAyBvQ,GAEzB,MAED,QAECvL,EAAQoF,EAAMC,MAMjB,SAASoC,EAAY8D,IAEG,IAAlB1K,EAAMmB,UAIXnB,EAAMoE,cAAe8C,GAErB/H,EAAQoF,EAAMC,MAIf,SAASgC,EAAekE,IAEA,IAAlB1K,EAAMmB,SAEXuJ,EAAMiB,iBAMP3L,EAAMiB,WAAWgL,iBAAkB,cAAezF,GAAe,GAEjExG,EAAMiB,WAAWgL,iBAAkB,YAAaxF,GAAa,GAC7DzG,EAAMiB,WAAWgL,iBAAkB,QAASvF,GAAc,GAE1D1G,EAAMiB,WAAWgL,iBAAkB,aAActF,GAAc,GAC/D3G,EAAMiB,WAAWgL,iBAAkB,WAAYrF,GAAY,GAC3D5G,EAAMiB,WAAWgL,iBAAkB,YAAapF,GAAa,GAE7DtH,OAAO0M,iBAAkB,UAAWjF,GAAW,GAI/CnL,KAAKyI,WAINuW,EAAc3N,UAAYvP,OAAOwP,OAAQ9L,IAAsB6L,YACvCE,YAAcyN,EAEtCld,OAAO0P,iBAAkBwN,EAAc3N,UAAW,CAEjDI,OAAQ,CAEPC,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,4DACPxO,KAAKuF,SAQdoM,OAAQ,CAEPD,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,+EACLxO,KAAKsG,YAIf6D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,8EACdxO,KAAKsG,YAAesL,IAMtBC,SAAU,CAETH,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,mFACLxO,KAAKwG,cAIf2D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,kFACdxO,KAAKwG,cAAiBoL,IAMxBE,MAAO,CAENJ,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,6EACLxO,KAAK0G,WAIfyD,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,4EACdxO,KAAK0G,WAAckL,IAMrBG,OAAQ,CAEPL,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,+EACLxO,KAAKgH,YAIfmD,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,8EACdxO,KAAKgH,YAAe4K,IAMtBI,aAAc,CAEbN,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,wFACLxO,KAAKoG,eAIf+D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,uFACdxO,KAAKoG,eAAkBwL,IAMzBK,qBAAsB,CAErBP,IAAK,WAGJ,OADAjQ,QAAQ+M,KAAM,4FACPxO,KAAKqG,eAIb8D,IAAK,SAAWyH,GAEfnQ,QAAQ+M,KAAM,4FACdxO,KAAKqG,cAAgBuL,MAQToN,QCl+BAK,EA5DM,WACjB,SAASC,EAAKC,EAASC,EAAKC,GACxB,IAAIC,EAAW,GACf,GAAGF,GAAQA,EAAK3R,OAAO,EACnB,IAAI,IAAIgN,KAAK2E,GAET,SAAU5a,GACN,IAAI+a,EAAU,IAAIC,QAAQ,SAASC,EAASC,GACxCL,GAAkBD,GAAQC,EAAe9a,UAAUC,GACnD,IAAImb,EAAS1a,SAASlF,cAAc,UACpC4f,EAAOC,IAAMpb,EAEbmb,EAAO3P,iBAAiB,OAAQ,WAC5BqP,GAAkBA,EAAe5a,QAAQD,GACzCnD,QAAQC,IAAI,WAAWkD,GACvBib,EAAQjb,KACT,GAEHmb,EAAO3P,iBAAiB,QAAS,WAC7B3O,QAAQC,IAAI,UAAUkD,GACtB6a,GAAkBA,EAAe5a,QAAQD,GACzCkb,EAAOlb,KACR,GAEHS,SAASqI,KAAKuS,YAAYF,KAG9BL,EAAS5E,KAAK6E,GArBlB,CAsBDJ,EAASC,EAAK3E,IAGrB,OAAO6E,EAGX1f,KAAKkgB,KAAO,SAASX,EAASC,EAAKC,GAE/B,IAAIE,EAAU,KAEd,GADAJ,EAAYA,GAAS,GAClBC,GAAQA,EAAK3R,OAAO,EACnB,IAAI,IAAIgN,KAAK2E,GACT,SAAUD,EAASY,GAEXR,EADDA,EACWA,EAAQS,KAAK,WAEnB,OADA3e,QAAQC,IAAI,UACLke,QAAQS,IAAIf,EAAKC,EAASY,EAAKV,MAGhCG,QAAQS,IAAIf,EAAKC,EAASY,EAAKV,IAPjD,CASGF,EAASC,EAAK3E,IAOzB,OAJApZ,QAAQC,IAAIie,GAILA,qBChDXW,EAAS,CAQbA,cAAuB,WAEtB,IAAIC,EAAYlb,SAASlF,cAAe,OACxCogB,EAAUC,MAAMC,QAAU,wCAE1B,IAAIC,EAAQrb,SAASlF,cAAe,OACpCugB,EAAMF,MAAMC,QAAU,6DACtBF,EAAUN,YAAaS,GAEvB,IAAIC,EAAStb,SAASlF,cAAe,OACrCwgB,EAAOH,MAAMC,QAAU,oGACvBE,EAAOC,UAAW,gBAClBF,EAAMT,YAAaU,GAInB,IAFA,IAAIE,EAAU,GAENhG,EAAI,EAAGA,EADF,GACcA,IAC1BgG,EAAQhG,GAAKxV,SAASlF,cAAe,OACrC0gB,EAAQhG,GAAG2F,MAAMC,QAAU,0HAC3BC,EAAMT,YAAaY,EAAQhG,IAC3BgG,EAAQhG,GAAG+F,UAAW,IAIvB,IAAIE,EAAWC,KAAKC,MACpB,MAAO,CACN5b,WAAYmb,EAEZ9X,OAAQ,SAASwY,GAKhB,GAHAxf,QAAQyf,OAAOD,aAAyBzb,OAGpCub,KAAKC,MAAQF,EAAW,IAAK,IAAjC,CACAA,EAAWC,KAAKC,MAEhB,IAAInG,EAAI,EACRgG,EAAQhG,KAAKsG,YAAc,kBAC3BN,EAAQhG,KAAKsG,YAAc,aAAeF,EAAcG,KAAKC,SAASxT,OACtEgT,EAAQhG,KAAKsG,YAAc,kBAC3BN,EAAQhG,KAAKsG,YAAc,eAAeF,EAAcG,KAAKE,OAAOC,WACpEV,EAAQhG,KAAKsG,YAAc,aAAeF,EAAcG,KAAKE,OAAOE,SAEpEX,EAAQhG,KAAKsG,YAAc,kBAC3BN,EAAQhG,KAAKsG,YAAc,UAAYF,EAAcG,KAAKK,OAAOC,MAEjEb,EAAQhG,KAAKsG,YAAc,UAAYF,EAAcG,KAAKK,OAAOE,UACjEd,EAAQhG,KAAKsG,YAAc,WAAaF,EAAcG,KAAKK,OAAOG,OAClEf,EAAQhG,KAAKsG,YAAc,UAAYF,EAAcG,KAAKK,OAAOI,MACjEhB,EAAQhG,KAAKsG,YAAc,UAAYF,EAAcG,KAAKK,OAAOK,WAKrDxB,ICAAyB,EAtED,CACVC,UAAW,SAAUC,GAEjB,IAEI,OAAOA,aAAeC,YAExB,MAAO5f,GAEL,MAAuB,kBAAR2f,GAAuC,IAAjBA,EAAIE,UAAyC,kBAAdF,EAAIzB,OAAqD,kBAAtByB,EAAIG,gBAMnHC,iBAAkB,SAAUJ,GAExB,GAAa,OAARA,EAAe,CAEhB,IAAM,IAAIpH,EAAI,EAAGA,EAAIoH,EAAIzhB,SAASqN,OAAQgN,IAEtC7a,KAAKqiB,iBAAiBJ,EAAIzhB,SAASqa,IAIlCoH,EAAItH,WAELsH,EAAItH,SAASlQ,UACbwX,EAAItH,cAAWnW,GAIdyd,EAAI7D,WAED6D,EAAI7D,SAASkE,MAEbL,EAAI7D,SAASkE,IAAI7X,UACjBwX,EAAI7D,SAASkE,SAAM9d,GAIvByd,EAAI7D,SAAS3T,UACbwX,EAAI7D,cAAW5Z,GAMvByd,OAAMzd,GAIV+d,qBAAsB,CAClBC,MAAO,SAAWpN,EAAOC,GAErB,OAAO,SAAWoN,EAAGzV,EAAGzH,GAEpB,IAAI8K,EAAIoS,EAAIrN,EAER+B,EAAInK,EAAIqI,EAEZ9P,EAAO4E,IAAKkG,EAHJ,EAGU8G,OCnD9BuL,EAAmB,SAAWC,EAAMlD,EAAgBmD,EAASC,GAEhE,IAAI9iB,EAAQC,KACRugB,EAAYoC,EAAKpC,UAEjBuC,EAAU,CACbC,aAAc,IACdC,eAAgB,KAChBC,QAAQ,EACRC,oBAAqB,GACrBC,QAAS,GACTC,QAAS,GACTC,UAAW,IAIP9C,EAEGwB,EAAMC,UAAWzB,GAavBvgB,KAAKugB,UAAYA,GAXjBvgB,KAAKugB,UAAYlb,SAASie,eAAgB/C,GACnB,MAAlBvgB,KAAKugB,YAETA,EAAYlb,SAASlF,cAAe,OACpCkF,SAASqI,KAAKuS,YAAaM,GAC3BvgB,KAAKugB,UAAYA,KAYbA,EAAYlb,SAASlF,cAAe,OACpCkF,SAASqI,KAAKuS,YAAaM,GAC3BvgB,KAAKugB,UAAYA,GAIxBvgB,KAAKujB,QAAU,CACdC,aAAc,EACdC,YAAa,IACbC,oBAAqB,IACrBtd,eAAe,EACfud,wBAAwB,EACxBC,WAAW,EACXC,yBAAyB,EACzBC,oBAAqB,EACrBC,sBAAuB,EACvBC,oBAAoB,EACpBC,qBAAqB,EACfC,cAAc,EACdC,kBAAmB,2BACnBC,iBAAkB,+BAGzB,IAAIC,EAAU,CACbC,UAAU,EACVhX,KAAK,EACLiX,aAAa,GA4Bd,SAASC,IAERhf,IAAYF,SAAU,EAEtBwd,EAAQ2B,UAAY,IAAIjf,IAA4B,EAAG,IAcxD,WAEC,IAAIkf,EAAQ,IAAIlf,IAChBkf,EAAM9N,KAAO,QACb8N,EAAMC,YAAa,IAAInf,KAAcof,OAAQ,SAC7CF,EAAM3L,IAAM,IAAIvT,IAAW,EAAG,GAAK,GAEnCzF,EAAM2kB,MAAQA,EAETL,EAAQE,cAAc7gB,OAAOghB,MAAQA,GArBpCG,GACHC,IAqDH/kB,EAAMoS,OAAS,IAAI3M,IAAyB,GAAIsd,EAAQiC,OAAO3P,MAAQ0N,EAAQiC,OAAO1P,OAAQ,GAAI,KAClGtV,EAAMoS,OAAOxK,SAASwC,IAAK,EAAG,EAAG,KAelC,WAEC,IAAI6a,EAAW,IAAI9f,EAAanF,EAAMoS,OAAQ2Q,EAAQmC,SAAS7f,YAC/D4f,EAAS5U,iBAAkB,SAAU8U,GACrCF,EAAS5e,eAAgB,EACzB4e,EAAS3e,cAAgB,IACzB2e,EAASpe,oBAAqB,EAE9Boe,EAAStf,YAAc,IACvBsf,EAASre,SAAW,IACpBmc,EAAQkC,SAAWA,EA7EnBG,GAiFD,WAEC,IAAIC,EAAe,IAAIC,IAAcvC,EAAQI,oBAAqBnjB,EAAMoS,OAAQ2Q,EAAQmC,SAAS7f,YAC3FggB,EAAa9f,SAAU,EACvB8f,EAAahV,iBAAkB,SAAU8U,GAC/CE,EAAahV,iBAAkB,UAAW,SAAWvB,GAEpDiU,EAAQwC,iBAAiBvP,OAAQlH,EAAM1J,QACvCogB,MAGDH,EAAahV,iBAAkB,WAAY,SAAWvB,GAErD2W,MA7FDC,GAsGA3C,EAAQwC,iBAAmB,IAAIpT,EAAmBnS,EAAMoS,OAAQ2Q,EAAQmC,SAAS7f,YACjF0d,EAAQwC,iBAAiBnH,OAAQ,EACjC2E,EAAQwC,iBAAiBhO,gBAAkB,GAE3CwL,EAAQwC,iBAAiBlV,iBAAkB,mBAAoB,SAAWvB,GAEhEiU,EAAQkC,SAAS1f,SAAYuJ,EAAM+C,QAI7CkR,EAAQwC,iBAAiBlV,iBAAkB,SAAU,SAAW9N,GAGtD4iB,MAGVpC,EAAQwC,iBAAiBlV,iBAAkB,YAAa,SAAW9N,GAElEijB,MAGDzC,EAAQwC,iBAAiBlV,iBAAkB,UAAW,SAAW9N,GAEhEkjB,MAGD1C,EAAQwC,iBAAiBlV,iBAAkB,eAAgB,SAAW9N,GAE5DojB,EAAqB5C,EAAQM,WAMxC,WAEC,IAAIuC,EAAU,IAAIngB,IAClBmgB,EAAQ/O,KAAO,UAEf,IAAIgP,EAAW,IAAIpgB,IAAoB,SAAU,GACjDogB,EAAShP,KAAO,eAChB+O,EAAQ7b,IAAK8b,GAEb,IAAIC,EAAW,IAAIrgB,IAAwB,SAAU,IACrDqgB,EAASjP,KAAO,WAChBiP,EAASle,SAASwC,IAAK,EAAG,EAAG,GAC7Bwb,EAAQ7b,IAAK+b,GAEb,IAAIC,EAAO,IAAItgB,IAAkB,IAAM,IAAK,SAAU,UACtDsgB,EAAKC,SAAW/f,KAAKC,GAAK,GAC1B6f,EAAKlP,KAAO,OACZ+O,EAAQ7b,IAAKgc,GAEbH,EAAQ7b,IAAKgZ,EAAQwC,kBAErBxC,EAAQ6C,QAAUA,GAEZ,IAAIngB,KAAsB0a,KAAKngB,EAAMwjB,QAAQY,kBAAmB,SAAS6B,GAC9EA,EAAQC,MAAQzgB,IAChBwgB,EAAQE,MAAQ1gB,IAChBwgB,EAAQG,OAAO9V,EAAI,GACnB2V,EAAQG,OAAO3W,EAAI,GACnBsT,EAAQsD,aAAeJ,KAIxB,IAAIxgB,KAAsB0a,KAAKngB,EAAMwjB,QAAQa,iBAAkB,SAAS4B,GACvEA,EAAQC,MAAQzgB,IAChBwgB,EAAQE,MAAQ1gB,IAChBwgB,EAAQG,OAAO9V,EAAI,GACnB2V,EAAQG,OAAO3W,EAAI,GACVsT,EAAQuD,YAAcL,IAGhCjmB,EAAM2kB,MAAM5a,IAAK6b,GACjB5lB,EAAMumB,YAAa,EACnBpB,IAhLAqB,GAkpBA7iB,OAAO0M,iBAAkB,SAAUoW,GAAiB,GAhpBpDC,IAiBD,SAAS3B,IAER,IAAIG,EAAW,IAAIzf,IAAqB,CACvCoe,UAAW7jB,EAAMwjB,QAAQK,UACzB8C,OAAO,IAGRzB,EAAS0B,cAAejjB,OAAOkjB,kBAE/B,IAAI7B,EAASE,EAAS7f,WACtB2f,EAAOvE,MAAM7Y,SAAW,WACxBod,EAAOvE,MAAMlS,IAAM,MACnByW,EAAOvE,MAAMqG,OAAS,EACtB9B,EAAO1P,OAAStV,EAAMwgB,UAAUvS,aAChC+W,EAAO3P,MAAQrV,EAAMwgB,UAAUlS,YAE/B4W,EAAS5M,QAAS0M,EAAO3P,MAAO2P,EAAO1P,QAEvCtV,EAAMwgB,UAAUN,YAAa8E,GAE7BjC,EAAQmC,SAAWA,EACnBnC,EAAQiC,OAASA,EAEZV,EAAQC,WA4rBbvkB,EAAM+mB,MAAQ,IAAIC,IAClBhnB,EAAM+mB,MAAME,IAAIxG,MAAM7Y,SAAW,WACjC5H,EAAM+mB,MAAME,IAAIxG,MAAMlS,IAAM,MAC5BvO,EAAM+mB,MAAME,IAAIxG,MAAMpS,KAAO,OAC7B/I,SAASqI,KAAKuS,YAAalgB,EAAM+mB,MAAME,KACvCjnB,EAAMknB,cAAgB,IAAI3G,EAAO4G,cACjCnnB,EAAMknB,cAAc7hB,WAAWob,MAAM7Y,SAAW,WAChD5H,EAAMknB,cAAc7hB,WAAWob,MAAMpS,KAAO,MAC5CrO,EAAMknB,cAAc7hB,WAAWob,MAAMlS,IAAM,MAC3CjJ,SAASqI,KAAKuS,YAAalgB,EAAMknB,cAAc7hB,aArZhD,SAAS+hB,EAAsB9D,EAAW+D,GAEzC,IAAM,IAAIvM,EAAI,EAAGA,EAAIuM,EAAoBvM,IAExCwM,EAAiBhE,EAAUxI,IAC3BiI,EAAQO,UAAUvI,KAAMgI,EAAQI,oBAAqBrI,GAAIlT,UAI1D,IAAIgT,EAAW,IAAInV,IACnBmV,EAASH,aAAc,WAAY,IAAIhV,IAAuB,IAAI8hB,aAAqC,EAAvBxE,EAAQC,cAAoB,IAC5G,IAAIwE,EAAQ,IAAI/hB,IAAwBsd,EAAQO,WAWhD,IAAM,IAAImE,KAVVD,EAAME,UAAY,aAClBF,EAAMG,QAAU,EAChBH,EAAMI,QAAS,EACfJ,EAAMK,KAAO,IAAIpiB,IAAYmV,EAASlT,QAAS,IAAIjC,IAAyB,CAC3E8T,MAAO,SACPH,QAAS,IACTF,UAAW,KAEZ6J,EAAQM,QAAQyE,QAAUN,EAEXzE,EAAQM,QAAU,CAEhC,IAAI0E,EAAShF,EAAQM,QAASoE,GAC9B1E,EAAQiF,QAAQje,IAAKge,EAAOF,OAuE9B,SAASP,EAAiB1f,GAEzB,IAAIyW,EAAW,IAAI5Y,IAAyB,CAAE8T,MAAuB,SAAhBtT,KAAKgiB,WACtD7iB,EAAS,IAAIK,IAAYsd,EAAQ2B,UAAWrG,GAiBhD,OAhBKzW,EAEJxC,EAAOwC,SAASS,KAAMT,IAItBxC,EAAOwC,SAAS0I,EAAoB,IAAhBrK,KAAKgiB,SAAiB,GAC1C7iB,EAAOwC,SAAS6H,EAAoB,GAAhBxJ,KAAKgiB,SACzB7iB,EAAOwC,SAASwP,EAAI,GAGrBhS,EAAO8iB,YAAa,EACpB9iB,EAAO+iB,eAAgB,EACvBpF,EAAQiF,QAAQje,IAAK3E,GAErB2d,EAAQI,oBAAoBpI,KAAM3V,GAC3BA,EAIR,SAAS+a,EAAMiI,EAAef,GAE7B,KAAQe,EAActa,OAASiV,EAAQO,UAAUxV,QAEhD9N,EAAM6C,WAGP,KAAQulB,EAActa,OAASiV,EAAQO,UAAUxV,QAEhD9N,EAAM8C,cAGP,IAAM,IAAIgY,EAAI,EAAGA,EAAIiI,EAAQO,UAAUxV,OAAQgN,IAE9CiI,EAAQO,UAAWxI,GAAIzS,KAAM+f,EAAetN,IAG7C6K,EAAqB5C,EAAQM,SAE7BN,EAAQsE,mBAAqBA,EAI9B,SAAS1B,EAAqBtC,GAE7B,IAAIhM,EAAQ,IAAI5R,IAChB,IAAM,IAAIgiB,KAAKpE,EAAU,CAKxB,IAHA,IAAI0E,EAAS1E,EAASoE,GAElB7f,EADamgB,EAAOF,KACEjN,SAASyN,WAAWzgB,SACpCkT,EAAI,EAAGA,EAAIiI,EAAQC,aAAclI,IAAO,CAEjD,IAAIwN,EAAIxN,GAAMiI,EAAQC,aAAe,GACrC+E,EAAOQ,SAAUD,EAAGjR,GACpBzP,EAAS4gB,OAAQ1N,EAAGzD,EAAM/G,EAAG+G,EAAM5H,EAAG4H,EAAMD,GAG7CxP,EAAS6gB,aAAc,EAMxB,IAFA,IAAIC,EAAM3F,EAAQO,UAAUxV,OAElB6a,EAAI,EAAGA,EAAID,EAAKC,IAAK,CAE9B,IAAIC,EAAU7F,EAAQO,UAAUqF,GAC5BE,EAAW9F,EAAQO,WAAWqF,EAAED,EAAI,GAAGA,GAC3ChnB,QAAQC,IAAI,UAAYgnB,EAAI,MAAQC,EAAQ/Q,WAAWgR,KAMzD,SAASpD,IAERD,IAOAzC,EAAQG,OAAS4F,WAAY,WAE5B/F,EAAQwC,iBAAiBtP,OAAQ8M,EAAQwC,iBAAiBngB,SAElD,KAIV,SAASogB,IAEHzC,EAAQG,QAAS6F,aAAchG,EAAQG,QAsF7C,SAASwD,IAERsC,sBAAuBtC,GAElB1mB,EAAMumB,aAAgBxD,EAAQkG,WAAajpB,EAAMwjB,QAAQI,0BAE7Db,EAAQkC,SAASvc,SACZ4b,EAAQC,WACZvkB,EAAMknB,cAAcxe,OAAQqa,EAAQmC,UACpCllB,EAAM+mB,MAAMre,UAhDdqa,EAAQmC,SAASxD,OAAQ1hB,EAAM2kB,MAAO3kB,EAAMoS,SAwD7C,SAAS+S,IA/BDpC,EAAQkG,YAEdlG,EAAQkG,WAAY,GAgCrBF,aAAchG,EAAQiC,OAAOkE,uBAC7BnG,EAAQiC,OAAOkE,sBAAwBJ,WAAY,WAzBnD/F,EAAQkG,WAAY,GA6BX,KA8EV,SAASxC,IAER1D,EAAQiC,OAAO1P,OAAStV,EAAMwgB,UAAUvS,aACxC8U,EAAQiC,OAAO3P,MAAQrV,EAAMwgB,UAAUlS,YACvCyU,EAAQmC,SAAS5M,QAASyK,EAAQiC,OAAO3P,MAAO0N,EAAQiC,OAAO1P,QAC/DtV,EAAMoS,OAAO+W,OAASpG,EAAQiC,OAAO3P,MAAQ0N,EAAQiC,OAAO1P,OAC5DtV,EAAMoS,OAAO7J,yBAEb4c,IArwBDllB,KAAKmpB,eAAiB,YAMtB,WAEO,IAAIC,EAAe,IAAI/J,EACvB,OAAO,IAAIO,QAAQ,SAASC,EAASC,GAEjCsJ,EAAalJ,KAAMyC,EAAK0G,IAAKzG,GAAUxC,KAAK,WAExC3e,QAAQC,IAAI,sBACZme,MAEDyJ,MAAM,WAEL7nB,QAAQC,IAAI,cAhB1B6nB,GAASnJ,KAAMoE,IAuNhBxkB,KAAKyC,YAAc,SAAW+mB,GAE7B,IAAIzB,EAAU,IAAIviB,IACZuiB,EAAQnR,KAAO,UAEf,IAAI6S,EAAU,IAAIjkB,IASxB,OARAikB,EAAQ7S,KAAO,UAEf7W,EAAM2kB,MAAM5a,IAAKie,GACXhoB,EAAM2kB,MAAM5a,IAAK2f,GAEvB3G,EAAQiF,QAAUA,EAClBjF,EAAQ2G,QAAUA,EAETD,EAAMlpB,OAEd,IAAK,OAuCP,SAAqBkpB,GAEpB,IAAI3b,EAAS2b,EAAM3b,QAAU,IACzBuH,EAAQoU,EAAMpU,OAAS,IACjBgS,EAAqBoC,EAAMpC,oBAAsB,EAEjDxF,EAAS,CAAE,IAAIpc,IAAe,EAAG4P,EAAO,GACjD,IAAI5P,IAAeqI,EAAQuH,EAAO,GAClC,IAAI5P,IAAeqI,EAAQ,EAAG,GAC9B,IAAIrI,IAAe,EAAG,EAAG,IAG1B2hB,EAAsBvF,EAAQwF,GAE9BlH,EAAM0B,EAAQwF,GApDZsC,CAAYF,GACZ,MACD,IAAK,KA4EP,SAAwBA,GAEvB,IAAI3b,EAAS2b,EAAM3b,QAAU,IACzBuH,EAAQoU,EAAMpU,OAAS,IACvBuU,EAAiBH,EAAMG,gBAAkB,GACzCC,EAAiBJ,EAAMI,gBAAkB,GACzCC,EAAaL,EAAMK,YAAc,GACjCC,EAAaN,EAAMM,YAAc,GAEjC1C,EAAqBoC,EAAMpC,oBAAsB,EAE3CxF,EAAS,CAClB,IAAIpc,IAAe,EAAG4P,EAAQyU,EAAY,GAC1C,IAAIrkB,IAAe,EAAG4P,EAAO,GAC7B,IAAI5P,IAAeqI,EAAQuH,EAAO,GAClC,IAAI5P,IAAeqI,EAAQuH,EAAQ0U,EAAY,GAC/C,IAAItkB,IAAeqI,EAAS+b,EAAgBxU,EAAQ0U,EAAY,GAChE,IAAItkB,IAAeqI,EAAS+b,EAAgB,GAC5C,IAAIpkB,IAAeqI,EAAS+b,EAAiBD,EAAgB,GAC7D,IAAInkB,IAAeqI,EAAS+b,EAAiBD,EAAgBvU,EAAQyU,EAAY,IAGlF1C,EAAsBvF,EAAQwF,GAE9BlH,EAAM0B,EAAQwF,GAnGZ2C,CAAeP,GACf,MACD,IAAK,KAqGP,SAAwBA,GAEvB,IAAI3b,EAAS2b,EAAM3b,QAAU,IACzBuH,EAAQoU,EAAMpU,OAAS,IACvB4U,EAAYR,EAAMQ,WAAa,GAC/BH,EAAaL,EAAMK,YAAc,GACjCC,EAAaN,EAAMM,YAAc,GAEjC1C,EAAqBoC,EAAMpC,oBAAsB,EAE3CxF,EAAS,CAClB,IAAIpc,IAAe,EAAG4P,EAAO,GAC7B,IAAI5P,IAAeqkB,EAAYzU,EAAO,GACtC,IAAI5P,IAAeqkB,EAAYzU,EAAQ4U,EAAW,GAClD,IAAIxkB,IAAeqI,EAASic,EAAYA,EAAY,GACpD,IAAItkB,IAAeqI,EAASic,EAAY1U,EAAO,GAC/C,IAAI5P,IAAeqI,EAAQuH,EAAO,GAClC,IAAI5P,IAAeqI,EAAQ,EAAG,GAC9B,IAAIrI,IAAe,EAAG,EAAG,IAG1B2hB,EAAsBvF,EAAQwF,GAE9BlH,EAAM0B,EAAQwF,GA3HZ6C,CAAeT,GACf,MACD,IAAK,KAgDP,SAAwBA,GAEvB,IAAI3b,EAAS2b,EAAM3b,QAAU,IACzBuH,EAAQoU,EAAMpU,OAAS,IACvByU,EAAaL,EAAMK,YAAc,GACjCC,EAAaN,EAAMM,YAAc,GAC3B1C,EAAqBoC,EAAMpC,oBAAsB,EAEjDxF,EAAS,CAAE,IAAIpc,IAAe,EAAG4P,EAAO,GACjD,IAAI5P,IAAeqkB,EAAYzU,EAAO,GACtC,IAAI5P,IAAeqkB,EAAYC,EAAY,GAC3C,IAAItkB,IAAeqI,EAAQic,EAAY,GACvC,IAAItkB,IAAeqI,EAAQ,EAAG,GAC9B,IAAIrI,IAAe,EAAG,EAAG,IAG1B2hB,EAAsBvF,EAAQwF,GAE9BlH,EAAM0B,EAAQwF,GAjEZ8C,CAAeV,GACf,MACD,IAAK,KA0HP,SAA6BA,GAE5B,IAAIpC,EAAqBoC,EAAMpC,oBAAsB,EAE3CxF,EAAS,CAClB,IAAIpc,IAAe,GAAI,IAAK,GAC5B,IAAIA,IAAe,EAAG,IAAK,GAC3B,IAAIA,IAAe,EAAG,EAAG,IAG1B2hB,EAAsBvF,EAAQwF,GAE9BlH,EAAM0B,EAAQwF,GArIZ+C,CAAoBX,GACpB,MACD,QACC/nB,QAAQC,IAAK,+BAKfwjB,KAIDllB,KAAK0C,WAAa,WAEX,IAAIuf,EAAMliB,EAAM2kB,MAAM0F,gBAAiB,WAEjCnI,KA8Tb,SAASoI,EAAmBpI,GAE3B,GAAKA,EAEJ,GAAKA,EAAIqI,QAAUrI,EAAIsI,OAEjBtI,EAAI7D,WAER6D,EAAI7D,SAASkE,KAAOL,EAAI7D,SAASkE,IAAI7X,UACrCwX,EAAI7D,SAASoM,OAASvI,EAAI7D,SAASoM,MAAM/f,UACzCwX,EAAI7D,SAASqM,aAAexI,EAAI7D,SAASqM,YAAYhgB,UACrDwX,EAAI7D,SAASsM,UAAYzI,EAAI7D,SAASsM,SAASjgB,UAC/CwX,EAAI7D,SAASuM,SAAW1I,EAAI7D,SAASuM,QAAQlgB,UAC7CwX,EAAI7D,SAASwM,WAAa3I,EAAI7D,SAASwM,UAAUngB,UACjDwX,EAAI7D,SAASyM,aAAe5I,EAAI7D,SAASyM,YAAYpgB,UACrDwX,EAAI7D,SAAS0M,QAAU7I,EAAI7D,SAAS0M,OAAOrgB,UAC3CwX,EAAI7D,SAAS3T,WAGdwX,EAAItH,UAAYsH,EAAItH,SAASlQ,eAEvB,GAAKwX,EAAItgB,KAAKopB,QAEpB,IAAM,IAAIlQ,EAAI,EAAGA,EAAIoH,EAAIzhB,SAASqN,OAAQgN,IAEzCwP,EAAmBpI,EAAIzhB,SAAUqa,IArVpCwP,CAAmBpI,GACbA,EAAI9L,OAAO6U,OAAQ/I,GACnBa,EAAQI,oBAAoB+H,OAAQ,EAAGnI,EAAQI,oBAAoBrV,QACzEiV,EAAQO,UAAU4H,OAAQ,EAAGnI,EAAQO,UAAUxV,QACzCqX,MAkJPllB,KAAK2C,QAAU,SAAeuoB,GAS7B,IAPA,IAKIC,EAAM,GAEAtQ,EAAI,EAAGA,EAAIiI,EAAQO,UAAUxV,OAAQgN,IAE9CsQ,EAAIrQ,KAAM,IAAItV,IAAesd,EAAQO,UAAWxI,GAAIxK,EAAGyS,EAAQO,UAAWxI,GAAIrL,IAI/E,IAAIlP,EAAQ,IAAIkF,IAAa2lB,GAEzBxQ,EAAW,IAAInV,IAAuBlF,EAfpB,CACrB8qB,MAAO,GACEC,cAAc,IAcxB1Q,EAAS2Q,wBAET,IAAIC,EAAY,IAAI/lB,IAA2B,CAAE8T,MAAO,SAAUsF,WAAW,EAAO9F,KAAMtT,IAAgB8c,IAAKQ,EAAQsD,eACnHoF,EAAY,IAAIhmB,IAA2B,CAAE8T,MAAO,SAAUsF,WAAW,EAAO9F,KAAMtT,IAAgB8c,IAAKQ,EAAQuD,cAEnHuB,EAAO,IAAIpiB,IAAYmV,EAAU,CAAE4Q,EAAWC,IAClD5D,EAAK6D,eAAgB,EACrB7D,EAAKjgB,SAASS,KAAKuS,EAAS+Q,eAAeja,OAAOka,UAElD7I,EAAQ2G,QAAQ3f,IAAK8d,GAErB7nB,EAAM2kB,MAAMqB,SAAS/f,KAAKC,GAAG,GAC7B6c,EAAQ6C,QAAQyE,gBAAgB,QAAQhY,SAAU,EAClD0Q,EAAQkC,SAAS1f,SAAU,EAC3Bwd,EAAQkC,SAASva,UApWlB,WACC,IAAImhB,EAAgB,IAAI5M,EAAejf,EAAMoS,OAAQ2Q,EAAQmC,SAAS7f,YAAewmB,EAAcxb,iBAAkB,SAAU8U,GAC/H0G,EAAcxlB,eAAgB,EAC9BwlB,EAAcvlB,cAAgB,IAC9BulB,EAAcnmB,YAAc,EAC5BmmB,EAAclmB,YAAc,IAC5BkmB,EAAc7lB,cAAgBP,IAAWqmB,SAAS,IAC5CD,EAAc9lB,cAAgBN,IAAWqmB,SAAS,GACxD/I,EAAQ8I,cAAgBA,EA6VxBE,GAEM5G,KAIPllB,KAAK4C,SAAW,WAEfkgB,EAAQsE,qBACRtE,EAAQO,UAAUvI,KAAMuM,IAAkB1f,UACpC+d,EAAqB5C,EAAQM,SAE7B8B,KAIPllB,KAAK6C,YAAc,WAEbigB,EAAQsE,oBAAsB,IAKnCtE,EAAQsE,qBACRtE,EAAQO,UAAU0I,MAClBjJ,EAAQiF,QAAQiD,OAAQlI,EAAQI,oBAAoB6I,OAC9CrG,EAAqB5C,EAAQM,SAE7B8B,OA+TJ8G,EAAW,SAAWrJ,EAAMlD,EAAgBoD,GAgB/CH,EAAiBxgB,KAAMlC,KAAM2iB,EAAMlD,EAdrB,CACb,GAGA,IAU2DoD,KAI7DmJ,EAAS3a,UAAYvP,OAAOwP,OAAQoR,EAAiBrR,YAClCE,YAAcya,EAElBA,gBCt3BAC,EAJKC,YAAgB,CAChC1qB,SCHW,SAAU2qB,EAAcC,GASnC,OARAD,EAAe,CACX/rB,GAAI,EACJY,kBAAkB,EAClBL,mBAAmB,EACnBW,uBAAuB,EACvBF,iBAAiB,GAGbgrB,EAAOzqB,MACX,IAAK,mBACD,OAAOG,OAAAuqB,EAAA,EAAAvqB,CAAA,GACAqqB,EACAC,EAAOxqB,SAElB,QACI,OAAOuqB,MCNbG,EAAQC,YAAYN,GAE1BO,IAAS/K,OACLxhB,EAAAC,EAAAC,cAACssB,EAAA,EAAD,CAAUH,MAAOA,GACbrsB,EAAAC,EAAAC,cAACusB,EAAD,OAEJrnB,SAASie,eAAe,SXwGtB,kBAAmBqJ,WACrBA,UAAUC,cAAcC,MAAMzM,KAAK,SAAA0M,GACjCA,EAAaC,eWrGnB,IAAMtN,EAAiB,IAAI3b,EAYrBtB,EAAS,IAAIwpB,EATN,CACTzL,UAHclb,SAASie,eAAe,UAItC+F,IAAK,IAOyB5J,EAJlB,WACZhe,QAAQC,IAAI,mBAIhBc,EAAO2mB,iBAEQ3mB","file":"static/js/main.55b2ecef.chunk.js","sourcesContent":["import React, { Component } from 'react';\n\nclass LayoutButtons extends Component {\n    render() {\n        return (\n            <button id={this.props.id} shape={ this.props.shape } onClick={ () => this.props.onClick('ADD_LAYOUT', {shape: this.props.shape})} >{this.props.children}</button>\n        );\n    }\n\n}\n\nexport default LayoutButtons;","import React, { Component } from 'react';\nimport LayoutButtons from './LayoutButtons';\n\nclass FloorPlanner extends Component {\n    render() {\n        const isVisible = this.props.showLayoutButtons;\n        let buttons;\n        if (isVisible) {\n            buttons = (\n                <div id=\"floor-planner\">\n                    <LayoutButtons id=\"box-layout\" shape=\"Box\" onClick={ this.props.onClick }>B</LayoutButtons>\n                    <LayoutButtons id=\"t-layout\" shape=\"T\" onClick={ this.props.onClick }>T</LayoutButtons>\n                    <LayoutButtons id=\"l-layout\" shape=\"L\" onClick={ this.props.onClick }>L</LayoutButtons>\n                    <LayoutButtons id=\"u-layout\" shape=\"U\" onClick={ this.props.onClick }>U</LayoutButtons>\n                    <LayoutButtons id=\"c-layout\" shape=\"C\" onClick={ this.props.onClick }>C</LayoutButtons>\n                </div>\n            )\n        } else {\n            buttons = <div/>\n        }\n        return  buttons;\n    }\n}\n\nexport default FloorPlanner;","import React, { Component } from 'react';\n\nclass PointButton extends Component {\n    render() {\n        let message = this.props.id === 'add' ? 'ADD_POINT' : 'REMOVE_POINT';\n        return (\n            <button id={this.props.id}  onClick={ () => this.props.onClick(message) } >{this.props.children}</button>\n        );\n    }\n}\n\nexport default PointButton;","import React, { Component } from 'react';\nimport PointButton from './PointButton';\n\nclass PointsButtons extends Component {\n\n    render() {\n        const isVisible = this.props.showPointButtons;\n        let buttons;\n        if (isVisible) {\n            buttons = (\n                <div className=\"points\">\n                    <PointButton id=\"add\" onClick={this.props.onClick}>+</PointButton>\n                    <PointButton id=\"remove\" onClick={this.props.onClick}>-</PointButton>\n                </div>\n            )\n        } else {\n            buttons = <div/>\n        }\n        return  buttons;\n        \n    }\n}\n\nexport default PointsButtons;","import React, { Component } from 'react';\n\nclass ClearFloor extends Component {\n\n    render() {\n        const isVisible = this.props.showClearButton;\n        let buttons;\n        if (isVisible) {\n            buttons = <button id={this.props.id} onClick={() => this.props.onClick('CLEAR_LAYOUT')}>{this.props.children}</button>\n        } else {\n            buttons = <div/>\n        }\n        return  buttons;\n    }\n}\n\nexport default ClearFloor;","import React, { Component } from 'react';\n\nclass CreateFloor extends Component {\n\n    render() {\n        const isVisible = this.props.showCreateFloorButton;\n        let buttons;\n        if (isVisible) {\n            buttons = <button id={this.props.id} onClick={ () => this.props.onClick('CREATE_FLOOR') }>{this.props.children}</button>\n        } else {\n            buttons = <div/>\n        }\n        return  buttons;\n    }\n}\n\nexport default CreateFloor;","export const updateEditorUI = (editorUI) => {\n    console.log(\"Update UI requested !!\");\n    return {\n        type: \"UPDATE_EDITOR_UI\",\n        payload: editorUI\n    };\n}","import React, { Component, Fragment } from 'react';\nimport FloorPlanner from './components/FloorPlanner';\nimport PointsButtons from './components/PointsButtons';\nimport ClearFloor from './components/ClearFloor';\nimport CreateFloor from './components/CreateFloor';\nimport editor from './index';\nimport './css/main.css';\nimport { bindActionCreators } from \"redux\";\nimport { connect } from 'react-redux';\nimport { updateEditorUI } from './actions';\n\nclass App extends Component {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t}\n\n\thandleClick(e, context) {\n\t\tswitch (e) {\n\t\t\tcase 'ADD_LAYOUT':\n\t\t\t\tthis.props.updateEditorUI({\n\t\t\t\t\tshowClearButton: true,\n\t\t\t\t\tshowCreateFloorButton: true,\n\t\t\t\t\tshowPointButtons: context.shape === 'C' ? true : false,\n\t\t\t\t\tshowLayoutButtons: false\n\t\t\t\t});\n\t\t\t\teditor.createFloor({ shape: context.shape });\n\t\t\t\tbreak;\n\t\t\tcase \"CLEAR_LAYOUT\":\n\t\t\t\teditor.clearFloor();\n\t\t\t\tthis.props.updateEditorUI({\n\t\t\t\t\tshowClearButton: true,\n\t\t\t\t\tshowCreateFloorButton: false,\n\t\t\t\t\tshowPointButtons: false,\n\t\t\t\t\tshowLayoutButtons: true\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'CREATE_FLOOR':\n\t\t\t\teditor.extrude();\n\t\t\t\teditor.clearFloor();\n\t\t\t\tthis.props.updateEditorUI({\n\t\t\t\t\tshowClearButton: false,\n\t\t\t\t\tshowCreateFloorButton: false,\n\t\t\t\t\tshowPointButtons: false,\n\t\t\t\t\tshowLayoutButtons: false\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'ADD_POINT':\n\t\t\t\teditor.addPoint();\n\t\t\t\tbreak;\n\t\t\tcase 'REMOVE_POINT':\n\t\t\t\teditor.removePoint();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"Unknown Event Triggered\");\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tcreateEditorUI() {\n\t\treturn (<Fragment key={this.props.editorUI.id}>\n\t\t\t<FloorPlanner showLayoutButtons={this.props.editorUI.showLayoutButtons} onClick={this.handleClick} />\n\t\t\t<PointsButtons showPointButtons={this.props.editorUI.showPointButtons} onClick={this.handleClick} />\n\t\t\t<CreateFloor showCreateFloorButton={this.props.editorUI.showCreateFloorButton} id=\"create-floor\" onClick={this.handleClick}>Create Floor</CreateFloor>\n\t\t\t<ClearFloor showClearButton={this.props.editorUI.showClearButton} id=\"clear\" onClick={this.handleClick}>X</ClearFloor>\n\t\t</Fragment>)\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<div id=\"editor\"></div>\n\t\t\t\t{this.createEditorUI()}\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n}\n\nfunction mapStateToProps(state) {\n\treturn {\n\t\teditorUI: state.editorUI\n\t};\n}\n\nfunction matchDispatchToProps(dispatch) {\n\treturn bindActionCreators({ updateEditorUI: updateEditorUI }, dispatch)\n}\n\n\nexport default connect(mapStateToProps, matchDispatchToProps)(App);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n\n              // Execute callback\n              if (config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","const LoadingManager = function ( onLoad, onProgress, onError ) {\r\n    \r\n    var scope = this;\r\n\r\n    var isLoading = false;\r\n    var itemsLoaded = 0;\r\n    var itemsTotal = 0;\r\n    var urlModifier;\r\n\r\n    this.onStart = undefined;\r\n    this.onLoad = onLoad;\r\n    this.onProgress = onProgress;\r\n    this.onError = onError;\r\n    this.itemsStart = function ( numberOfItems ) {\r\n        \r\n                itemsTotal += numberOfItems;\r\n                isLoading = true;\r\n        \r\n    };\r\n\r\n    this.itemStart = function ( url ) {\r\n\r\n        itemsTotal ++;\r\n\r\n        if ( isLoading === false ) {\r\n\r\n            if ( scope.onStart !== undefined ) {\r\n\r\n                scope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        isLoading = true;\r\n\r\n    };\r\n\r\n    this.itemEnd = function ( url ) {\r\n\r\n        itemsLoaded ++;\r\n\r\n        if ( scope.onProgress !== undefined ) {\r\n\r\n            scope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n        }\r\n\r\n        if ( itemsLoaded === itemsTotal ) {\r\n\r\n            isLoading = false;\r\n\r\n            if ( scope.onLoad !== undefined ) {\r\n\r\n                scope.onLoad();\r\n\r\n            }\r\n\r\n        }\r\n\r\n    };\r\n\r\n    this.itemError = function ( url ) {\r\n\r\n        if ( scope.onError !== undefined ) {\r\n\r\n            scope.onError( url );\r\n\r\n        }\r\n\r\n    };\r\n\r\n    this.resolveURL = function ( url ) {\r\n\r\n        if ( urlModifier ) {\r\n\r\n            return urlModifier( url );\r\n\r\n        }\r\n\r\n        return url;\r\n\r\n    };\r\n\r\n    this.setURLModifier = function ( transform ) {\r\n\r\n        urlModifier = transform;\r\n        return this;\r\n\r\n    };   \r\n}\r\n\r\nexport default LoadingManager;","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author moroine / https://github.com/moroine\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/metaKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nimport * as THREE from 'three'\n\nconst MapControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new THREE.Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.25;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: THREE.MOUSE.LEFT, MIDDLE: THREE.MOUSE.MIDDLE, RIGHT: THREE.MOUSE.RIGHT };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new THREE.Vector3();\n\t\tvar lastQuaternion = new THREE.Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\t\t\tscope.target.add( panOffset );\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: 0,\n\t\tROTATE_UP: 1,\n\t\tROTATE_LEFT: 2,\n\t\tROTATE: 3, // ROTATE_UP | ROTATE_LEFT\n\t\tDOLLY: 4,\n\t\tDOLLY_ROTATE: 7, // ROTATE | DOLLY\n\t\tPAN: 8,\n\t\tDOLLY_PAN: 12, // DOLLY | PAN\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new THREE.Spherical();\n\tvar sphericalDelta = new THREE.Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new THREE.Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateStart2 = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateEnd2 = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\tvar rotateDelta2 = new THREE.Vector2();\n\tvar rotateDeltaStartFingers = new THREE.Vector2();\n\tvar rotateDeltaEndFingers = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\t//console.log( 'handleMouseDownRotate' );\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\t//console.log( 'handleMouseDownDolly' );\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\t//console.log( 'handleMouseDownPan' );\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\t//console.log( 'handleMouseMoveRotate' );\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\t//console.log( 'handleMouseMoveDolly' );\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\t//console.log( 'handleMouseMovePan' );\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( event ) {\n\n\t\t// console.log( 'handleMouseUp' );\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\t// console.log( 'handleMouseWheel' );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\t//console.log( 'handleKeyDown' );\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\t// console.log( 'handleTouchStartRotate' );\n\n\t\t// First finger\n\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t// Second finger\n\t\trotateStart2.set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY );\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tif ( scope.enableZoom ) {\n\n\t\t\t// console.log( 'handleTouchStartDolly' );\n\n\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( scope.enablePan ) {\n\n\t\t\t// console.log( 'handleTouchStartPan' );\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( scope.enableRotate === false ) return;\n\t\tif ( ( state & STATE.ROTATE ) === 0 ) return;\n\n\t\t// First finger\n\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t// Second finger\n\t\trotateEnd2.set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\t\trotateDelta2.subVectors( rotateEnd2, rotateStart2 );\n\t\trotateDeltaStartFingers.subVectors( rotateStart2, rotateStart );\n\t\trotateDeltaEndFingers.subVectors( rotateEnd2, rotateEnd );\n\n\t\tif ( isRotateUp() ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\t// Start rotateUp ==> disable all movement to prevent flickering\n\t\t\tstate = STATE.ROTATE_UP;\n\n\t\t} else if ( ( state & STATE.ROTATE_LEFT ) !== 0 ) {\n\n\t\t\trotateLeft( ( rotateDeltaStartFingers.angle() - rotateDeltaEndFingers.angle() ) * scope.rotateSpeed );\n\n\t\t}\n\n\t\trotateStart.copy( rotateEnd );\n\t\trotateStart2.copy( rotateEnd2 );\n\n\t}\n\n\tfunction isRotateUp() {\n\n\t\t// At start, does the two fingers are aligned horizontally\n\t\tif ( ! isHorizontal( rotateDeltaStartFingers ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// At end, does the two fingers are aligned horizontally\n\t\tif ( ! isHorizontal( rotateDeltaEndFingers ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// does the first finger moved vertically between start and end\n\t\tif ( ! isVertical( rotateDelta ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// does the second finger moved vertically between start and end\n\t\tif ( ! isVertical( rotateDelta2 ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// Does the two finger moved in the same direction (prevent moving one finger vertically up while the other goes down)\n\t\treturn rotateDelta.dot( rotateDelta2 ) > 0;\n\n\t}\n\n\tvar isHorizontal = function () {\n\n\t\tvar precision = Math.sin( Math.PI / 6 );\n\n\t\treturn function isHorizontal( vector ) {\n\n\t\t\treturn Math.abs( Math.sin( vector.angle() ) ) < precision;\n\n\t\t};\n\n\t}();\n\n\tvar isVertical = function () {\n\n\t\tvar precision = Math.cos( Math.PI / 2 - Math.PI / 6 );\n\n\t\treturn function isVertical( vector ) {\n\n\t\t\treturn Math.abs( Math.cos( vector.angle() ) ) < precision;\n\n\t\t};\n\n\t}();\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tif ( scope.enableZoom === false ) return;\n\t\tif ( ( state & STATE.DOLLY ) === 0 ) return;\n\n\t\t// console.log( 'handleTouchMoveDolly' );\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyIn( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( scope.enablePan === false ) return;\n\t\tif ( ( state & STATE.PAN ) === 0 ) return;\n\n\t\t// console.log( 'handleTouchMovePan' );\n\n\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchEnd( event ) {\n\n\t\t//console.log( 'handleTouchEnd' );\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase scope.mouseButtons.LEFT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey ) {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.MIDDLE:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.RIGHT:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak; \n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: rotate-dolly\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchStartRotate( event );\n\t\t\t\thandleTouchStartDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY_ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\t\t\t\tif ( state !== STATE.PAN ) return; // is this needed?\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: rotate-dolly\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\t\t\t\tif ( ( state & STATE.DOLLY_ROTATE ) === 0 ) return; // is this needed?\n\n\t\t\t\thandleTouchMoveRotate( event );\n\t\t\t\thandleTouchMoveDolly( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nMapControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nObject.defineProperties( MapControls.prototype, {\n\n\tcenter: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .center has been renamed to .target' );\n\t\t\treturn this.target;\n\n\t\t}\n\n\t},\n\n\t// backward compatibility\n\n\tnoZoom: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\treturn ! this.enableZoom;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\tthis.enableZoom = ! value;\n\n\t\t}\n\n\t},\n\n\tnoRotate: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\treturn ! this.enableRotate;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\tthis.enableRotate = ! value;\n\n\t\t}\n\n\t},\n\n\tnoPan: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\treturn ! this.enablePan;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\tthis.enablePan = ! value;\n\n\t\t}\n\n\t},\n\n\tnoKeys: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\treturn ! this.enableKeys;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\tthis.enableKeys = ! value;\n\n\t\t}\n\n\t},\n\n\tstaticMoving: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\treturn ! this.enableDamping;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\tthis.enableDamping = ! value;\n\n\t\t}\n\n\t},\n\n\tdynamicDampingFactor: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\treturn this.dampingFactor;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\tthis.dampingFactor = value;\n\n\t\t}\n\n\t}\n\n} );\nexport default MapControls","/**\n * @author arodic / https://github.com/arodic\n */\n\nimport * as THREE from 'three';\n\nconst TransformControls = function ( camera, domElement ) {\n\n\tTHREE.Object3D.call( this );\n\n\tdomElement = ( domElement !== undefined ) ? domElement : document;\n\n\tthis.visible = false;\n\n\tvar _gizmo = new TransformControlsGizmo();\n\tthis.add( _gizmo );\n\n\tvar _plane = new TransformControlsPlane();\n\tthis.add( _plane );\n\n\tvar scope = this;\n\n\t// Define properties with getters/setter\n\t// Setting the defined property will automatically trigger change event\n\t// Defined properties are passed down to gizmo and plane\n\n\tdefineProperty( \"camera\", camera );\n\tdefineProperty( \"object\", undefined );\n\tdefineProperty( \"enabled\", true );\n\tdefineProperty( \"axis\", null );\n\tdefineProperty( \"mode\", \"translate\" );\n\tdefineProperty( \"translationSnap\", null );\n\tdefineProperty( \"rotationSnap\", null );\n\tdefineProperty( \"space\", \"world\" );\n\tdefineProperty( \"size\", 1 );\n\tdefineProperty( \"dragging\", false );\n\tdefineProperty( \"showX\", true );\n\tdefineProperty( \"showY\", true );\n\tdefineProperty( \"showZ\", true );\n\n\tvar changeEvent = { type: \"change\" };\n\tvar mouseDownEvent = { type: \"mouseDown\" };\n\tvar mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n\tvar objectChangeEvent = { type: \"objectChange\" };\n\n\t// Reusable utility variables\n\n\tvar ray = new THREE.Raycaster();\n\n\tvar _tempVector = new THREE.Vector3();\n\tvar _tempVector2 = new THREE.Vector3();\n\tvar _tempQuaternion = new THREE.Quaternion();\n\tvar _unit = {\n\t\tX: new THREE.Vector3( 1, 0, 0 ),\n\t\tY: new THREE.Vector3( 0, 1, 0 ),\n\t\tZ: new THREE.Vector3( 0, 0, 1 )\n\t};\n\tvar _identityQuaternion = new THREE.Quaternion();\n\tvar _alignVector = new THREE.Vector3();\n\n\tvar pointStart = new THREE.Vector3();\n\tvar pointEnd = new THREE.Vector3();\n\tvar rotationAxis = new THREE.Vector3();\n\tvar rotationAngle = 0;\n\n\tvar cameraPosition = new THREE.Vector3();\n\tvar cameraQuaternion = new THREE.Quaternion();\n\tvar cameraScale = new THREE.Vector3();\n\n\tvar parentPosition = new THREE.Vector3();\n\tvar parentQuaternion = new THREE.Quaternion();\n\tvar parentScale = new THREE.Vector3();\n\n\tvar worldPositionStart = new THREE.Vector3();\n\tvar worldQuaternionStart = new THREE.Quaternion();\n\tvar worldScaleStart = new THREE.Vector3();\n\n\tvar worldPosition = new THREE.Vector3();\n\tvar worldQuaternion = new THREE.Quaternion();\n\tvar worldScale = new THREE.Vector3();\n\n\tvar eye = new THREE.Vector3();\n\n\tvar _positionStart = new THREE.Vector3();\n\tvar _quaternionStart = new THREE.Quaternion();\n\tvar _scaleStart = new THREE.Vector3();\n\n\t// TODO: remove properties unused in plane and gizmo\n\n\tdefineProperty( \"parentQuaternion\", parentQuaternion );\n\tdefineProperty( \"worldPosition\", worldPosition );\n\tdefineProperty( \"worldPositionStart\", worldPositionStart );\n\tdefineProperty( \"worldQuaternion\", worldQuaternion );\n\tdefineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n\tdefineProperty( \"cameraPosition\", cameraPosition );\n\tdefineProperty( \"cameraQuaternion\", cameraQuaternion );\n\tdefineProperty( \"pointStart\", pointStart );\n\tdefineProperty( \"pointEnd\", pointEnd );\n\tdefineProperty( \"rotationAxis\", rotationAxis );\n\tdefineProperty( \"rotationAngle\", rotationAngle );\n\tdefineProperty( \"eye\", eye );\n\n\t{\n\n\t\tdomElement.addEventListener( \"mousedown\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"touchstart\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"mousemove\", onPointerHover, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerHover, false );\n\t\tdocument.addEventListener( \"mousemove\", onPointerMove, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerMove, false );\n\t\tdocument.addEventListener( \"mouseup\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchend\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchcancel\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchleave\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"contextmenu\", onContext, false );\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tdomElement.removeEventListener( \"mousedown\", onPointerDown );\n\t\tdomElement.removeEventListener( \"touchstart\", onPointerDown );\n\t\tdomElement.removeEventListener( \"mousemove\", onPointerHover );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerHover );\n\t\tdocument.removeEventListener( \"mousemove\", onPointerMove );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerMove );\n\t\tdocument.removeEventListener( \"mouseup\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchend\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchcancel\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchleave\", onPointerUp );\n\t\tdomElement.removeEventListener( \"contextmenu\", onContext );\n\n\t};\n\n\t// Set current object\n\tthis.attach = function ( object ) {\n\n\t\tthis.object = object;\n\t\tthis.visible = true;\n\n\t};\n\n\t// Detatch from object\n\tthis.detach = function () {\n\n\t\tthis.object = undefined;\n\t\tthis.visible = false;\n\t\tthis.axis = null;\n\n\t};\n\n\t// Defined getter, setter and store for a property\n\tfunction defineProperty( propName, defaultValue ) {\n\n\t\tvar propValue = defaultValue;\n\n\t\tObject.defineProperty( scope, propName, {\n\n\t\t\tget: function() {\n\n\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\n\n\t\t\t},\n\n\t\t\tset: function( value ) {\n\n\t\t\t\tif ( propValue !== value ) {\n\n\t\t\t\t\tpropValue = value;\n\t\t\t\t\t_plane[ propName ] = value;\n\t\t\t\t\t_gizmo[ propName ] = value;\n\n\t\t\t\t\tscope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n\t\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t});\n\n\t\tscope[ propName ] = defaultValue;\n\t\t_plane[ propName ] = defaultValue;\n\t\t_gizmo[ propName ] = defaultValue;\n\n\t}\n\n\t// updateMatrixWorld  updates key transformation variables\n\tthis.updateMatrixWorld = function () {\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\tthis.object.updateMatrixWorld();\n\t\t\tthis.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n\t\t\tthis.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n\t\t}\n\n\t\tthis.camera.updateMatrixWorld();\n\t\tthis.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n\t\tif ( this.camera instanceof THREE.PerspectiveCamera ) {\n\n\t\t\teye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n\t\t} else if ( this.camera instanceof THREE.OrthographicCamera ) {\n\n\t\t\teye.copy( cameraPosition ).normalize();\n\n\t\t}\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n\tthis.pointerHover = function( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\tray.setFromCamera( pointer, this.camera );\n\n\t\tvar intersect = ray.intersectObjects( _gizmo.picker[ this.mode ].children, true )[ 0 ] || false;\n\n\t\tif ( intersect ) {\n\n\t\t\tthis.axis = intersect.object.name;\n\n\t\t} else {\n\n\t\t\tthis.axis = null;\n\n\t\t}\n\n\t};\n\n\tthis.pointerDown = function( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\tif ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n\t\t\tray.setFromCamera( pointer, this.camera );\n\n\t\t\tvar planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n\t\t\tif ( planeIntersect ) {\n\n\t\t\t\tvar space = this.space;\n\n\t\t\t\tif ( this.mode === 'scale') {\n\n\t\t\t\t\tspace = 'local';\n\n\t\t\t\t} else if ( this.axis === 'E' ||  this.axis === 'XYZE' ||  this.axis === 'XYZ' ) {\n\n\t\t\t\t\tspace = 'world';\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\n\n\t\t\t\t\tvar snap = this.rotationSnap;\n\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n\t\t\t\t}\n\n\t\t\t\tthis.object.updateMatrixWorld();\n\t\t\t\tthis.object.parent.updateMatrixWorld();\n\n\t\t\t\t_positionStart.copy( this.object.position );\n\t\t\t\t_quaternionStart.copy( this.object.quaternion );\n\t\t\t\t_scaleStart.copy( this.object.scale );\n\n\t\t\t\tthis.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n\t\t\t\tpointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\t\t\tif ( space === 'local' ) pointStart.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n\t\t\t}\n\n\t\t\tthis.dragging = true;\n\t\t\tmouseDownEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseDownEvent );\n\n\t\t}\n\n\t};\n\n\tthis.pointerMove = function( pointer ) {\n\n\t\tvar axis = this.axis;\n\t\tvar mode = this.mode;\n\t\tvar object = this.object;\n\t\tvar space = this.space;\n\n\t\tif ( mode === 'scale') {\n\n\t\t\tspace = 'local';\n\n\t\t} else if ( axis === 'E' ||  axis === 'XYZE' ||  axis === 'XYZ' ) {\n\n\t\t\tspace = 'world';\n\n\t\t}\n\n\t\tif ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\tray.setFromCamera( pointer, this.camera );\n\n\t\tvar planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n\t\tif ( planeIntersect === false ) return;\n\n\t\tpointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\tif ( space === 'local' ) pointEnd.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n\t\tif ( mode === 'translate' ) {\n\n\t\t\tif ( axis.search( 'X' ) === -1 ) {\n\t\t\t\tpointEnd.x = pointStart.x;\n\t\t\t}\n\t\t\tif ( axis.search( 'Y' ) === -1 ) {\n\t\t\t\tpointEnd.y = pointStart.y;\n\t\t\t}\n\t\t\tif ( axis.search( 'Z' ) === -1 ) {\n\t\t\t\tpointEnd.z = pointStart.z;\n\t\t\t}\n\n\t\t\t// Apply translate\n\n\t\t\tif ( space === 'local' ) {\n\t\t\t\tobject.position.copy( pointEnd ).sub( pointStart ).applyQuaternion( _quaternionStart );\n\t\t\t} else {\n\t\t\t\tobject.position.copy( pointEnd ).sub( pointStart );\n\t\t\t}\n\n\t\t\tobject.position.add( _positionStart );\n\n\t\t\t// Apply translation snap\n\n\t\t\tif ( this.translationSnap ) {\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\tobject.position.applyQuaternion(_tempQuaternion.copy( _quaternionStart ).inverse() );\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.position.applyQuaternion( _quaternionStart );\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'world' ) {\n\n\t\t\t\t\tif ( object.parent ) {\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== -1 ) {\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( object.parent ) {\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'scale' ) {\n\n\t\t\tif ( axis.search( 'XYZ' ) !== -1 ) {\n\n\t\t\t\tvar d = pointEnd.length() / pointStart.length();\n\n\t\t\t\tif ( pointEnd.dot( pointStart ) < 0 ) d *= -1;\n\n\t\t\t\t_tempVector.set( d, d, d );\n\n\t\t\t} else {\n\n\t\t\t\t_tempVector.copy( pointEnd ).divide( pointStart );\n\n\t\t\t\tif ( axis.search( 'X' ) === -1 ) {\n\t\t\t\t\t_tempVector.x = 1;\n\t\t\t\t}\n\t\t\t\tif ( axis.search( 'Y' ) === -1 ) {\n\t\t\t\t\t_tempVector.y = 1;\n\t\t\t\t}\n\t\t\t\tif ( axis.search( 'Z' ) === -1 ) {\n\t\t\t\t\t_tempVector.z = 1;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply scale\n\n\t\t\tobject.scale.copy( _scaleStart ).multiply( _tempVector );\n\n\t\t} else if ( mode === 'rotate' ) {\n\n\t\t\tvar ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n\t\t\tvar quaternion = this.space === \"local\" ? worldQuaternion : _identityQuaternion;\n\n\t\t\tvar unit = _unit[ axis ];\n\n\t\t\tif ( axis === 'E' ) {\n\n\t\t\t\t_tempVector.copy( pointEnd ).cross( pointStart );\n\t\t\t\trotationAxis.copy( eye );\n\t\t\t\trotationAngle = pointEnd.angleTo( pointStart ) * ( _tempVector.dot( eye ) < 0 ? 1 : -1 );\n\n\t\t\t} else if ( axis === 'XYZE' ) {\n\n\t\t\t\t_tempVector.copy( pointEnd ).sub( pointStart ).cross( eye ).normalize();\n\t\t\t\trotationAxis.copy( _tempVector );\n\t\t\t\trotationAngle = pointEnd.sub( pointStart ).dot( _tempVector.cross( eye ) ) * ROTATION_SPEED;\n\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n\t\t\t\t_alignVector.copy( unit ).applyQuaternion( quaternion );\n\n\t\t\t\trotationAxis.copy( unit );\n\n\t\t\t\t_tempVector = unit.clone();\n\t\t\t\t_tempVector2 = pointEnd.clone().sub( pointStart );\n\t\t\t\tif ( space === 'local' ) {\n\t\t\t\t\t_tempVector.applyQuaternion( quaternion );\n\t\t\t\t\t_tempVector2.applyQuaternion( worldQuaternionStart );\n\t\t\t\t}\n\t\t\t\trotationAngle = _tempVector2.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n\t\t\t}\n\n\t\t\t// Apply rotation snap\n\n\t\t\tif ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n\t\t\tthis.rotationAngle = rotationAngle;\n\n\t\t\t// Apply rotate\n\n\t\t\tif ( space === 'local' ) {\n\n\t\t\t\tobject.quaternion.copy( _quaternionStart );\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\n\t\t\t} else {\n\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\t\t\t\tobject.quaternion.multiply( _quaternionStart );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.dispatchEvent( changeEvent );\n\t\tthis.dispatchEvent( objectChangeEvent );\n\n\t};\n\n\tthis.pointerUp = function( pointer ) {\n\n\t\tif ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\n\n\t\t\tmouseUpEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseUpEvent );\n\n\t\t}\n\n\t\tthis.dragging = false;\n\n\t\tif ( pointer.button === undefined ) this.axis = null;\n\n\t};\n\n\t// normalize mouse / touch pointer and remap {x,y} to view space.\n\n\tfunction getPointer( event ) {\n\n\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n\t\tvar rect = domElement.getBoundingClientRect();\n\n\t\treturn {\n\t\t\tx: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n\t\t\ty: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n\t\t\tbutton: event.button\n\t\t}\n\n\t}\n\n\t// mouse / touch event handlers\n\n\tfunction onContext( event ) {\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tfunction onPointerHover( event ) {\n\n\t\tif ( !scope.enabled ) return;\n\n\t\tscope.pointerHover( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( !scope.enabled ) return;\n\n\t\tevent.preventDefault();\n\n\t\tscope.pointerHover( getPointer( event ) );\n\t\tscope.pointerDown( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( !scope.enabled ) return;\n\n\t\tevent.preventDefault();\n\n\t\tscope.pointerMove( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tif ( !scope.enabled ) return;\n\n\t\tevent.preventDefault(); // Prevent MouseEvent on mobile\n\n\t\tscope.pointerUp( getPointer( event ) );\n\n\t}\n\n\t// TODO: depricate\n\n\tthis.getMode = function () {\n\n\t\treturn scope.mode;\n\n\t};\n\n\tthis.setMode = function ( mode ) {\n\n\t\tscope.mode = mode;\n\n\t};\n\n\tthis.setTranslationSnap = function ( translationSnap ) {\n\n\t\tscope.translationSnap = translationSnap;\n\n\t};\n\n\tthis.setRotationSnap = function ( rotationSnap ) {\n\n\t\tscope.rotationSnap = rotationSnap;\n\n\t};\n\n\tthis.setSize = function ( size ) {\n\n\t\tscope.size = size;\n\n\t};\n\n\tthis.setSpace = function ( space ) {\n\n\t\tscope.space = space;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tconsole.warn( 'TransformControls: update function has been depricated.' );\n\n\t}\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n  constructor: TransformControls,\n\n  isTransformControls: true\n\n} );\n\n\nconst TransformControlsGizmo = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'TransformControlsGizmo';\n\n\t// shared materials\n\n\tvar gizmoMaterial = new THREE.MeshBasicMaterial({\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tside: THREE.DoubleSide,\n\t\tfog: false\n\t});\n\n\tvar gizmoLineMaterial = new THREE.LineBasicMaterial({\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tlinewidth: 1,\n\t\tfog: false\n\t});\n\n\t// Make unique material for each axis/color\n\n\tvar matInvisible = gizmoMaterial.clone();\n\tmatInvisible.opacity = 0.15;\n\n\tvar matHelper = gizmoMaterial.clone();\n\tmatHelper.opacity = 0.33;\n\n\tvar matRed = gizmoMaterial.clone();\n\tmatRed.color.set( 0xff0000 );\n\n\tvar matGreen = gizmoMaterial.clone();\n\tmatGreen.color.set( 0x00ff00 );\n\n\tvar matBlue = gizmoMaterial.clone();\n\tmatBlue.color.set( 0x0000ff );\n\n\tvar matWhiteTransperent = gizmoMaterial.clone();\n\tmatWhiteTransperent.opacity = 0.25;\n\n\tvar matYellowTransparent = matWhiteTransperent.clone();\n\tmatYellowTransparent.color.set( 0xffff00 );\n\n\tvar matCyanTransparent = matWhiteTransperent.clone();\n\tmatCyanTransparent.color.set( 0x00ffff );\n\n\tvar matMagentaTransparent = matWhiteTransperent.clone();\n\tmatMagentaTransparent.color.set( 0xff00ff );\n\n\tvar matYellow = gizmoMaterial.clone();\n\tmatYellow.color.set( 0xffff00 );\n\n\tvar matLineRed = gizmoLineMaterial.clone();\n\tmatLineRed.color.set( 0xff0000 );\n\n\tvar matLineGreen = gizmoLineMaterial.clone();\n\tmatLineGreen.color.set( 0x00ff00 );\n\n\tvar matLineBlue = gizmoLineMaterial.clone();\n\tmatLineBlue.color.set( 0x0000ff );\n\n\tvar matLineCyan = gizmoLineMaterial.clone();\n\tmatLineCyan.color.set( 0x00ffff );\n\n\tvar matLineMagenta = gizmoLineMaterial.clone();\n\tmatLineMagenta.color.set( 0xff00ff );\n\n\tvar matLineYellow = gizmoLineMaterial.clone();\n\tmatLineYellow.color.set( 0xffff00 );\n\n\tvar matLineGray = gizmoLineMaterial.clone();\n\tmatLineGray.color.set( 0x787878);\n\n\tvar matLineYellowTransparent = matLineYellow.clone();\n\tmatLineYellowTransparent.opacity = 0.25;\n\n\t// reusable geometry\n\n\tvar arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false);\n\n\tvar scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125);\n\n\tvar lineGeometry = new THREE.BufferGeometry( );\n\tlineGeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n\tvar CircleGeometry = function( radius, arc ) {\n\n\t\tvar geometry = new THREE.BufferGeometry( );\n\t\tvar vertices = [];\n\n\t\tfor ( var i = 0; i <= 64 * arc; ++i ) {\n\n\t\t\tvertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n\t\t}\n\n\t\tgeometry.addAttribute('position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n\tvar TranslateHelperGeometry = function( radius, arc ) {\n\n\t\tvar geometry = new THREE.BufferGeometry()\n\n\t\tgeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n\tvar gizmoTranslate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, -Math.PI / 2 ], null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineRed ) ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ] ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ -Math.PI / 2, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ] ]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransperent ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( new THREE.CircleBufferGeometry( 0.1, 32 ), matYellowTransparent ), [ 0, 0, 0 ] ],\n\t\t\t// [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ] ],\n\t\t\t// [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent ), [ 0.15, 0, 0.15 ], [ -Math.PI / 2, 0, 0 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n\t\t]\n\t};\n\n\tvar pickerTranslate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ] ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( new THREE.CircleBufferGeometry( 0.1, 32 ), matInvisible ), [ 0, 0, 0 ] ]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ -Math.PI / 2, 0, 0 ] ]\n\t\t]\n\t};\n\n\tvar helperTranslate = {\n\t\tSTART: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tEND: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tDELTA: [\n\t\t\t[ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tX: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar gizmoRotate = {\n\t\tX: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ] ],\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, -Math.PI / 2 ] ],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ],\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ] ],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ],\n\t\t],\n\t\tE: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ] ],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, -Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ -1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, -1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ] ]\n\t\t]\n\t};\n\n\tvar helperRotate = {\n\t\tAXIS: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar pickerRotate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ],\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ],\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n\t\t],\n\t\tE: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n\t\t]\n\t};\n\n\tvar gizmoScale = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ] ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ] ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ], [ 0.8, 1, 1 ] ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ] ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 1.1, 0, 0 ] ],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 1.1, 0 ] ],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 0, 1.1 ] ],\n\t\t]\n\t};\n\n\tvar pickerScale = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ] ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ] ],\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ] ],\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ] ],\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ] ],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ] ],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ] ],\n\t\t]\n\t};\n\n\tvar helperScale = {\n\t\tX: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\t// Creates an Object3D with gizmos described in custom hierarchy definition.\n\n\tvar setupGizmo = function( gizmoMap ) {\n\n\t\tvar gizmo = new THREE.Object3D();\n\n\t\tfor ( var name in gizmoMap ) {\n\n\t\t\tfor ( var i = gizmoMap[ name ].length; i --; ) {\n\n\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ].clone();\n\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\n\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\n\t\t\t\tvar scale = gizmoMap[ name ][ i ][ 3 ];\n\t\t\t\tvar tag = gizmoMap[ name ][ i ][ 4 ];\n\n\t\t\t\t// name and tag properties are essential for picking and updating logic.\n\t\t\t\tobject.name = name;\n\t\t\t\tobject.tag = tag;\n\n\t\t\t\tif (position) {\n\t\t\t\t\tobject.position.set(position[ 0 ], position[ 1 ], position[ 2 ]);\n\t\t\t\t}\n\t\t\t\tif (rotation) {\n\t\t\t\t\tobject.rotation.set(rotation[ 0 ], rotation[ 1 ], rotation[ 2 ]);\n\t\t\t\t}\n\t\t\t\tif (scale) {\n\t\t\t\t\tobject.scale.set(scale[ 0 ], scale[ 1 ], scale[ 2 ]);\n\t\t\t\t}\n\n\t\t\t\tobject.updateMatrix();\n\n\t\t\t\tvar tempGeometry = object.geometry.clone();\n\t\t\t\ttempGeometry.applyMatrix(object.matrix);\n\t\t\t\tobject.geometry = tempGeometry;\n\n\t\t\t\tobject.position.set( 0, 0, 0 );\n\t\t\t\tobject.rotation.set( 0, 0, 0 );\n\t\t\t\tobject.scale.set(1, 1, 1);\n\n\t\t\t\tgizmo.add(object);\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn gizmo;\n\n\t};\n\n\t// Reusable utility variables\n\n\tvar tempVector = new THREE.Vector3( 0, 0, 0 );\n\tvar tempEuler = new THREE.Euler();\n\tvar alignVector = new THREE.Vector3( 0, 1, 0 );\n\tvar zeroVector = new THREE.Vector3( 0, 0, 0 );\n\tvar lookAtMatrix = new THREE.Matrix4();\n\tvar tempQuaternion = new THREE.Quaternion();\n\tvar tempQuaternion2 = new THREE.Quaternion();\n\tvar identityQuaternion = new THREE.Quaternion();\n\n\tvar unitX = new THREE.Vector3( 1, 0, 0 );\n\tvar unitY = new THREE.Vector3( 0, 1, 0 );\n\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\n\n\t// Gizmo creation\n\n\tthis.gizmo = {};\n\tthis.picker = {};\n\tthis.helper = {};\n\n\tthis.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n\tthis.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n\tthis.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n\tthis.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n\tthis.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n\tthis.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n\tthis.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n\tthis.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n\tthis.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n\t// Pickers should be hidden always\n\n\tthis.picker[ \"translate\" ].visible = false;\n\tthis.picker[ \"rotate\" ].visible = false;\n\tthis.picker[ \"scale\" ].visible = false;\n\n\t// updateMatrixWorld will update transformations and appearance of individual handles\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tvar quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n\t\t// Show only gizmos for current transform mode\n\n\t\tthis.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n\t\tthis.helper[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n\t\tvar handles = [];\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\n\n\t\tfor ( var i = 0; i < handles.length; i++ ) {\n\n\t\t\tvar handle = handles[i];\n\n\t\t\t// hide aligned to camera\n\n\t\t\thandle.visible = true;\n\t\t\thandle.rotation.set( 0, 0, 0 );\n\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\tvar eyeDistance = this.worldPosition.distanceTo( this.cameraPosition);\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( eyeDistance * this.size / 7 );\n\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\n\n\t\t\tif ( handle.tag === 'helper' ) {\n\n\t\t\t\thandle.visible = false;\n\n\t\t\t\tif ( handle.name === 'AXIS' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = !!this.axis;\n\n\t\t\t\t\tif ( this.axis === 'X' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Y' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Z' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\talignVector.copy( this.rotationAxis );\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n\t\t\t\t\t\thandle.quaternion.multiply( tempQuaternion );\n\t\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'E' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else if ( handle.name === 'START' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'END' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPosition );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\n\t\t\t\t\ttempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( -1 );\n\t\t\t\t\ttempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n\t\t\t\t\thandle.scale.copy( tempVector );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\t\t\tif ( this.dragging ) {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis ) {\n\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== -1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// If updating helper, skip rest of the loop\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// Align handles to current local or world rotation\n\n\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n\t\t\t\t// Hide translate and scale axis facing the camera\n\n\t\t\t\tvar AXIS_HIDE_TRESHOLD = 0.99;\n\t\t\t\tvar PLANE_HIDE_TRESHOLD = 0.2;\n\t\t\t\tvar AXIS_FLIP_TRESHOLD = -0.4;\n\n\n\t\t\t\tif ( handle.name === 'X' || handle.name === 'XYZX' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( handle.name === 'XY' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( handle.name === 'YZ' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( handle.name === 'XZ' ) {\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Flip translate and scale axis ocluded behind another axis\n\n\t\t\t\tif ( handle.name.search( 'X' ) !== -1 ) {\n\t\t\t\t\tif ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thandle.scale.x *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Y' ) !== -1 ) {\n\t\t\t\t\tif ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thandle.scale.y *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Z' ) !== -1 ) {\n\t\t\t\t\tif ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\t\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thandle.scale.z *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\t\t\t\t\t\thandle.visible = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else if ( this.mode === 'rotate' ) {\n\n\t\t\t\t// Align handles to current local or world rotation\n\n\t\t\t\ttempQuaternion2.copy( quaternion );\n\t\t\t\talignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n\t\t\t\tif ( handle.name.search( \"E\" ) !== - 1 ) {\n\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'X' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitX, Math.atan2( -alignVector.y, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Hide disabled axes\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === -1 || this.showX );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === -1 || this.showY );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === -1 || this.showZ );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === -1 || ( this.showX && this.showY && this.showZ ) );\n\n\t\t\t// highlight selected axis\n\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\n\n\t\t\thandle.material.color.copy( handle.material._color );\n\t\t\thandle.material.opacity = handle.material._opacity;\n\n\t\t\tif ( !this.enabled ) {\n\n\t\t\t\thandle.material.opacity *= 0.5;\n\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t} else if ( this.axis ) {\n\n\t\t\t\tif ( handle.name === this.axis ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else if ( this.axis.split('').some( function( a ) { return handle.name === a; } ) ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.material.opacity *= 0.25;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n\tconstructor: TransformControlsGizmo,\n\n\tisTransformControlsGizmo: true\n\n} );\n\n\nconst TransformControlsPlane = function () {\n\n\tTHREE.Mesh.call( this,\n\t\tnew THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n\t\tnew THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1 } )\n\t);\n\n\tthis.type = 'TransformControlsPlane';\n\n\tvar unitX = new THREE.Vector3( 1, 0, 0 );\n\tvar unitY = new THREE.Vector3( 0, 1, 0 );\n\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\n\n\tvar tempVector = new THREE.Vector3();\n\tvar dirVector = new THREE.Vector3();\n\tvar alignVector = new THREE.Vector3();\n\tvar tempMatrix = new THREE.Matrix4();\n\tvar identityQuaternion = new THREE.Quaternion();\n\n\tthis.updateMatrixWorld = function() {\n\n\t\tvar space = this.space;\n\n\t\tthis.position.copy( this.worldPosition );\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tunitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n\t\t// Align the plane for current transform mode, axis and space.\n\n\t\talignVector.copy( unitY );\n\n\t\tswitch ( this.mode ) {\n\t\t\tcase 'translate':\n\t\t\tcase 'scale':\n\t\t\t\tswitch ( this.axis ) {\n\t\t\t\t\tcase 'X':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitX );\n\t\t\t\t\t\tdirVector.copy( unitX ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Y':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitY );\n\t\t\t\t\t\tdirVector.copy( unitY ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitZ ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XY':\n\t\t\t\t\t\tdirVector.copy( unitZ );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'YZ':\n\t\t\t\t\t\tdirVector.copy( unitX );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XZ':\n\t\t\t\t\t\talignVector.copy( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitY );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XYZ':\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tdirVector.set( 0, 0, 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'rotate':\n\t\t\tdefault:\n\t\t\t\t// special case for rotate\n\t\t\t\tdirVector.set( 0, 0, 0 );\n\t\t}\n\n\t\tif ( dirVector.length() === 0 ) {\n\n\t\t\t// If in rotate mode, make the plane parallel to camera\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\n\n\t\t} else {\n\n\t\t\ttempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( tempMatrix );\n\n\t\t}\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\n\n\tconstructor: TransformControlsPlane,\n\n\tisTransformControlsPlane: true\n\n} );\n\nexport default TransformControls;\n","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/metaKey, or arrow keys / touch: two-finger move\n\nimport * as THREE from \"three\";\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new THREE.Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.25;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: THREE.MOUSE.LEFT, MIDDLE: THREE.MOUSE.MIDDLE, RIGHT: THREE.MOUSE.RIGHT };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new THREE.Vector3();\n\t\tvar lastQuaternion = new THREE.Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\t\t\tscope.target.add( panOffset );\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY_PAN: 4 };\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new THREE.Spherical();\n\tvar sphericalDelta = new THREE.Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new THREE.Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\t//console.log( 'handleMouseDownRotate' );\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\t//console.log( 'handleMouseDownDolly' );\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\t//console.log( 'handleMouseDownPan' );\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\t//console.log( 'handleMouseMoveRotate' );\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\t//console.log( 'handleMouseMoveDolly' );\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\t//console.log( 'handleMouseMovePan' );\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( event ) {\n\n\t\t// console.log( 'handleMouseUp' );\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\t// console.log( 'handleMouseWheel' );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\t//console.log( 'handleKeyDown' );\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\t//console.log( 'handleTouchStartRotate' );\n\n\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\t//console.log( 'handleTouchStartDollyPan' );\n\n\t\tif ( scope.enableZoom ) {\n\n\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tif ( scope.enablePan ) {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\t//console.log( 'handleTouchMoveRotate' );\n\n\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t//console.log( 'handleTouchMoveDollyPan' );\n\n\t\tif ( scope.enableZoom ) {\n\n\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyIn( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tif ( scope.enablePan ) {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchEnd( event ) {\n\n\t\t//console.log( 'handleTouchEnd' );\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase scope.mouseButtons.LEFT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey ) {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.MIDDLE:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.RIGHT:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly-pan\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly-pan\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY_PAN ) return; // is this needed?\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\nObject.defineProperties( OrbitControls.prototype, {\n\n\tcenter: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n\t\t\treturn this.target;\n\n\t\t}\n\n\t},\n\n\t// backward compatibility\n\n\tnoZoom: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\treturn ! this.enableZoom;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\tthis.enableZoom = ! value;\n\n\t\t}\n\n\t},\n\n\tnoRotate: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\treturn ! this.enableRotate;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\tthis.enableRotate = ! value;\n\n\t\t}\n\n\t},\n\n\tnoPan: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\treturn ! this.enablePan;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\tthis.enablePan = ! value;\n\n\t\t}\n\n\t},\n\n\tnoKeys: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\treturn ! this.enableKeys;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\tthis.enableKeys = ! value;\n\n\t\t}\n\n\t},\n\n\tstaticMoving: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\treturn ! this.enableDamping;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\tthis.enableDamping = ! value;\n\n\t\t}\n\n\t},\n\n\tdynamicDampingFactor: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\treturn this.dampingFactor;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\tthis.dampingFactor = value;\n\n\t\t}\n\n\t}\n\n} );\n\nexport default OrbitControls;\n","const ScriptLoader = function () {\r\n    function _add(basepath,urls,loadingManager) {\r\n        var promises = [];\r\n        if(urls && urls.length>0){\r\n            for(var i in urls){\r\n                \r\n                (function(url){\r\n                    var promise = new Promise(function(resolve, reject) {\r\n                        loadingManager && urls && loadingManager.itemStart(url);\r\n                        var script = document.createElement('script');\r\n                        script.src = url;\r\n            \r\n                        script.addEventListener('load', function() {\r\n                            loadingManager && loadingManager.itemEnd(url);\r\n                            console.log(\"Loaded: \"+url);\r\n                            resolve(url);\r\n                        }, false);\r\n            \r\n                        script.addEventListener('error', function() {\r\n                            console.log(\"Error: \"+url);\r\n                            loadingManager && loadingManager.itemEnd(url);\r\n                            reject(url);\r\n                        }, false);\r\n            \r\n                        document.body.appendChild(script);\r\n                    });\r\n            \r\n                    promises.push(promise);\r\n            })(basepath+urls[i]);\r\n            }\r\n        }\r\n        return promises;\r\n    }\r\n\r\n    this.load = function(basepath,urls,loadingManager) {\r\n\r\n        var promise = null;\r\n        basepath = !basepath?\"\":basepath;\r\n        if(urls && urls.length>0){\r\n            for(var i in urls){\r\n                (function(basepath,item){\r\n                    if(promise){\r\n                        promise = promise.then(function(){\r\n                            console.log('loaded');\r\n                            return Promise.all(_add(basepath,item,loadingManager)); \r\n                        });\r\n                    }else{\r\n                        promise = Promise.all(_add(basepath,item,loadingManager));\r\n                    }\r\n                })(basepath,urls[i]);\r\n            }\r\n        }\r\n        console.log(promise);\r\n        // loadingManager && urls && loadingManager.itemsStart(urls.length);\r\n        // var promises = _add(urls,loadingManager);\r\n        // console.log(promises);\r\n        return promise;\r\n    };\r\n}\r\n\r\nexport default ScriptLoader;","/**\n * @author mrdoob / http://mrdoob.com/\n * @author jetienne / http://jetienne.com/\n */\n/** @namespace */\n\nimport * as THREE from 'three'\n\nvar THREEx\t= {}\n\n/**\n * provide info on THREE.WebGLRenderer\n * \n * @param {Object} renderer the renderer to update\n * @param {Object} Camera the camera to update\n*/\nTHREEx.RendererStats\t= function (){\n\n\tvar container\t= document.createElement( 'div' );\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar msDiv\t= document.createElement( 'div' );\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#200;';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText\t= document.createElement( 'div' );\n\tmsText.style.cssText = 'color:#f00;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML= 'WebGLRenderer';\n\tmsDiv.appendChild( msText );\n\t\n\tvar msTexts\t= [];\n\tvar nLines\t= 11;\n\tfor(var i = 0; i < nLines; i++){\n\t\tmsTexts[i]\t= document.createElement( 'div' );\n\t\tmsTexts[i].style.cssText = 'color:#f00;background-color:#311;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\t\tmsDiv.appendChild( msTexts[i] );\t\t\n\t\tmsTexts[i].innerHTML= '-';\n\t}\n\n\n\tvar lastTime\t= Date.now();\n\treturn {\n\t\tdomElement: container,\n\n\t\tupdate: function(webGLRenderer){\n\t\t\t// sanity check\n\t\t\tconsole.assert(webGLRenderer instanceof THREE.WebGLRenderer)\n\n\t\t\t// refresh only 30time per second\n\t\t\tif( Date.now() - lastTime < 1000/30 )\treturn;\n\t\t\tlastTime\t= Date.now()\n\n\t\t\tvar i\t= 0;\n\t\t\tmsTexts[i++].textContent = \"== Programs ===\";\n\t\t\tmsTexts[i++].textContent = \"Programs: \"\t+ webGLRenderer.info.programs.length;\n\t\t\tmsTexts[i++].textContent = \"== Memory =====\";\n\t\t\tmsTexts[i++].textContent = \"Geometries: \"+webGLRenderer.info.memory.geometries;\n\t\t\tmsTexts[i++].textContent = \"Textures: \"\t+ webGLRenderer.info.memory.textures;\n\n\t\t\tmsTexts[i++].textContent = \"== Render =====\";\n\t\t\tmsTexts[i++].textContent = \"Calls: \"\t+ webGLRenderer.info.render.calls;\n\t\t\t// msTexts[i++].textContent = \"Vertices: \"\t+ webGLRenderer.info.render.vertices; //depreciated\n\t\t\tmsTexts[i++].textContent = \"Faces: \"\t+ webGLRenderer.info.render.triangles;\n\t\t\tmsTexts[i++].textContent = \"Points: \"\t+ webGLRenderer.info.render.points;\n\t\t\tmsTexts[i++].textContent = \"Lines: \"\t+ webGLRenderer.info.render.lines;\n\t\t\tmsTexts[i++].textContent = \"Frame: \"\t+ webGLRenderer.info.render.frame;\n\t\t}\n\t}\t\n};\n\nexport default THREEx;","const Utils = {\r\n    isElement: function (obj) {\r\n\r\n        try {\r\n        \r\n            return obj instanceof HTMLElement;\r\n        \r\n        } catch (e) {\r\n        \r\n            return (typeof obj === \"object\") && (obj.nodeType === 1) && (typeof obj.style === \"object\") && (typeof obj.ownerDocument === \"object\");\r\n        \r\n        }\r\n\r\n    },\r\n    \r\n    disposeObjMemory: function (obj) {\r\n\r\n        if ( obj !== null ) {\r\n\r\n            for ( var i = 0; i < obj.children.length; i++ ) {\r\n                \r\n                this.disposeObjMemory(obj.children[i]);\r\n\r\n            }\r\n\r\n            if ( obj.geometry ) {\r\n\r\n                obj.geometry.dispose();\r\n                obj.geometry = undefined;\r\n\r\n            }\r\n\r\n            if ( obj.material ) {\r\n\r\n                if (obj.material.map) {\r\n\r\n                    obj.material.map.dispose();\r\n                    obj.material.map = undefined;\r\n\r\n                }\r\n\r\n                obj.material.dispose();\r\n                obj.material = undefined;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        obj = undefined;\r\n        \r\n    },\r\n\r\n    parametricGeometries: {\r\n        plane: function ( width, height ) {\r\n\r\n            return function ( u, v, target ) {\r\n    \r\n                var x = u * width;\r\n                var y = 0;\r\n                var z = v * height;\r\n    \r\n                target.set( x, y, z );\r\n    \r\n            };\r\n    \r\n        },\r\n    }\r\n\r\n};\r\n\r\nexport default Utils;","import * as THREE from 'three';\r\nimport DragControls from 'three-dragcontrols';\r\nimport MapControls from '../vendors/threejs/r95/MapControls';\r\nimport TransformControls from '../vendors/threejs/r95/TransformControls';\r\nimport OrbitControls from \"../vendors/threejs/r95/OrbitControls\";\r\nimport ScriptLoader from './ScriptLoader';\r\nimport Stats from 'stats.js'\r\nimport THREEx from '../vendors/threex/threex.rendererstats'\r\nimport Utils from './utils';\r\n\r\nvar AbstractSKEditor = function ( data, loadingManager, scripts, onReady ) {\r\n\r\n\tvar _this = this;\r\n\tvar container = data.container;\r\n\r\n\tvar _global = {\r\n\t\tARC_SEGMENTS: 200,\r\n\t\tselectedObject: null,\r\n\t\thiding: false,\r\n\t\tsplineHelperObjects: [],\r\n\t\tobjects: [],\r\n\t\tsplines: {},\r\n\t\tpositions: [],\r\n\r\n\t};\r\n\r\n\tif ( container ) {\r\n\r\n\t\tif ( ! Utils.isElement( container ) ) {\r\n\r\n\t\t\tthis.container = document.getElementById( container );\r\n\t\t\tif ( this.container == null ) {\r\n\r\n\t\t\t\tcontainer = document.createElement( 'div' );\r\n\t\t\t\tdocument.body.appendChild( container );\r\n\t\t\t\tthis.container = container;\r\n\r\n            }\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.container = container;\r\n\r\n        }\r\n\r\n    } else {\r\n\r\n        container = document.createElement( 'div' );\r\n        document.body.appendChild( container );\r\n        this.container = container;\r\n\r\n    }\r\n\r\n\tthis.setting = {\r\n\t\tnearCamLimit: 0,\r\n\t\tfarCamLimit: 300,\r\n\t\textendedFarCamLimit: 200,\r\n\t\tenableDamping: false,\r\n\t\tuserControlledAimation: false,\r\n\t\tantialias: true,\r\n\t\tphysicallyCorrectLights: false,\r\n\t\ttoneMappingExposure: 1,\r\n\t\ttoneMappingWhitePoint: 1,\r\n\t\trendererGammaInput: true,\r\n\t\trendererGammaOutput: true,\r\n        enableShadow: false,\r\n        floorTextureImage: 'images/default_floor.jpg',\r\n        wallTextureImage: 'images/wall-white-paint.jpg'\r\n\t};\r\n\r\n\tvar tracker = {\r\n\t\tanalysis: true,\r\n\t\tpan: true,\r\n\t\texportScene: true\r\n\t};\r\n\r\n\tthis.initSceneSetup = function () {\r\n\r\n\t\t_setup().then( _init );\r\n\r\n    };\r\n\r\n\tfunction _setup() {\r\n\r\n        var scriptLoader = new ScriptLoader();\r\n        return new Promise(function(resolve, reject) {\r\n\r\n            scriptLoader.load( data.cdn, scripts ).then(function(){\r\n\r\n                console.log('scripts are loaded');\r\n                resolve();\r\n\r\n            }).catch(function(){\r\n                \r\n                console.log(\"Error\");\r\n            \r\n            });\r\n        });\r\n\r\n    }\r\n\r\n\tfunction _init() {\r\n\r\n\t\tTHREE.Cache.enabled = true;\r\n\r\n\t\t_global.geometry1 = new THREE.CircleBufferGeometry( 5, 32 );\r\n\r\n        _initScene();\r\n    \t_initRenderer();\r\n\t\t_initCamera();\r\n\t\t_initMapControls();\r\n\t\t_initDragControl();\r\n\t\t_initTransformControl();\r\n\t\t_importAssets();\r\n\t\t_registerEventListeners();\r\n\t\t_animateFrame();\r\n\r\n\t}\r\n\r\n\tfunction _initScene() {\r\n\r\n\t\tvar scene = new THREE.Scene();\r\n\t\tscene.name = \"Scene\";\r\n\t\tscene.background = new THREE.Color().setHex( 0x4e4f4f );\r\n\t\tscene.fog = new THREE.Fog( 0, 0.1, 0 );\r\n\r\n\t\t_this.scene = scene;\r\n\r\n\t\tif ( tracker.exportScene ) window.scene = scene;\r\n\r\n    }\r\n\r\n\tfunction _initRenderer() {\r\n\r\n\t\tvar renderer = new THREE.WebGLRenderer( {\r\n\t\t\tantialias: _this.setting.antialias,\r\n\t\t\talpha: false,\r\n\t\t} );\r\n\r\n\t\trenderer.setPixelRatio( window.devicePixelRatio );\r\n\r\n\t\tvar canvas = renderer.domElement;\r\n\t\tcanvas.style.position = \"absolute\";\r\n\t\tcanvas.style.top = \"0px\";\r\n\t\tcanvas.style.zIndex = 0;\r\n\t\tcanvas.height = _this.container.clientHeight;\r\n\t\tcanvas.width = _this.container.clientWidth;\r\n\r\n\t\trenderer.setSize( canvas.width, canvas.height );\r\n\r\n\t\t_this.container.appendChild( canvas );\r\n\r\n\t\t_global.renderer = renderer;\r\n\t\t_global.canvas = canvas;\r\n\r\n\t\tif ( tracker.analysis ) _stats();\r\n\r\n    }\r\n\r\n\tfunction _initCamera() {\r\n\r\n\t\t_this.camera = new THREE.PerspectiveCamera( 45, _global.canvas.width / _global.canvas.height, 10, 1000 );\r\n\t\t_this.camera.position.set( 0, 0, 200 );\r\n\r\n    }\r\n\r\n\tfunction _initOrbitControls() {\r\n\t\tvar orbitControls = new OrbitControls( _this.camera, _global.renderer.domElement );\t\torbitControls.addEventListener( 'change', _refreshRenderFrame ); // call this only in static scenes (i.e., if there is no animation loop)\r\n\t\torbitControls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n\t\torbitControls.dampingFactor = 0.25;\r\n\t\torbitControls.minDistance = 0;\r\n\t\torbitControls.maxDistance = 500;\r\n\t\torbitControls.maxPolarAngle = THREE.Math.degToRad(90);\r\n        orbitControls.minPolarAngle = THREE.Math.degToRad(0 );\r\n\t\t_global.orbitControls = orbitControls;\r\n\t}\r\n\r\n\tfunction _initMapControls() {\r\n\r\n\t\tvar controls = new MapControls( _this.camera, _global.renderer.domElement );\r\n\t\tcontrols.addEventListener( 'change', _refreshRenderFrame ); // call this only in static scenes (i.e., if there is no animation loop)\r\n\t\tcontrols.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n\t\tcontrols.dampingFactor = 0.25;\r\n\t\tcontrols.screenSpacePanning = true;\r\n\t\t// controls.minDistance = 100;\r\n\t\tcontrols.maxDistance = 500;\r\n\t\tcontrols.panSpeed = 0.25;\r\n\t\t_global.controls = controls;\r\n\r\n\t}\r\n\r\n\tfunction _initDragControl() {\r\n\r\n\t\tvar dragcontrols = new DragControls( _global.splineHelperObjects, _this.camera, _global.renderer.domElement ); //\r\n        dragcontrols.enabled = false;\r\n        dragcontrols.addEventListener( 'change', _refreshRenderFrame );\r\n\t\tdragcontrols.addEventListener( 'hoveron', function ( event ) {\r\n\r\n\t\t\t_global.transformControl.attach( event.object );\r\n\t\t\tcancelHideTransorm();\r\n\r\n        } );\r\n\t\tdragcontrols.addEventListener( 'hoveroff', function ( event ) {\r\n\r\n\t\t\tdelayHideTransform();\r\n\r\n        } );\r\n\r\n    }\r\n\r\n\tfunction _initTransformControl() {\r\n\r\n\r\n\t\t_global.transformControl = new TransformControls( _this.camera, _global.renderer.domElement );\r\n\t\t_global.transformControl.showZ = false;\r\n\t\t_global.transformControl.translationSnap = 10;\r\n\r\n\t\t_global.transformControl.addEventListener( 'dragging-changed', function ( event ) {\r\n\r\n            _global.controls.enabled = ! event.value;\r\n\r\n        } );\r\n\t\t// Hiding transform situation is a little in a mess :()\r\n\t\t_global.transformControl.addEventListener( 'change', function ( e ) {\r\n\r\n            // cancelHideTransorm();            \r\n            _refreshRenderFrame();\r\n\r\n        } );\r\n\t\t_global.transformControl.addEventListener( 'mouseDown', function ( e ) {\r\n\r\n\t\t\tcancelHideTransorm();\r\n\r\n        } );\r\n\t\t_global.transformControl.addEventListener( 'mouseUp', function ( e ) {\r\n\r\n\t\t\tdelayHideTransform();\r\n\r\n        } );\r\n\t\t_global.transformControl.addEventListener( 'objectChange', function ( e ) {\r\n\r\n            updateSplineOutline( _global.splines );\r\n\r\n        } );\r\n\r\n\t}\r\n\r\n\tfunction _importAssets() {\r\n\r\n\t\tvar helpers = new THREE.Group();\r\n\t\thelpers.name = \"helpers\";\r\n\r\n\t\tvar ambLight = new THREE.AmbientLight( 0xffffff, 1 );\r\n\t\tambLight.name = \"ambientLight\";\r\n\t\thelpers.add( ambLight );\r\n\r\n\t\tvar dirLight = new THREE.DirectionalLight( 0xffffff, 0.5 );\r\n\t\tdirLight.name = \"dirLight\";\r\n\t\tdirLight.position.set( 5, 5, 5 );\r\n\t\thelpers.add( dirLight );\r\n\r\n\t\tvar grid = new THREE.GridHelper( 1000, 100, 0xffffff, 0x999999 );\r\n\t\tgrid.rotateX( - Math.PI / 2 );\r\n\t\tgrid.name = 'grid';\r\n\t\thelpers.add( grid );\r\n\r\n\t\thelpers.add( _global.transformControl );\r\n\r\n\t\t_global.helpers = helpers;\r\n\r\n        new THREE.TextureLoader().load(_this.setting.floorTextureImage, function(texture){\r\n\t\t\ttexture.wrapS = THREE.RepeatWrapping;\r\n\t\t\ttexture.wrapT = THREE.RepeatWrapping;\r\n\t\t\ttexture.repeat.x = 0.1;\r\n\t\t\ttexture.repeat.y = 0.1;\r\n\t\t\t_global.floorTexture = texture;\r\n\r\n\t\t});\r\n\t\t \r\n\t\tnew THREE.TextureLoader().load(_this.setting.wallTextureImage, function(texture){ \r\n\t\t\ttexture.wrapS = THREE.RepeatWrapping;\r\n\t\t\ttexture.wrapT = THREE.RepeatWrapping;\r\n\t\t\ttexture.repeat.x = 0.1;\r\n\t\t\ttexture.repeat.y = 0.1;\r\n            _global.wallTexture = texture;\r\n        });\r\n\r\n\t\t_this.scene.add( helpers );\r\n\t\t_this.sceneReady = true;\r\n\t\t_refreshRenderFrame();\r\n\r\n    }\r\n\r\n\tthis.createFloor = function ( param ) {\r\n\r\n\t\tvar floor2d = new THREE.Group();\r\n        floor2d.name = \"floor2d\";\r\n        \r\n        var floor3d = new THREE.Group();\r\n\t\tfloor3d.name = \"floor3d\";\r\n\r\n\t\t_this.scene.add( floor2d );\r\n        _this.scene.add( floor3d );\r\n        \r\n\t\t_global.floor2d = floor2d;\r\n\t\t_global.floor3d = floor3d;\r\n\r\n\t\tswitch ( param.shape ) {\r\n\r\n\t\t\tcase \"Box\":\r\n\t\t\t\t_createBox( param );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"T\":\r\n\t\t\t\t_createTShape( param );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"U\":\r\n\t\t\t\t_createUShape( param );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"L\":\r\n\t\t\t\t_createLShape( param );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"C\":\r\n\t\t\t\t_createCustomShape( param );\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.log( 'Unidentified shape selected' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t_refreshRenderFrame();\r\n\r\n    };\r\n\r\n\tthis.clearFloor = function () {\r\n\r\n        var obj = _this.scene.getObjectByName( 'floor2d' );\r\n        \r\n        if ( !obj ) return;\r\n        \r\n\t\t_disposeObjMemory( obj );\r\n        obj.parent.remove( obj );\r\n        _global.splineHelperObjects.splice( 0, _global.splineHelperObjects.length );\r\n\t\t_global.positions.splice( 0, _global.positions.length );\r\n        _refreshRenderFrame();\r\n\r\n    };\r\n\r\n\tfunction _createBox( param ) {\r\n\r\n\t\tvar length = param.length || 100;\r\n\t\tvar width = param.width || 100;\r\n        var splinePointsLength = param.splinePointsLength || 4;\r\n        \r\n        var points = [ new THREE.Vector3( 0, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, 0, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 0, 0 )\r\n\t\t];\r\n\r\n\t\t_createCurveGeometry( points, splinePointsLength );\r\n\r\n\t\tload( points, splinePointsLength );\r\n\r\n\t}\r\n\r\n\tfunction _createLShape( param ) {\r\n\r\n\t\tvar length = param.length || 100;\r\n\t\tvar width = param.width || 100;\r\n\t\tvar thickness1 = param.thickness1 || 30;\r\n\t\tvar thickness2 = param.thickness2 || 40;\r\n        var splinePointsLength = param.splinePointsLength || 6;\r\n        \r\n        var points = [ new THREE.Vector3( 0, width, 0 ),\r\n\t\t\tnew THREE.Vector3( thickness1, width, 0 ),\r\n\t\t\tnew THREE.Vector3( thickness1, thickness2, 0 ),\r\n\t\t\tnew THREE.Vector3( length, thickness2, 0 ),\r\n\t\t\tnew THREE.Vector3( length, 0, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 0, 0 )\r\n        ];\r\n        \r\n\t\t_createCurveGeometry( points, splinePointsLength );\r\n\r\n\t\tload( points, splinePointsLength );\r\n\r\n    }\r\n\r\n\tfunction _createTShape( param ) {\r\n\r\n\t\tvar length = param.length || 100;\r\n\t\tvar width = param.width || 100;\r\n\t\tvar flangeSection1 = param.flangeSection1 || 35;\r\n\t\tvar flangeSection2 = param.flangeSection2 || 45;\r\n\t\tvar thickness1 = param.thickness1 || 30;\r\n\t\tvar thickness2 = param.thickness2 || 40;\r\n\r\n\t\tvar splinePointsLength = param.splinePointsLength || 8;\r\n\r\n        var points = [\r\n\t\t\tnew THREE.Vector3( 0, width - thickness1, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, width - thickness2, 0 ),\r\n\t\t\tnew THREE.Vector3( length - flangeSection2, width - thickness2, 0 ),\r\n\t\t\tnew THREE.Vector3( length - flangeSection2, 0 ),\r\n\t\t\tnew THREE.Vector3( length - flangeSection2 - flangeSection1, 0 ),\r\n\t\t\tnew THREE.Vector3( length - flangeSection2 - flangeSection1, width - thickness1, 0 )\r\n\t\t];\r\n\r\n\t\t_createCurveGeometry( points, splinePointsLength );\r\n\r\n\t\tload( points, splinePointsLength );\r\n\r\n\t}\r\n\r\n\tfunction _createUShape( param ) {\r\n\r\n\t\tvar length = param.length || 100;\r\n\t\tvar width = param.width || 100;\r\n\t\tvar innerWall = param.innerWall || 60;\r\n\t\tvar thickness1 = param.thickness1 || 30;\r\n\t\tvar thickness2 = param.thickness2 || 40;\r\n\r\n\t\tvar splinePointsLength = param.splinePointsLength || 8;\r\n\r\n        var points = [\r\n\t\t\tnew THREE.Vector3( 0, width, 0 ),\r\n\t\t\tnew THREE.Vector3( thickness1, width, 0 ),\r\n\t\t\tnew THREE.Vector3( thickness1, width - innerWall, 0 ),\r\n\t\t\tnew THREE.Vector3( length - thickness2, thickness2, 0 ),\r\n\t\t\tnew THREE.Vector3( length - thickness2, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, width, 0 ),\r\n\t\t\tnew THREE.Vector3( length, 0, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 0, 0 )\r\n\t\t];\r\n        \r\n\t\t_createCurveGeometry( points, splinePointsLength );\r\n\r\n\t\tload( points, splinePointsLength );\r\n\r\n\t}\r\n\r\n\tfunction _createCustomShape( param ) {\r\n\r\n\t\tvar splinePointsLength = param.splinePointsLength || 3;\r\n\r\n        var points = [\r\n\t\t\tnew THREE.Vector3( 50, 100, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 100, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 0, 0 )\r\n\t\t];\r\n\r\n\t\t_createCurveGeometry( points, splinePointsLength );\r\n\r\n\t\tload( points, splinePointsLength );\r\n\r\n\t}\r\n\r\n\tfunction _createCurveGeometry( positions, splinePointsLength ) {\r\n\r\n\t\tfor ( var i = 0; i < splinePointsLength; i ++ ) {\r\n\t\t\t\r\n\t\t\taddSplineObject( positions[i] );\r\n\t\t\t_global.positions.push( _global.splineHelperObjects[ i ].position );\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( _global.ARC_SEGMENTS * 3 ), 3 ) );\r\n\t\tvar curve = new THREE.CatmullRomCurve3( _global.positions );\r\n\t\tcurve.curveType = 'catmullrom';\r\n\t\tcurve.tension = 0;\r\n\t\tcurve.closed = true;\r\n\t\tcurve.mesh = new THREE.Line( geometry.clone(), new THREE.LineBasicMaterial( {\r\n\t\t\tcolor: 0xff0000,\r\n\t\t\topacity: 0.35,\r\n\t\t\tlinewidth: 1\r\n\t\t} ) );\r\n\t\t_global.splines.uniform = curve;\r\n\r\n\t\tfor ( var k in _global.splines ) {\r\n\r\n\t\t\tvar spline = _global.splines[ k ];\r\n\t\t\t_global.floor2d.add( spline.mesh );\r\n\r\n        }\r\n\r\n\t}\r\n\r\n\tthis.extrude = function name( params ) {\r\n\r\n\t\tvar extrudeSettings = {\r\n\t\t\tdepth: 30,\r\n            bevelEnabled: false,\r\n\t\t};\r\n\r\n\t\tvar pts = [];\r\n\r\n\t\tfor ( var i = 0; i < _global.positions.length; i ++ ) {\r\n \r\n\t\t\tpts.push( new THREE.Vector2( _global.positions[ i ].x, _global.positions[ i ].y ) );\r\n\r\n        }\r\n\r\n\t\tvar shape = new THREE.Shape( pts );\r\n\r\n\t\tvar geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tvar material1 = new THREE.MeshLambertMaterial( { color: 0xffffff, wireframe: false, side: THREE.BackSide, map: _global.floorTexture } );\r\n\t\tvar material2 = new THREE.MeshLambertMaterial( { color: 0xffffff, wireframe: false, side: THREE.BackSide, map: _global.wallTexture} );\r\n\t\t\r\n\t\tvar mesh = new THREE.Mesh( geometry, [ material1, material2 ] );\r\n\t\tmesh.frustumCulled = false;\r\n\t\tmesh.position.copy(geometry.boundingSphere.center.negate());\r\n\r\n\t\t_global.floor3d.add( mesh );\r\n\t\t\r\n\t\t_this.scene.rotateX(-Math.PI/2);\r\n\t\t_global.helpers.getObjectByName('grid').visible = false;\r\n\t\t_global.controls.enabled = false;\r\n\t\t_global.controls.dispose();\r\n\t\t_initOrbitControls();\r\n\r\n        _refreshRenderFrame();\r\n\r\n    };\r\n\r\n\tthis.addPoint = function () {\r\n\r\n\t\t_global.splinePointsLength ++;\r\n\t\t_global.positions.push( addSplineObject().position );\r\n        updateSplineOutline( _global.splines );\r\n        \r\n        _refreshRenderFrame();\r\n\r\n    };\r\n\r\n\tthis.removePoint = function () {\r\n\r\n\t\tif ( _global.splinePointsLength <= 3 ) {\r\n\r\n\t\t\treturn;\r\n\r\n        }\r\n\t\t_global.splinePointsLength --;\r\n\t\t_global.positions.pop();\r\n\t\t_global.floor2d.remove( _global.splineHelperObjects.pop() );\r\n        updateSplineOutline( _global.splines );\r\n        \r\n        _refreshRenderFrame();\r\n\r\n    };\r\n\r\n\tfunction addSplineObject( position ) {\r\n\r\n\t\tvar material = new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\t\tvar object = new THREE.Mesh( _global.geometry1, material );\r\n\t\tif ( position ) {\r\n\r\n\t\t\tobject.position.copy( position );\r\n\r\n        } else {\r\n\r\n\t\t\tobject.position.x = Math.random() * 100 - 50;\r\n\t\t\tobject.position.y = Math.random() * 60;\r\n\t\t\tobject.position.z = 0;\r\n\r\n        }\r\n\t\tobject.castShadow = true;\r\n\t\tobject.receiveShadow = true;\r\n\t\t_global.floor2d.add( object );\r\n\t\t\r\n\t\t_global.splineHelperObjects.push( object );\r\n\t\treturn object;\r\n\r\n    }\r\n\r\n\tfunction load( new_positions, splinePointsLength ) {\r\n\r\n\t\twhile ( new_positions.length > _global.positions.length ) {\r\n\r\n\t\t\t_this.addPoint();\r\n\r\n        }\r\n\t\twhile ( new_positions.length < _global.positions.length ) {\r\n\r\n\t\t\t_this.removePoint();\r\n\r\n        }\r\n\t\tfor ( var i = 0; i < _global.positions.length; i ++ ) {\r\n\r\n\t\t\t_global.positions[ i ].copy( new_positions[ i ] );\r\n\r\n        }\r\n\t\tupdateSplineOutline( _global.splines );\r\n\r\n\t\t_global.splinePointsLength = splinePointsLength;\r\n\r\n\t}\r\n\r\n\tfunction updateSplineOutline( splines ) {\r\n\r\n\t\tvar point = new THREE.Vector3();\r\n\t\tfor ( var k in splines ) {\r\n\r\n\t\t\tvar spline = splines[ k ];\r\n\t\t\tvar splineMesh = spline.mesh;\r\n\t\t\tvar position = splineMesh.geometry.attributes.position;\r\n\t\t\tfor ( var i = 0; i < _global.ARC_SEGMENTS; i ++ ) {\r\n\r\n\t\t\t\tvar t = i / ( _global.ARC_SEGMENTS - 1 );\r\n\t\t\t\tspline.getPoint( t, point );\r\n\t\t\t\tposition.setXYZ( i, point.x, point.y, point.z );\r\n\r\n            }\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t}\r\n\t\t\r\n\t\tvar len = _global.positions.length;\r\n\r\n\t\tfor ( var j = 0; j < len; j++ ){\r\n\r\n\t\t\tvar current = _global.positions[j];\r\n\t\t\tvar previous = _global.positions[(j+len-1)%len];\r\n\t\t\tconsole.log(\"Line : \" + j + \" = \" + current.distanceTo(previous));\r\n\r\n\t\t}\r\n\r\n    }\r\n\r\n\tfunction delayHideTransform() {\r\n\r\n\t\tcancelHideTransorm();\r\n\t\thideTransform();\r\n\r\n    }\r\n\r\n\tfunction hideTransform() {\r\n\r\n\t\t_global.hiding = setTimeout( function () {\r\n\r\n\t\t\t_global.transformControl.detach( _global.transformControl.object );\r\n\r\n        }, 1000 );\r\n\r\n    }\r\n\r\n\tfunction cancelHideTransorm() {\r\n\r\n\t\tif ( _global.hiding ) clearTimeout( _global.hiding );\r\n\r\n    }\r\n\r\n\tfunction _disposeObjMemory( obj ) {\r\n\r\n\t\tif ( obj ) {\r\n\r\n\t\t\tif ( obj.isMesh || obj.isLine ) {\r\n\r\n\t\t\t\tif ( obj.material ) {\r\n\r\n\t\t\t\t\tobj.material.map && obj.material.map.dispose();\r\n\t\t\t\t\tobj.material.aoMap && obj.material.aoMap.dispose();\r\n\t\t\t\t\tobj.material.emissiveMap && obj.material.emissiveMap.dispose();\r\n\t\t\t\t\tobj.material.lightMap && obj.material.lightMap.dispose();\r\n\t\t\t\t\tobj.material.bumpMap && obj.material.bumpMap.dispose();\r\n\t\t\t\t\tobj.material.normalMap && obj.material.normalMap.dispose();\r\n\t\t\t\t\tobj.material.specularMap && obj.material.specularMap.dispose();\r\n\t\t\t\t\tobj.material.envMap && obj.material.envMap.dispose();\r\n\t\t\t\t\tobj.material.dispose();\r\n\r\n                }\r\n\t\t\t\tobj.geometry && obj.geometry.dispose();\r\n\r\n\t\t\t} else if ( obj.type.isGroup ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < obj.children.length; i ++ ) {\r\n\r\n\t\t\t\t\t_disposeObjMemory( obj.children[ i ] );\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n\tfunction _render() {\r\n\r\n\t\t// _this.scene.updateMatrix();\r\n\t\t// _this.camera.updateProjectionMatrix();\r\n\t\t// if (_this.physics && _this.physics.isReady) _this.physics.update();\r\n\t\t// if(_this.setting.postprocessing && _global.postProcessor && _global.postProcessor.composer && _global.msaaFilterActive ) {\r\n\t\t//     _global.postProcessor.update();\r\n\t\t// } else {\r\n\t\t_global.renderer.render( _this.scene, _this.camera );\r\n\t\t// }\r\n\r\n    }\r\n\r\n\tfunction _animate( doAnimate, timeout ) {\r\n\r\n\t\t_global.doAnimate = doAnimate;\r\n\t\tif ( timeout ) {\r\n\r\n\t\t\treturn new Promise( function ( resolve, reject ) {\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tresolve();\r\n\r\n                }, timeout );\r\n\r\n            } );\r\n\r\n        }\r\n\r\n    }\r\n\r\n\tfunction _startAnimate() {\r\n\r\n\t\tif ( ! _global.doAnimate ) {\r\n\r\n\t\t\t_global.doAnimate = true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\tfunction _stopAnimate() {\r\n\r\n\t\t_global.doAnimate = false;\r\n\r\n    }\r\n\r\n\tfunction _animateFrame() {\r\n\r\n\t\trequestAnimationFrame( _animateFrame );\r\n\r\n\t\tif ( _this.sceneReady && ( _global.doAnimate || _this.setting.userControlledAimation ) ) {\r\n\r\n\t\t\t_global.controls.update();\r\n\t\t\tif ( tracker.analysis ) {\r\n\t\t\t\t_this.rendererStats.update( _global.renderer );\r\n\t\t\t\t_this.stats.update();\r\n\t\t\t}\r\n\t\t\t_render();\r\n\r\n        }\r\n\r\n    }\r\n\r\n\tfunction _refreshRenderFrame() {\r\n\r\n\t\t_startAnimate();\r\n\t\tclearTimeout( _global.canvas.renderFrameTimeoutObj );\r\n\t\t_global.canvas.renderFrameTimeoutObj = setTimeout( function () {\r\n\r\n\t\t\t_stopAnimate();\r\n\r\n        }, 1000 );\r\n\r\n    }\r\n\r\n\tfunction _registerEventListeners() {\r\n\r\n\t\t// _keyPressEvent(window);\r\n\r\n\t\twindow.addEventListener( 'resize', _onWindowResize, false );\r\n\r\n\t}\r\n\r\n\tfunction _keyPressEvent( element ) {\r\n\r\n\t\telement.addEventListener( 'keypress', function ( event ) {\r\n\r\n\t\t\tvar x = event.key;\r\n\t\t\tswitch ( x ) {\r\n\r\n\t\t\t\tcase \"h\" || \"H\":\r\n\t\t\t\t\t! _global.ultraHD ? _global.ultraHD = true : _global.ultraHD = false;\r\n\t\t\t\t\tconsole.warn( 'UltraHD set to ' + _global.ultraHD + '. Performance may reduce if UltraHD is enabled. Toggle by pressing key H' );\r\n\t\t\t\t\t_this.experimentalHD( _global.ultraHD );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"j\" || \"J\":\r\n\t\t\t\t\tif ( _global.postProcessor ) {\r\n\r\n\t\t\t\t\t\tif ( ! _global.msaaFilterActive ) {\r\n\r\n\t\t\t\t\t\t\t_this.setting.antialias = false;\r\n\t\t\t\t\t\t\t_recreateRendererContext();\r\n\t\t\t\t\t\t\t_global.postProcessor.composer.renderer = _global.renderer;\r\n\t\t\t\t\t\t\t_refreshRenderFrame();\r\n\t\t\t\t\t\t\t_global.msaaFilterActive = true;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t_this.setting.antialias = true;\r\n\t\t\t\t\t\t\t_recreateRendererContext();\r\n\t\t\t\t\t\t\t_global.postProcessor.composer.renderer = _global.renderer;\r\n\t\t\t\t\t\t\t_refreshRenderFrame();\r\n\t\t\t\t\t\t\t_global.msaaFilterActive = false;\r\n\r\n                        }\r\n\t\t\t\t\t\tconsole.warn( 'MSAA Quality set to ' + _global.msaaFilterActive + '. Performance may reduce if MSAA Quality is enabled. Toggle by pressing key J' );\r\n\r\n                        } else {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"Post Processing is enabled but no passes assigned. Ignoring this event.\" );\r\n\r\n                    }\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"c\" || \"C\":\r\n\t\t\t\t\t_this.physics.cameraMode = _this.physics.cameraMode === 3 ? 0 : _this.physics.cameraMode + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"r\" || \"R\":\r\n\t\t\t\t\t_this.physics.needsReset = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n            }\r\n\r\n        } );\r\n\r\n    }\r\n\r\n\tfunction _recreateRendererContext() {\r\n\r\n\t\t_global.renderer.dispose();\r\n\t\t_global.renderer.forceContextLoss();\r\n\t\t_global.renderer.context = undefined;\r\n\t\tvar targetDOM = _global.renderer.domElement;\r\n\t\ttargetDOM.parentNode.removeChild( targetDOM );\r\n\t\t_initRenderer();\r\n\r\n\t}\r\n\r\n\tfunction _onWindowResize() {\r\n\r\n\t\t_global.canvas.height = _this.container.clientHeight;\r\n\t\t_global.canvas.width = _this.container.clientWidth;\r\n\t\t_global.renderer.setSize( _global.canvas.width, _global.canvas.height );\r\n\t\t_this.camera.aspect = _global.canvas.width / _global.canvas.height;\r\n\t\t_this.camera.updateProjectionMatrix();\r\n\r\n\t\t_refreshRenderFrame();\r\n\r\n    }\r\n\r\n\tfunction _stats() {\r\n\r\n\t\t_this.stats = new Stats();\r\n\t\t_this.stats.dom.style.position = 'absolute';\r\n\t\t_this.stats.dom.style.top = '0px';\r\n\t\t_this.stats.dom.style.left = '80px';\r\n\t\tdocument.body.appendChild( _this.stats.dom );\r\n\t\t_this.rendererStats = new THREEx.RendererStats();\r\n\t\t_this.rendererStats.domElement.style.position = 'absolute';\r\n\t\t_this.rendererStats.domElement.style.left = '0px';\r\n\t\t_this.rendererStats.domElement.style.top = '0px';\r\n\t\tdocument.body.appendChild( _this.rendererStats.domElement );\r\n\r\n    }\r\n\r\n};\r\n\r\nvar SKEditor = function ( data, loadingManager, onReady ) {\r\n\r\n\tvar scripts = [\r\n\t\t[\r\n\t\t\t// \"/app/js/vendors/threejs/three.js\",\r\n\t\t],\r\n\t\t[\r\n\t\t\t// \"/app/js/vendors/threejs/r95/MapControls.js\",\r\n\t\t\t// \"/app/js/vendors/threejs/r95/TransformControls.js\",\r\n\t\t\t// \"/app/js/vendors/threejs/r95/DragControls.js\",\r\n\t\t\t// \"/app/js/vendors/threex/threex.rendererstats.js\",\r\n\t\t\t// \"/app/js/vendors/threejs/r95/stats.min.js\",\r\n\t\t\t// \"/app/js/vendors/clientjs/client.min.js\",\r\n\r\n\t\t]\r\n\t];\r\n\tAbstractSKEditor.call( this, data, loadingManager, scripts, onReady );\r\n\r\n};\r\n\r\nSKEditor.prototype = Object.create( AbstractSKEditor.prototype );\r\nSKEditor.prototype.constructor = SKEditor;\r\n\r\nexport default SKEditor;\r\n","import { combineReducers } from \"redux\";\nimport EditorUIReducer from './EditorUI';\n\nconst allReducers = combineReducers({\n    editorUI: EditorUIReducer\n});\n\nexport default allReducers;\n","\nexport default function (initialState, action) {\n    initialState = {\n        id: 1,\n        showPointButtons: false,\n        showLayoutButtons: true,\n        showCreateFloorButton: false,\n        showClearButton: false\n    };\n    \n    switch (action.type) {\n        case \"UPDATE_EDITOR_UI\":\n            return {\n                ...initialState,\n                ...action.payload\n            }\n        default:\n            return initialState\n    }\n}","import React from 'react';\nimport { Provider } from \"react-redux\";\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport LoadingManager from './js/spacekraft/LoadingManager';\nimport SKEditor from  './js/spacekraft/editor';\nimport { createStore } from \"redux\";\nimport allReducers from './reducers/index';\n\nconst store = createStore(allReducers);\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root')\n);\n\nserviceWorker.unregister();\n\nconst loadingManager = new LoadingManager();\nconst container = document.getElementById('editor');\n\nconst data = {\n    container: container,\n    cdn: ''\n};\n\nconst onReady = function () {\n    console.log('editor loaded');\n};\n\nconst editor = new SKEditor(data, loadingManager, onReady);\neditor.initSceneSetup();\n\nexport default editor;"],"sourceRoot":""}